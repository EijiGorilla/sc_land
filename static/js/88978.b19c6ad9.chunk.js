"use strict";(self.webpackChunksc_land=self.webpackChunksc_land||[]).push([[88978],{35582:(e,t,i)=>{i.d(t,{M:()=>_,b:()=>h});var s,r,n=i(30168),o=i(41012),a=i(95276),l=i(58406),c=i(98634),d=i(64201),u=i(4760);function h(e){const t=new d.kG,{vertex:i,fragment:h}=t;(0,o.Sv)(i,e),i.uniforms.add(new l.p("width",(e=>e.width))),t.attributes.add(u.T.POSITION,"vec3"),t.attributes.add(u.T.NORMAL,"vec3"),t.attributes.add(u.T.UV0,"vec2"),t.attributes.add(u.T.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.code.add((0,c.H)(s||(s=(0,n.Z)(["void main(void) {\nvec3 bitangent = normal;\nvtc = uv0;\nvlength = length;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;\n}"])))),h.uniforms.add(new l.p("outlineSize",(e=>e.outlineSize)),new a.N("outlineColor",(e=>e.outlineColor)),new l.p("stripeLength",(e=>e.stripeLength)),new a.N("stripeEvenColor",(e=>e.stripeEvenColor)),new a.N("stripeOddColor",(e=>e.stripeOddColor)));const _=1/Math.sqrt(2);return h.code.add((0,c.H)(r||(r=(0,n.Z)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      } else if (d < outlineSize) {\n        return outlineColor;\n      } else {\n        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n      }\n    }\n\n    void main(void) {\n      vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n      vec4 color = arrowColor(ntc, vlength / vradius);\n      if (color.a == 0.0) {\n        discard;\n      }\n      fragColor = color;\n    }\n  "])),c.H.float(_))),t}const _=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}))},77671:(e,t,i)=>{i.d(t,{Y:()=>r});var s=i(74177);const r={readOnly:!0,get(){return(0,s.R)(this.view)}}},98074:(e,t,i)=>{i.d(t,{p:()=>l});var s=i(27366),r=i(42537),n=i(67426),o=i(49861),a=(i(93169),i(32718),i(84936),i(69912));const l=e=>{let t=class extends((0,n.v)(e)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return null==this.parent||this.parent.visible&&!this.parent.suspended}set visible(e){this._overrideIfSome("visible",e)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,r.kB)((()=>this._interactiveViewModelCount--))}};return(0,s._)([(0,o.Cb)({constructOnly:!0})],t.prototype,"parent",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,s._)([(0,o.Cb)({type:Boolean})],t.prototype,"interactive",null),(0,s._)([(0,o.Cb)()],t.prototype,"_userInteractive",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],t.prototype,"updating",null),(0,s._)([(0,o.Cb)()],t.prototype,"visible",null),(0,s._)([(0,o.Cb)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,s._)([(0,a.j)("esri.views.3d.analysis.AnalysisView3D")],t),t}},88978:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ue});var s=i(27366),r=i(7138),n=i(92026),o=i(49861),a=(i(93169),i(32718)),l=(i(84936),i(69912)),c=i(77671),d=i(98074),u=i(51817),h=i(47898),_=i(94172),p=i(32035),m=i(12400),v=i(2170),g=i(29909),y=i(79803),b=i(78952),w=i(29691),C=i(68859),f=i(67751),P=i(15559),R=i(33906),O=i(39409),S=i(47072);let M=class extends r.Z{constructor(e){super(e),this._unitNormalizer=new O.D,this._tempStartPosition=(0,m.Ue)(),this._tempEndPosition=(0,m.Ue)(),this._tempCornerPosition=(0,m.Ue)()}initialize(){const e=this.view.spatialReference,t=(0,w.rS)(e),i=t===w.GG?w.wY:t;this._sphericalPCPF=i;const s=(0,y.canProjectWithoutEngine)(e,i);this._unitNormalizer.spatialReference=s?i:e,this.addHandles([(0,_.YP)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)}),_.tX),(0,_.YP)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)}),_.tX),(0,_.YP)((()=>({result:this._computedResult,viewData:this.viewData})),(e=>{let{result:t,viewData:i}=e;i.result=t}),_.tX)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view,s=(0,R.G)(e,t,i);return null!==s&&void 0!==s?s:((0,R.e)(this.analysis,e.spatialReference,a.Z.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i}=this.viewData;if(null==e||null==t)return null;const s=this._euclideanDistances(e,t),r=this._geodesicDistance(e,t);let n,o;switch(i){case u.e.Auto:o=null!=r?"geodesic":"euclidean",n=null!==r&&void 0!==r?r:s.horizontal;break;case u.e.Geodesic:if(null==r)return null;o="geodesic",n=r;break;case u.e.Euclidean:o="euclidean",n=s.horizontal}return{mode:o,directDistance:s.direct,horizontalDistance:n,verticalDistance:s.vertical,distance:i===u.e.Euclidean||s.horizontal.value<=S.Y?s.direct:null!==r&&void 0!==r?r:s.horizontal}}_euclideanDistances(e,t){const i=e.clone();i.z=t.z;const s=this._tempStartPosition,r=this._tempEndPosition,n=this._tempCornerPosition,o=this.view.spatialReference,a=this._sphericalPCPF,l=(0,y.canProjectWithoutEngine)(o,a)?a:o;(0,C.K)(e,s,l),(0,C.K)(t,r,l),(0,C.K)(i,n,l);const c=(0,p.q)(s,r),d=(0,p.q)(n,r),u=Math.abs(t.z-e.z),_=e=>this._unitNormalizer.normalizeDistance(e),m=_(c),v=_(d),g=_(u);return{direct:(0,h.yG)(m,"meters"),horizontal:(0,h.yG)(v,"meters"),vertical:(0,h.yG)(g,"meters")}}_geodesicDistance(e,t){const{spatialReference:i}=e,s=new g.Z({spatialReference:i});s.addPath([e,t]);const r=i.isGeographic&&(0,P.Gb)(i)?(0,P.Jf)([s],"meters")[0]:i.isWebMercator?(0,v.geodesicLength)(s,"meters"):null,n=null!=r?r:this._fallbackGeodesicDistance(e,t);return null!=n?(0,h.yG)(n,"meters"):null}_fallbackGeodesicDistance(e,t){if((0,f.U)(e,D)&&(0,f.U)(t,E)){const e=new P._q;return(0,P.cA)(e,D,E,b.Z.WGS84),e.distance}return null}};(0,s._)([(0,o.Cb)()],M.prototype,"view",void 0),(0,s._)([(0,o.Cb)()],M.prototype,"analysis",void 0),(0,s._)([(0,o.Cb)()],M.prototype,"viewData",void 0),(0,s._)([(0,o.Cb)()],M.prototype,"_computedResult",null),M=(0,s._)([(0,l.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],M);const D=(0,m.Ue)(),E=(0,m.Ue)();i(59166);var A,L,z,G=i(86950),T=i(16889),V=i(58935),x=i(17842),j=i(68860),U=i(13611);(z=A||(A={}))[z.None=0]="None",z[z.Direct=1]="Direct",z[z.Triangle=2]="Triangle",z[z.ProjectedGeodesic=3]="ProjectedGeodesic",function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(L||(L={}));var H=i(61201),F=i(33837),N=i(100),W=i(7025),k=i(19093),I=i(86361),q=i(51378),Y=i(52168),Z=i(70619),B=i(56529),Q=i(55158),X=i(37081),K=i(23620),J=i(93822),$=i(4760),ee=i(82144),te=i(31132),ie=i(33559),se=i(78041),re=i(27627),ne=i(25920),oe=i(8883),ae=i(35582),le=i(8548),ce=i(36207);class de extends te.A{constructor(e,t,i){super(e,t,i)}initializeProgram(e){return new re.$(e.rctx,de.shader.get().build(this.configuration),he)}_setPipelineState(e){const t=e===ne.A.NONE,i=this.configuration;return(0,ce.sm)({blending:i.transparent?t?se.wu:(0,se.j7)(e):null,polygonOffset:this.configuration.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:le.wb.LESS},depthWrite:ce.LZ,colorWrite:ce.BK})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return le.MX.TRIANGLE_STRIP}}de.shader=new ee.J(ae.M,(()=>i.e(14142).then(i.bind(i,14142))));class ue extends oe.W{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1,this.transparencyPassType=ne.A.NONE}}(0,s._)([(0,ie.o)()],ue.prototype,"polygonOffsetEnabled",void 0),(0,s._)([(0,ie.o)()],ue.prototype,"transparent",void 0),(0,s._)([(0,ie.o)({count:ne.A.COUNT})],ue.prototype,"transparencyPassType",void 0);const he=new Map([[$.T.POSITION,0],[$.T.NORMAL,1],[$.T.UV0,2],[$.T.LENGTH,3]]);class _e extends B.F5{constructor(e){super(e,new me),this._vertexAttributeLocations=he,this.produces=new Map([[J.r.OPAQUE_MATERIAL,e=>!this._transparent&&(e===X.H_.Color||e===X.H_.Alpha)],[J.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,e=>this._transparent&&(e===X.H_.Color||e===X.H_.Alpha)]]),this._configuration=new ue}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration}intersect(){}createGLMaterial(e){return new pe(e)}createBufferWriter(){return new fe}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class pe extends K.Z{beginSlot(e){return this.ensureTechnique(de,e)}}class me extends B.Mt{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,I.al)(1,.5,0,1),this.stripeEvenColor=(0,I.al)(1,1,1,1),this.stripeOddColor=(0,I.al)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const ve=(0,Q.U$)().vec3f($.T.POSITION).vec3f($.T.NORMAL).vec2f($.T.UV0).f32($.T.LENGTH),ge=(0,m.Ue)(),ye=(0,m.Ue)(),be=(0,m.Ue)(),we=(0,m.Ue)(),Ce=(0,m.Ue)();class fe{constructor(){this.vertexBufferLayout=ve}elementCount(e){return 2*(e.attributes.get($.T.POSITION).indices.length/2+1)}write(e,t,i,s,r){const{data:n,indices:o}=i.attributes.get($.T.POSITION),a=i.attributes.get($.T.NORMAL).data,l=n.length/3;o&&o.length!==2*(l-1)&&console.warn("MeasurementArrowMaterial does not support indices");const c=ge,d=ye,u=be,h=we,_=Ce,m=s.position,v=s.normal,g=s.uv0;let y=0;for(let w=0;w<l;++w){const i=3*w;if((0,p.s)(c,n[i],n[i+1],n[i+2]),w<l-1){const e=3*(w+1);(0,p.s)(d,n[e],n[e+1],n[e+2]),(0,p.s)(_,a[e],a[e+1],a[e+2]),(0,p.n)(_,_),(0,p.f)(u,d,c),(0,p.n)(u,u),(0,p.b)(h,_,u),(0,p.n)(h,h)}const s=(0,p.q)(c,d);e&&t&&((0,p.e)(c,c,e),(0,p.e)(d,d,e),(0,p.e)(h,h,t));const o=r+2*w,b=o+1;m.setVec(o,c),m.setVec(b,c),v.setVec(o,h),v.setVec(b,h),g.set(o,0,y),g.set(o,1,-1),g.set(b,0,y),g.set(b,1,1),w<l-1&&(y+=s)}const b=s.length;for(let p=0;p<2*l;++p)b.set(r+p,y)}}class Pe extends Y._{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,m.Ue)(),this._originTransform=(0,W.Ue)(),this._arrowCenter=(0,m.Ue)(),this._renderOccluded=B.yD.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,I.Ue)(),this._contrastColor=(0,I.Ue)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,G.Ht)(e,this._color)||((0,k.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,G.Ht)(e,this._color)||((0,k.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new _e({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new N.Z,this._handles.add((0,_.YP)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,n.SC)(this._handles)}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){var t;if(null==(null===(t=this._geometry)||void 0===t?void 0:t.startRenderSpace)||null==this._geometry.endRenderSpace)return;const i=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);i.transformation=this._originTransform,e.addGeometry(i),this._viewChanged()}_createArrowGeometry(e,t,i,s){const r=this.view.renderCoordsHelper,n=[],o=[],a=(e,t)=>{const s=q.WM.get();(0,p.f)(s,e,i),n.push(s),o.push(t)};if("euclidean"===s.type){s.eval(.5,this._arrowCenter);const i=q.WM.get();r.worldUpAtPosition(this._arrowCenter,i),a(e,i),a(t,i)}else{s.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),n=q.WM.get(),o=q.WM.get();s.eval(i,n),r.worldUpAtPosition(n,o),a(n,o)}}return(0,Z.rh)(this._arrowMaterial,n,o)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,s=e,r=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:s,stripeOddColor:r})}}var Re=i(98917),Oe=i(9052),Se=i(86700),Me=i(11208),De=i(36257),Ee=i(41201);let Ae=class extends r.Z{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,s=(0,G.O)(t),r=(0,G.Ch)(t,.75),n=(0,G.O)((0,G.mj)(t)),o=(0,G.mj)(i,G.K6.Low);return{accentColor:s,contrastColor:n,translucentAccentColor:r,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,G.G)(o,.6),textCalloutColor:(0,G.G)(o,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return A.None;const i=this.analysisView.result;if(null==i)return A.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?A.ProjectedGeodesic:A.Direct;const{verticalDistance:s,horizontalDistance:r}=i,n=s.value,o=r.value;return Math.min(n/o,o/n)<this.triangleCollapseRatioThreshold?A.Direct:A.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case u.e.Auto:return null!=t&&t.horizontalDistance.value>S.Y?"geodesic":"euclidean";case u.e.Euclidean:return"euclidean";case u.e.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,m.Ue)(),this._endPosition=(0,m.Ue)(),this._cornerPosition=(0,m.Ue)(),this._startPositionAtSeaLevel=(0,m.Ue)(),this._endPositionAtSeaLevel=(0,m.Ue)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=L.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e=this._parameters,t={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:i,guideStippleLengthPixels:s,triangleLineWidth:r,geodesicProjectionLineWidth:n,directLabelFontSize:o,verticalLabelFontSize:a,horizontalLabelFontSize:l}=e;this._segmentVisualElement=new Pe({...t,geometry:null,renderOccluded:B.yD.OccludeAndTransparent}),this._triangleVisualElement=new F.r({...t,width:r,renderOccluded:B.yD.OccludeAndTransparent}),this._rightAngleQuad=new Re.R({...t,renderOccluded:B.yD.OccludeAndTransparent});const c={...t,polygonOffset:!0,renderOccluded:B.yD.OccludeAndTransparent};this._projectedGeodesicLine=new F.r({...c,width:n,stipplePattern:(0,Se.z5)(s)}),this._geodesicStartHint=new F.r({...c,width:i,stipplePattern:(0,Se.z5)(s)}),this._geodesicEndHint=new F.r({...c,width:i,stipplePattern:(0,Se.z5)(s)}),this._segmentLabel=new H.K({...t,fontSize:o}),this._verticalLabel=new H.K({...t,fontSize:a}),this._horizontalLabel=new H.K({...t,fontSize:l}),this.addHandles([(0,_.YP)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),_.tX),(0,_.YP)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),_.tX),(0,_.YP)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),_.tX),(0,_.YP)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),_.tX),(0,_.YP)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),_.tX),(0,De.qe)((async()=>this._updateMessageBundle())),(0,_.YP)((()=>this._parameters),(e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:s,translucentAccentColor:r,accentColor:n,contrastColor:o}=e;const{_segmentLabel:a,_verticalLabel:l,_horizontalLabel:c,_triangleVisualElement:d,_rightAngleQuad:u,_projectedGeodesicLine:h,_geodesicStartHint:_,_geodesicEndHint:p,_segmentVisualElement:m}=this;a.backgroundColor=t,a.calloutColor=i,a.textColor=s,l.backgroundColor=t,l.calloutColor=i,l.textColor=s,c.backgroundColor=t,c.calloutColor=i,c.textColor=s,d.color=r,u.color=r,h.color=r,_.color=r,p.color=r,m.color=n,m.contrastColor=o}),_.nn)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,n.SC)(this._segmentVisualElement),this._triangleVisualElement=(0,n.SC)(this._triangleVisualElement),this._rightAngleQuad=(0,n.SC)(this._rightAngleQuad),this._projectedGeodesicLine=(0,n.SC)(this._projectedGeodesicLine),this._geodesicStartHint=(0,n.SC)(this._geodesicStartHint),this._geodesicEndHint=(0,n.SC)(this._geodesicEndHint),this._segmentLabel=(0,n.SC)(this._segmentLabel),this._verticalLabel=(0,n.SC)(this._verticalLabel),this._horizontalLabel=(0,n.SC)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case A.None:break;case A.Direct:this._segmentVisualElement.visible=!0;break;case A.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case A.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:s,elevationAlignedStartPoint:r,elevationAlignedEndPoint:n,orientation:o,visualizedMeasurement:a,stripeLength:l}=e;const c=t.renderCoordsHelper;if(null==c||null==r||null==n||r.equals(n))return;let d=this._startPosition,u=this._endPosition;c.toRenderCoords(r,d),c.toRenderCoords(n,u);const h=o===L.AboveSegment?1:-1,_=h*(c.getAltitude(u)-c.getAltitude(d));_<0&&(d=this._endPosition,u=this._startPosition);const p="geodesic"===a?new Oe.u(this._startPosition,this._endPosition,c.spatialReference):new Oe.y(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=p,this._updateSegmentStripeLength(l),s){case A.Direct:this._updateSegment(p,o);break;case A.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:p,orientation:o,startPosition:d,endPosition:u,deltaSign:h,altitudeDelta:_});break;case A.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:o,startPosition:d,endPosition:u})}}_updateSegment(e,t){this._segmentLabel.anchor=t===L.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:s,orientation:r,startPosition:n,endPosition:o,deltaSign:a,altitudeDelta:l}=e;const c=this._cornerPosition;t.worldUpAtPosition(n,c),(0,p.h)(c,c,a*Math.abs(l)),(0,p.g)(c,c,n),this._triangleVisualElement.geometry=[[[n[0],n[1],n[2]],[c[0],c[1],c[2]],[o[0],o[1],o[2]]]],this._rightAngleQuad.geometry={previous:n,center:c,next:o};const d=new Oe.y(n,c),u=new Oe.y(c,o),h=function(e,t,i,s,r){const n=ze,o=Ge;r.projectToRenderScreen(i,n),r.projectToRenderScreen(t,o);const a={segment:"bottom",horizontal:"top",vertical:n[0]<o[0]?"left":"right"};{const s=Te,n=Ve;if((0,Me.CM)(e,i,r,s),(0,Me.CM)(e,t,r,n),(0,U.AK)(s,n)>=Le){const e=Math.sign(s[1])===Math.sign(n[1]);a.segment=e?(0,H.j)(a.vertical):a.vertical}else{const e=xe;(0,Me.CM)(i,t,r,e),(0,U.AK)(e,n)>=Le&&(a.segment=Math.sign(e[0])===Math.sign(n[0])?(0,H.j)(a.horizontal):a.horizontal)}}if(s===L.BelowSegment){const e=e=>"top"===e?"bottom":"top";a.segment=e(a.segment),a.horizontal=e(a.horizontal),a.vertical=e(a.vertical)}return a}(n,o,c,r,i);this._segmentLabel.anchor=h.segment,this._segmentLabel.geometry={type:"segment",segment:s,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:d,sampleLocation:"center"},this._verticalLabel.anchor=h.vertical,this._horizontalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._horizontalLabel.anchor=h.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:s,endPosition:r}=e;t.setAltitude(this._startPositionAtSeaLevel,0,s),t.setAltitude(this._endPositionAtSeaLevel,0,r);const n=new Oe.u(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(n),this._geodesicStartHint.setGeometryFromSegment(new Oe.y(this._startPositionAtSeaLevel,s)),this._geodesicEndHint.setGeometryFromSegment(new Oe.y(this._endPositionAtSeaLevel,r)),this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._segmentLabel.anchor=i===L.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const s=this._segmentLabel,r=this._horizontalLabel,n=this._verticalLabel;if(s.visible=!1,r.visible=!1,n.visible=!1,t)switch(i){case A.Direct:s.visible=!0;break;case A.Triangle:s.visible=!0,r.visible=!0,n.visible=!0;break;case A.ProjectedGeodesic:s.visible=!0;case A.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:s,verticalDistance:r}=t,n=this.analysisView.unit,o=e=>({directDistance:"",horizontalDistance:"",verticalDistance:"",...e});switch(n){case"metric":return o({directDistance:i&&(0,V.Rd)(e,i),horizontalDistance:s&&(0,V.Rd)(e,s),verticalDistance:r&&(0,V.Wv)(e,r)});case"imperial":return o({directDistance:i&&(0,V.Ud)(e,i),horizontalDistance:s&&(0,V.Ud)(e,s),verticalDistance:r&&(0,V.Zv)(e,r)});default:return o({directDistance:i&&(0,V.VG)(e,i,n),horizontalDistance:s&&(0,V.VG)(e,s,n),verticalDistance:r&&(0,V.VG)(e,r,n)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===L.Auto?this.view.state.camera.aboveGround?L.AboveSegment:L.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(null===t||void 0===t||!t.state)return!1;const i=t.state.camera,s=t.renderCoordsHelper;if(!s)return!1;const r=i.computeScreenPixelSizeAt(e);return s.getAltitude(e)/r>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const s=e.directDistance;switch(t){case"metric":i=s&&(0,h.nn)(s,"meters");break;case"imperial":i=s&&(0,h.nn)(s,(0,j.Q7)(s.value,s.unit));break;default:i=s&&(0,h.nn)(s,t)}return null==i?null:(0,T.sk)(i.value/30)*(0,j.En)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,Ee.ME)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){var e;return{labels:this.labels,stripeLength:null===(e=this._segmentVisualElement)||void 0===e?void 0:e.stripeLength}}};(0,s._)([(0,o.Cb)()],Ae.prototype,"_parameters",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"_triangleOrientationOverride",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"messages",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"view",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"analysis",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"analysisView",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"loadingMessages",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"visible",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"viewMode",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"actualVisualizedMeasurement",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"visualElementOrientation",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"triangleCollapseRatioThreshold",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"allowVisualElementsOrientationChange",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"labels",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"_labelsText",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"_actualVisualElementsOrientation",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"_measurementArrowStripeLength",null),Ae=(0,s._)([(0,l.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Ae);const Le=Math.cos((0,T.Vl)(12)),ze=(0,x.J$)(),Ge=(0,x.J$)(),Te=(0,x.gX)(),Ve=(0,x.gX)(),xe=(0,x.gX)();let je=class extends((0,d.p)(r.Z)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=u.e.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Ae({view:e,analysis:t,analysisView:this}),this._analysisController=new M({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=(0,n.SC)(this._analysisController),this._analysisVisualization=(0,n.SC)(this._analysisVisualization)}get updating(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.direct)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get horizontalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.horizontal)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get verticalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.vertical)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get unit(){var e;return null!==(e=this.analysis.unit)&&void 0!==e?e:this._defaultUnit}get testData(){var e;return this.destroyed?{labels:null,stripeLength:null,visualization:null,controller:null}:{...null===(e=this._analysisVisualization)||void 0===e?void 0:e.testData,visualization:this._analysisVisualization,controller:this._analysisController}}};(0,s._)([(0,o.Cb)()],je.prototype,"updating",null),(0,s._)([(0,o.Cb)({readOnly:!0})],je.prototype,"type",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0,nonNullable:!0})],je.prototype,"analysis",void 0),(0,s._)([(0,o.Cb)()],je.prototype,"result",void 0),(0,s._)([(0,o.Cb)()],je.prototype,"measurementMode",void 0),(0,s._)([(0,o.Cb)()],je.prototype,"elevationAlignedStartPoint",void 0),(0,s._)([(0,o.Cb)()],je.prototype,"elevationAlignedEndPoint",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],je.prototype,"viewMode",null),(0,s._)([(0,o.Cb)({readOnly:!0})],je.prototype,"actualVisualizedMeasurement",null),(0,s._)([(0,o.Cb)()],je.prototype,"visualElementOrientation",null),(0,s._)([(0,o.Cb)()],je.prototype,"allowVisualElementsOrientationChange",null),(0,s._)([(0,o.Cb)()],je.prototype,"triangleCollapseRatioThreshold",null),(0,s._)([(0,o.Cb)({readOnly:!0})],je.prototype,"directLabelText",null),(0,s._)([(0,o.Cb)({readOnly:!0})],je.prototype,"horizontalLabelText",null),(0,s._)([(0,o.Cb)({readOnly:!0})],je.prototype,"verticalLabelText",null),(0,s._)([(0,o.Cb)()],je.prototype,"_analysisVisualization",void 0),(0,s._)([(0,o.Cb)()],je.prototype,"_analysisController",void 0),(0,s._)([(0,o.Cb)()],je.prototype,"unit",null),(0,s._)([(0,o.Cb)(c.Y)],je.prototype,"_defaultUnit",void 0),je=(0,s._)([(0,l.j)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],je);const Ue=je},51817:(e,t,i)=>{var s;i.d(t,{e:()=>s}),function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(s||(s={}))},39409:(e,t,i)=>{i.d(t,{D:()=>r});var s=i(68860);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.spatialReference=e}get spatialReference(){return this._spatialReference}set spatialReference(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}normalizeDistance(e){return e*this._metersPerDistanceUnit}normalizeElevation(e){return e*this._metersPerElevationUnit}normalizeArea(e){return e*this._squareMetersPerAreaUnit}_updateNormalizationFactors(){this._metersPerDistanceUnit=(0,s.c9)(this._spatialReference,1),this._metersPerElevationUnit=(0,s.c9)(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}}},33906:(e,t,i)=>{i.d(t,{G:()=>n,e:()=>o});var s=i(79803),r=i(77648);function n(e,t,i){var n;let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=(0,s.tryProjectWithZConversion)(e,t);return null==a?null:(a.hasZ&&!o||null==i||(a.z=null!==(n=(0,r.KO)(i,a))&&void 0!==n?n:0),a)}function o(e,t,i){i.warnOnce("Failed to project analysis geometry (id: '".concat(e.id,"'), projection from spatial reference (wkid: '").concat(t.wkid,"') to view spatial reference is not supported. Projection may be possible after calling projection.load()."))}},19182:(e,t,i)=>{i.d(t,{i:()=>b});var s=i(27366),r=i(7138),n=i(79056),o=i(49861),a=(i(93169),i(32718),i(84936),i(69912)),l=i(26279),c=i(78289),d=i(78485);class u{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.eZ.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){var t;this._renderGroup=e;const i=null===(t=this._resources)||void 0===t?void 0:t.layerView;i&&(i.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){var e;this._destroyResources();const t=this._resourceFactory.createResources(),i=new h({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;this._resources={layerView:new h({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:t,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(i)),this._syncGeometriesToRenderer()}_destroyResources(){var e;if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const t=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;t&&t.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!0))}}let h=class extends((0,n.IG)(r.Z)){constructor(e){super(e),this.drapeSourceType=l.Lw.Features,this.updatePolicy=d.j.SYNC,this.renderGroup=l.eZ.Outline}};(0,s._)([(0,o.Cb)({constructOnly:!0})],h.prototype,"view",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],h.prototype,"drapeSourceType",void 0),(0,s._)([(0,o.Cb)()],h.prototype,"renderGroup",void 0),h=(0,s._)([(0,a.j)("DrapedVisualElementLayerView")],h);var _=i(86244),p=i(94172),m=i(79100),v=i(66327),g=i(97882);class y{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==m.U.Mesh&&t.type!==m.U.Line&&t.type!==m.U.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==m.U.Mesh&&t.type!==m.U.Line&&t.type!==m.U.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,i=t._stage;if(!i)return;const s=new g.F(i,{pickable:!1,updatePolicy:d.j.SYNC}),r=new v.T({castShadow:!1}),n=e.createResources(r,s);n.forEach((e=>{i.add(e),e.type===m.U.Texture&&e.load(i.renderView.renderingContext)})),i.add(r),s.add(r);const o=e.cameraChanged,a=o?(0,p.YP)((()=>t.state.camera),(e=>o(e)),p.nn):null;this._resources={layer:s,object:r,external:n,cameraHandle:a},this._syncVisible()}_destroyResources(){var e;if(null==this._resources)return;const t=this._resourceFactory.view._stage;t&&(t.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((e=>{t.remove(e),e.type===m.U.Texture&&e.unload()}))),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class b extends _.l{constructor(e){var t;super(e),this._isDraped=!1,this.object3dResources=new y(this.createObject3DResourceFactory(e.view)),this.drapedResources=new u(this.createDrapedResourceFactory(e.view)),this.isDraped=null!==(t=e.isDraped)&&void 0!==t&&t}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},33837:(e,t,i)=>{i.d(t,{r:()=>h});var s=i(29134),r=i(7025),n=i(32035),o=i(12400),a=i(86361),l=i(52168),c=i(79685),d=i(56529),u=i(58901);class h extends l._{constructor(e,t){super(e),this._hasExternalMaterial=!1,this._hasExternalMaterial=null!=t,this._material=null!=t?t:new u.U({width:1,color:(0,a.al)(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:d.yD.OccludeAndTransparent,isDecoration:!!e.isDecoration,writeDepth:!0}),this.applyProperties(e)}setGeometryFromRenderSpacePoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.geometry=[[[e[0]-t,e[1],e[2]],[e[0]+t,e[1],e[2]]],[[e[0],e[1]-t,e[2]],[e[0],e[1]+t,e[2]]],[[e[0],e[1],e[2]-t],[e[0],e[1],e[2]+t]]]}setGeometryFromExtent(e){const t=this.view.spatialReference,i=(0,o.Ue)(),s=(0,o.Ue)(),r=100,a=[];(0,n.s)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,s),a.push([s[0],s[1],s[2]]),(0,n.s)(i,e[2],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,s),a.push([s[0],s[1],s[2]]),(0,n.s)(i,e[2],e[3],r),this.view.renderCoordsHelper.toRenderCoords(i,t,s),a.push([s[0],s[1],s[2]]),(0,n.s)(i,e[0],e[3],r),this.view.renderCoordsHelper.toRenderCoords(i,t,s),a.push([s[0],s[1],s[2]]),(0,n.s)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,s),a.push([s[0],s[1],s[2]]),(0,n.s)(i,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(i,t,s),a.push([s[0],s[1],s[2]]),this.geometry=[a]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],i=e.origin,s=e.basis1,r=e.basis2,n=.5,a=(0,o.Ue)(),l=(0,o.Ue)(),c=(0,o.Ue)(),d=(0,o.Ue)();a[0]=i[0]-s[0]*n-r[0]*n,a[1]=i[1]-s[1]*n-r[1]*n,a[2]=i[2]-s[2]*n-r[2]*n,l[0]=i[0]-s[0]*n+r[0]*n,l[1]=i[1]-s[1]*n+r[1]*n,l[2]=i[2]-s[2]*n+r[2]*n,c[0]=i[0]+s[0]*n+r[0]*n,c[1]=i[1]+s[1]*n+r[1]*n,c[2]=i[2]+s[2]*n+r[2]*n,d[0]=i[0]+s[0]*n-r[0]*n,d[1]=i[1]+s[1]*n-r[1]*n,d[2]=i[2]+s[2]*n-r[2]*n,t.push([a[0],a[1],a[2]]),t.push([l[0],l[1],l[2]]),t.push([c[0],c[1],c[2]]),t.push([d[0],d[1],d[2]]),t.push([a[0],a[1],a[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;this.transform=(0,s.vc)(_,t);const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.AG;this.transform=(0,s.vc)(_,t),this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}getTransformedGeometry(){return null==this._geometry?null:this._geometry.map((e=>e.map((e=>(0,n.e)((0,o.Ue)(),e,this.transform)))))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(e){this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(e){this._material.setParameters({width:e})}get color(){return this._material.parameters.color}set color(e){const t=1===e[3];this._material.setParameters({color:(0,a.d9)(e),writeDepth:t})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(e){this._material.setParameters({innerWidth:e})}get innerColor(){return this._material.parameters.innerColor}set innerColor(e){this._material.setParameters({innerColor:null!=e?(0,a.d9)(e):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(e){null!=this._material&&this._material.setParameters({stipplePattern:e})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(e){this._material.setParameters({stippleOffColor:null!=e?(0,a.d9)(e):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(e){this._material.setParameters({stipplePreferContinuous:e})}get falloff(){return this._material.parameters.falloff}set falloff(e){this._material.setParameters({falloff:e})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(e){this._material.setParameters({hasPolygonOffset:e})}createExternalResources(){}destroyExternalResources(){}createGeometries(e){for(const t of(0,c.c)(this.geometry)){const i=(0,c.Y)(this._material,t);e.addGeometry(i)}}forEachExternalMaterial(e){this._hasExternalMaterial||e(this._material)}}const _=(0,r.Ue)()},52168:(e,t,i)=>{i.d(t,{_:()=>c});var s=i(29134),r=i(7025),n=i(86244),o=i(66327),a=i(78485),l=i(97882);class c extends n.l{constructor(e){super(e),this._resources=null,this._transform=(0,r.Ue)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(e){(0,s.JG)(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new l.F(e,{pickable:!1,updatePolicy:a.j.SYNC}),i=new o.T({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((t=>{e.remove(t)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}},98917:(e,t,i)=>{i.d(t,{R:()=>f});var s=i(94172),r=i(29134),n=i(7025),o=i(32035),a=i(12400),l=i(19093),c=i(86361),d=i(51378),u=i(55946),h=i(19182),_=i(19265),p=i(91526),m=i(40779),v=i(70619),g=i(56529),y=i(39077),b=i(4760),w=i(66832),C=i(58901);class f extends h.i{constructor(e){super(e),this._maxSize=0,this._position=(0,a.Ue)(),this._up=(0,a.Ue)(),this._right=(0,a.Ue)(),this._renderOccluded=g.yD.OccludeAndTransparent,this._color=(0,c.al)(1,0,0,1),this._outlineColor=(0,c.al)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=g.yD.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,l.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,l.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry(e){let{previous:t,center:i,next:s}=e;this._maxSize=Math.min((0,o.q)(i,t),(0,o.q)(i,s))/3,(0,o.n)(this._up,(0,o.f)(this._up,t,i)),(0,o.n)(this._right,(0,o.f)(this._right,s,i)),(0,o.c)(this._position,i),this.recreateGeometry()}_createObject3DResources(e){const t=new w.E(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new C.U(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,i),{quadMaterial:t,outlineMaterial:i,forEach:e=>{e(t),i&&e(i)}}}_createObject3DGeometries(e,t,i){if((0,o.j)(this._up,a.AG)&&(0,o.j)(this._right,a.AG))return;const s=this._createGeometries(t,i);for(const r of s)e.addGeometry(r);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new w.E(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new C.U(this._outlineMaterialParameters),i=this._createGeometries(e,t).map((e=>new y.z(e)));return this._setTransformDraped(i),{quadMaterial:e,outlineMaterial:t,geometries:i,pixelRatioHandle:(0,s.YP)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[]}_createGeometries(e,t){const{up:i,right:s,corner:r}=this._getVertices(),n=this._quadGeometryData(i,s,r,e);return t?[n,(0,v.rh)(t,[i,r,s])]:[n]}_getVertices(){let e=this._up,t=this._right;const i=(0,o.g)(d.WM.get(),e,t);return this.isDraped&&(e=(0,o.c)(d.WM.get(),e),t=(0,o.c)(d.WM.get(),t),e[2]=0,t[2]=0,i[2]=0),{up:e,right:t,corner:i}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.object3dResources.object;if(!e)return;const t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),s=Math.min(this._maxSize,i);(0,r.vc)(P,this._position),(0,r.bA)(P,P,[s,s,s]),e.transformation=P}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:i}}}=this,{_position:s,_size:n}=this,a=(0,o.c)(d.WM.get(),s);a[2]=_.gi;const l=R;l.spatialReference=t.renderer.spatialReference,l.x=a[0],l.y=a[1];const c=n*(this.view.overlayPixelSizeInMapUnits(l)*i),u=Math.min(this._maxSize,c);(0,r.vc)(P,a),(0,r.bA)(P,P,[u,u,1]);for(const r of e)r.transformation=P}_quadGeometryData(e,t,i,s){return new m.Z(s,[[b.T.POSITION,new p.a([0,0,0,...t,...e,...i],[0,1,2,1,2,3],3,!0)]])}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&e.quadMaterial.setParameters(this._quadMaterialParameters),null===(t=this.drapedResources.resources)||void 0===t||t.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&null!==(e=e.outlineMaterial)&&void 0!==e&&e.setParameters(this._outlineMaterialParameters),null===(t=this.drapedResources.resources)||void 0===t||null===(t=t.outlineMaterial)||void 0===t||t.setParameters(this._outlineMaterialParameters)}}const P=(0,n.Ue)(),R=(0,u.T)(0,0,void 0,null)},86244:(e,t,i)=>{i.d(t,{l:()=>r});var s=i(94172);class r{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,s.YP)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},47072:(e,t,i)=>{i.d(t,{T:()=>n,Y:()=>o});var s=i(15559),r=i(92975);function n(e,t,i,n){for(var o=arguments.length,a=new Array(o>4?o-4:0),l=4;l<o;l++)a[l-4]=arguments[l];return(0,r.sT)(e)&&(0,s.Gb)(e)?t.apply(void 0,a):(0,r.sS)(e)?i.apply(void 0,a):n.apply(void 0,a)}const o=1e5}}]);
//# sourceMappingURL=88978.b19c6ad9.chunk.js.map