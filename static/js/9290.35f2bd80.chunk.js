"use strict";(self.webpackChunksc_land=self.webpackChunksc_land||[]).push([[9290],{25810:(t,e,i)=>{i.d(e,{Z:()=>m});var n=i(27366),s=(i(59486),i(48805)),a=i(11582),o=i(17768),r=i(46784),l=i(49861),c=i(89125),d=(i(84936),i(93169),i(69912)),u=i(25243),p=i(848);let h=class extends((0,r.eC)(a.j)){constructor(t){super(t),this.type="length",this.startPoint=null,this.endPoint=null,this.measureType=s.n.Direct,this.offset=0,this.orientation=0}};(0,n._)([(0,l.Cb)({type:["length"],json:{write:{isRequired:!0}}})],h.prototype,"type",void 0),(0,n._)([(0,l.Cb)({type:p.Z,json:{write:!0}})],h.prototype,"startPoint",void 0),(0,n._)([(0,l.Cb)({type:p.Z,json:{write:!0}})],h.prototype,"endPoint",void 0),(0,n._)([(0,l.Cb)({type:s.V,nonNullable:!0,json:{write:{isRequired:!0}}})],h.prototype,"measureType",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],h.prototype,"offset",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,c.p)((t=>o.BV.normalize((0,u.q9)(t),0,!0)))],h.prototype,"orientation",void 0),h=(0,n._)([(0,d.j)("esri.analysis.LengthDimension")],h);const m=h},48805:(t,e,i)=>{var n;i.d(e,{V:()=>s,n:()=>n}),function(t){t.Horizontal="horizontal",t.Vertical="vertical",t.Direct="direct"}(n||(n={}));const s=[n.Horizontal,n.Vertical,n.Direct]},32500:(t,e,i)=>{i.d(e,{I:()=>f,b:()=>g});var n=i(37081),s=i(33280),a=i(94951),o=i(15226),r=i(26461),l=i(116),c=i(41012),d=i(58406),u=i(98634),p=i(64201),h=i(19253),m=i(25920),_=i(4760);function g(t){const e=new p.kG,{vertex:i,fragment:g}=e;return(0,c.Sv)(i,t),e.include(a.w,t),e.attributes.add(_.T.POSITION,"vec3"),e.attributes.add(_.T.UV0,"vec2"),t.perspectiveInterpolation&&e.attributes.add(_.T.PERSPECTIVEDIVIDE,"float"),e.varyings.add("vpos","vec3"),t.multipassEnabled&&e.varyings.add("depth","float"),i.code.add(u.H`
    void main(void) {
      vpos = position;
      ${t.multipassEnabled?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0;
      gl_Position = transformPosition(proj, view, vpos);

      ${t.perspectiveInterpolation?"gl_Position *= perspectiveDivide;":""}
    }
  `),e.include(s.f5,t),e.include(o.l,t),g.uniforms.add(new h.A("tex",(t=>t.texture)),new d.p("opacity",(t=>t.opacity))),e.varyings.add("vTexCoord","vec2"),t.transparencyPassType===m.A.ColorAlpha&&(e.outputs.add("fragColor","vec4",0),e.outputs.add("fragAlpha","float",1)),g.include(l.Y),g.code.add(u.H`
    void main() {
      discardBySlice(vpos);
      ${t.multipassEnabled?"terrainDepthTest(depth);":""}
      fragColor = texture(tex, vTexCoord) * opacity;

      if (fragColor.a < ${u.H.float(r.F)}) {
        discard;
      }

      fragColor = highlightSlice(fragColor, vpos);
      ${t.transparencyPassType===m.A.ColorAlpha?u.H`
              fragColor = premultiplyAlpha(fragColor);
              fragAlpha = fragColor.a;`:""}
      ${t.output===n.H_.ObjectAndLayerIdColor?u.H`
              fragColor = vec4(0,0,0,1);`:""}
    }
    `),e}const f=Object.freeze(Object.defineProperty({__proto__:null,build:g},Symbol.toStringTag,{value:"Module"}))},98074:(t,e,i)=>{i.d(e,{p:()=>l});var n=i(27366),s=i(42537),a=i(67426),o=i(49861),r=(i(93169),i(32718),i(84936),i(69912));const l=t=>{let e=class extends((0,a.v)(t)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(t){this._userInteractive=t}get updating(){return!1}get visible(){return null==this.parent||this.parent.visible&&!this.parent.suspended}set visible(t){this._overrideIfSome("visible",t)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,s.kB)((()=>this._interactiveViewModelCount--))}};return(0,n._)([(0,o.Cb)({constructOnly:!0})],e.prototype,"parent",void 0),(0,n._)([(0,o.Cb)({constructOnly:!0})],e.prototype,"view",void 0),(0,n._)([(0,o.Cb)({type:Boolean})],e.prototype,"interactive",null),(0,n._)([(0,o.Cb)()],e.prototype,"_userInteractive",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],e.prototype,"updating",null),(0,n._)([(0,o.Cb)()],e.prototype,"visible",null),(0,n._)([(0,o.Cb)()],e.prototype,"_interactiveViewModelCount",void 0),e=(0,n._)([(0,r.j)("esri.views.3d.analysis.AnalysisView3D")],e),e}},89290:(t,e,i)=>{i.r(e),i.d(e,{default:()=>We});var n,s=i(27366),a=i(7138),o=i(42537),r=(i(93169),i(32718)),l=i(92026),c=i(94172),d=i(49861),u=(i(84936),i(69912)),p=i(98074),h=i(48805),m=i(68860),_=i(74177),g=i(16889),f=i(47898),v=i(29134),y=i(7025),S=i(32035),b=i(12400),M=i(14320),C=i(51378),w=i(55946),P=i(37818),x=i(9052),D=i(59418),T=i(4914),O=i(47072);function I(t){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i,dimension:{offset:n,measureType:s,orientation:a}}=t;return{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i,offset:n,measureType:s,orientation:a}}function A(t,e){let{elevationAlignedStartPoint:i,elevationAlignedEndPoint:n,offset:s,measureType:a,orientation:o}=t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==i||null==n)return null;const l=H(r?.directSegment??new x.y,{elevationAlignedStartPoint:i,elevationAlignedEndPoint:n},e),c=r?.primaryOffsetAxis??(0,b.Ue)();j(c,{measureType:a,elevationAlignedStartPoint:i,elevationAlignedEndPoint:n,directSegment:l,orientation:o,renderCoordsHelper:e});const d=r?.dimensionSegment??new x.y;return G({elevationAlignedStartPoint:i,elevationAlignedEndPoint:n})&&a===h.n.Vertical?((0,S.c)(d.startRenderSpace,l.startRenderSpace),(0,S.c)(d.endRenderSpace,l.endRenderSpace)):N(d,{offsetAxis:c,offset:s,relativeToSegment:l,renderCoordsHelper:e}),{elevationAlignedStartPoint:i,elevationAlignedEndPoint:n,directSegment:l,dimensionSegment:d,primaryOffsetAxis:c,spatialReference:e.spatialReference}}function R(t,e,i,s){return e===n.Start?((0,S.c)(t.startRenderSpace,i.startRenderSpace),(0,S.c)(t.endRenderSpace,s.startRenderSpace)):((0,S.c)(t.startRenderSpace,i.endRenderSpace),(0,S.c)(t.endRenderSpace,s.endRenderSpace)),t}function z(t,e,i,n){switch(e){case h.n.Direct:return H(t,i,n);case h.n.Horizontal:case h.n.Vertical:{const{elevationAlignedStartPoint:s,elevationAlignedEndPoint:a,dimension:o,geometry:r}=i;let l;o.measureType===h.n.Direct?(l=function(t,e){const i=t.directSegment.eval(.5,C.WM.get()),n=e.worldUpAtPosition(i,C.WM.get()),s=t.dimensionSegment.eval(.5,C.WM.get()),a=(0,S.z)(C.WM.get(),s,i);return!(0,S.G)(a,b.AG)&&(0,S.m)(a,n)>0}(r,n)===s.z>a.z,e===h.n.Horizontal&&(l=!l)):l=!function(t){const{startRenderSpace:e,endRenderSpace:i}=t.dimensionSegment,{startRenderSpace:n,endRenderSpace:s}=t.directSegment;return(0,S.w)(n,e)<(0,S.w)(s,i)}(r);const[c,d]=l?[s,a]:[a,s],u=(0,P.WG)(d,k);return e===h.n.Horizontal?u.z=c.z:(u.x=c.x,u.y=c.y),n.toRenderCoords(c,t.startRenderSpace),n.toRenderCoords(u,t.endRenderSpace),t}}}function H(t,e,i){return i.toRenderCoords(e.elevationAlignedStartPoint,t.startRenderSpace),i.toRenderCoords(e.elevationAlignedEndPoint,t.endRenderSpace),t}!function(t){t[t.Start=0]="Start",t[t.End=1]="End"}(n||(n={}));const k=(0,w.T)(0,0,0,null);const E=new x.y;function j(t,e){const{measureType:i,elevationAlignedStartPoint:n,elevationAlignedEndPoint:s,directSegment:{startRenderSpace:a,endRenderSpace:o},directSegment:r,renderCoordsHelper:l}=e,c=r.eval(.5,C.WM.get()),d=l.worldUpAtPosition(c,C.WM.get()),u=l.worldBasisAtPosition(c,M.R.Y,C.WM.get());switch(i){case h.n.Horizontal:(0,S.c)(t,d);break;case h.n.Vertical:(0,S.m)(a,d)<(0,S.m)(o,d)?(0,S.z)(t,o,a):(0,S.z)(t,a,o),(0,S.b)(t,t,d),(0,S.b)(t,t,d);break;case h.n.Direct:{const i=e.orientation??0;if(G({elevationAlignedStartPoint:n,elevationAlignedEndPoint:s}))(0,v.Us)(L,-(0,g.Vl)(i),d),(0,S.h)(t,u,L);else{const e=(0,S.z)(C.WM.get(),o,a),n=(0,S.b)(C.WM.get(),e,d);(0,S.b)(n,n,e),(0,v.Us)(L,(0,g.Vl)(i),e),(0,S.h)(t,n,L)}break}}return(0,S.G)(t,b.AG)?(0,S.c)(t,u):(0,S.n)(t,t)}const L=(0,y.Ue)();function G(t){let{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i}=t;return null!=e&&null!=i&&e.x===i.x&&e.y===i.y}function N(t,e){const{offsetAxis:i,offset:n,relativeToSegment:{startRenderSpace:s,endRenderSpace:a},relativeToSegment:o,renderCoordsHelper:r}=e,l=n/r.unitInMeters,[c,d]=function(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=(0,S.m)(e,i),a=(0,S.m)(t,i),o=Math.abs(s-a)+n;return s>a?[o,n]:[n,o]}(s,a,i,l);return(0,S.r)(t.startRenderSpace,o.startRenderSpace,i,c),(0,S.r)(t.endRenderSpace,o.endRenderSpace,i,d),t}function U(t,e,i){const n=e.directSegment.eval(.5,C.WM.get());return i.worldUpAtPosition(n,t)}function V(t,e){const{startRenderSpace:i,endRenderSpace:n}=e.directSegment;return(0,S.z)(t,n,i)}function Z(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{invert:!1};const{startRenderSpace:n,endRenderSpace:s}=e.dimensionSegment;return i.invert?(0,S.z)(t,n,s):(0,S.z)(t,s,n)}function Y(t,e){const i=t.directSegment.eval(.5,C.WM.get());return e.headingAtPosition(i,t.primaryOffsetAxis)}const W=(0,b.Ue)();function F(t){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i}=t;if(null==e||null==i)return!1;const n=(0,T.Z1)(e,i);return null!=n&&(0,f.nn)(n,"meters").value>O.Yo}function X(t){return null!=t.geometry}let B=class extends a.Z{constructor(t){super(t)}initialize(){const t=(0,c.wZ)((()=>this.analysisViewData.computations),(t=>{let{computation:e}=t;return this._watchComputation(e)}));this.addHandles((0,o.ed)(t))}get analysis(){return this.analysisViewData.analysis}get _defaultUnit(){return(0,_.R)(this.view)}_watchComputation(t){return(0,c.YP)((()=>I(t)),(e=>{const{measureType:i}=e;if(F(e)&&i!==h.n.Direct){const e=Math.round((0,m.En)(O.Yo,"meters","kilometers"));return r.Z.getLogger(this).warnOnce(`A ${i} dimension in the analysis (id: '${this.analysis.id}') will not display, because only direct dimensions can measure lengths greater than ${e} km. Update the measureType of the affected dimension to "direct" to display it.`),void(t.geometry=null)}const n=A(e,this.view.renderCoordsHelper,t.geometry);t.geometry=n,t.result.length=function(t,e,i){if(null==t)return null;let n;if(e===h.n.Horizontal)n=(0,D.Qw)(t.elevationAlignedStartPoint,t.elevationAlignedEndPoint);else{const{startRenderSpace:e,endRenderSpace:i}=t.dimensionSegment;n=(0,T.FN)(e,i,t.spatialReference)}if(null==n)return null;const s=e===h.n.Vertical?(0,m.yv)(n.value,n.unit,i):(0,m.wd)(n.value,n.unit,i);return(0,f.nn)(n,s)}(n,i,this._defaultUnit)}),c.tX)}};(0,s._)([(0,d.Cb)({constructOnly:!0})],B.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],B.prototype,"view",void 0),(0,s._)([(0,d.Cb)()],B.prototype,"analysis",null),(0,s._)([(0,d.Cb)()],B.prototype,"_defaultUnit",null),B=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.DimensionController")],B);i(59486);var $=i(84702),Q=i(51995),q=i(17768),J=i(17842),K=i(86361),tt=i(55652),et=i(86950);function it(t){return(0,et.G)(t.accentColor,.5)}const nt=new Q.Z([127,127,127,.5]),st=6,at=5;var ot=i(35284),rt=i(83639),lt=i(40508),ct=i(51328),dt=i(2522),ut=i(91526),pt=i(40779),ht=i(70619),mt=i(56529),_t=i(4760),gt=i(66156),ft=i(58901),vt=i(74229),yt=i(99034),St=i(848);class bt{constructor(t){this.start=t.start,this.end=t.end,this.offset=t.offset,this.heading=t.heading,this.rotation=t.rotation,this.direct=t.direct,this.horizontal=t.horizontal,this.vertical=t.vertical}manipulatorName(t){return Object.keys(this).find((e=>this.hasOwnProperty(e)&&t===this[e]))}values(){return[this.start,this.end,this.offset,this.heading,this.rotation,this.direct,this.horizontal,this.vertical]}forEachMeasureTypeManipulator(t){for(const e of h.V)t(this.manipulatorForMeasureType(e),e)}manipulatorForMeasureType(t){switch(t){case h.n.Direct:return this.direct;case h.n.Horizontal:return this.horizontal;case h.n.Vertical:return this.vertical}}}class Mt extends ot.Z{constructor(t,e){const i=(0,rt.EA)(Q.Z.toUnitRGBA(it(t.effectiveTheme))),n=[new lt.r((0,ht.PI)(i,1,32,32),Gt)];super({view:t,renderObjects:n,metadata:e.metadata,available:!1,grabCursor:"crosshair",radius:5,collisionPriority:1}),this._themeHandle=(0,c.YP)((()=>({color:Q.Z.toUnitRGBA(it(t.effectiveTheme))})),(t=>i.setParameters(t)))}destroy(){this._themeHandle.remove(),super.destroy()}}class Ct extends ot.Z{constructor(t,e){let{lineSizePt:i,material:n,metadata:s}=e;super({view:t,autoScaleRenderObjects:!1,collisionPriority:1,metadata:s}),this._options={calloutColor:(0,K.Ue)(),lineSizePt:i,material:n},this._themeHandle=(0,c.YP)((()=>Q.Z.toUnitRGBA(it(t.effectiveTheme))),(t=>{this._options.calloutColor=t,Lt(this,wt({...this._options,metadata:this.metadata}))}),c.nn)}update(t){let{lineSizePt:e,material:i}=t;this._options.lineSizePt=e,this._options.material=i,Lt(this,wt({...this._options,metadata:this.metadata}))}destroy(){this._themeHandle.remove(),super.destroy()}}function wt(t){let{calloutColor:e,lineSizePt:i,material:n,metadata:s}=t;return{calloutLength:.25*dt.M_*.8*(0,J.F2)(i)+18,calloutColor:e,calloutWidth:2,customStateMask:Gt,discScale:.3,focusMultiplier:2,material:n,metadata:s}}function Pt(t,e){let{computation:i,view:n}=e;return[(0,vt.Xd)(t,((t,e,s)=>{xt({cancel:s,computation:i,settingHeading:!1,steps:e,view:n})})),t.events.on("immediate-click",(t=>{!function(t,e,i){const{dimension:n,geometry:s}=e;if(90===n.orientation||270===n.orientation)return n.orientation=0,void t.stopPropagation();if(null==s)return;const{renderCoordsHelper:a}=i,o=A({...I(e),orientation:90},a),r=A({...I(e),orientation:270},a);if(null==o||null==r)return;const l=Y(o,a),c=Y(r,a),d=Ot(s,i),u=q.BV.shortestSignedDiff(d,l),p=q.BV.shortestSignedDiff(d,c);n.orientation=Math.abs(u)<Math.abs(p)?90:270,t.stopPropagation()}(t,i,n)}))]}function xt(t){const{cancel:e,computation:i,settingHeading:n,steps:s,view:a}=t;if(!X(i))return;const{renderCoordsHelper:o}=a,{dimension:r,geometry:l}=i,c=(0,b.Ue)(),d=zt((0,b.Ue)(),l,l.directSegment,o),u=Ht(C.WM.get(),{forHeading:n,geometry:l,renderCoordsHelper:o}),p=(0,tt.Yq)(d,u,(0,tt.Ue)()),h=n?r.orientation??Y(l,a.renderCoordsHelper):r.orientation??0;s.next((0,ct._N)(a,p)).next((t=>{"start"===t.action&&(0,S.c)(c,t.renderStart);const e=(0,tt.st)(p),i=(0,rt.Gd)(c,t.renderEnd,d,e);let s=h-(0,g.BV)(i);n||(s=function(t){const e=q.BV.normalize(t)%90;return e<at?t-e:90-e<at?t+(90-e):t}(s)),r.orientation=s})),e.next((0,vt.di)(r,["orientation"]))}function Dt(t,e){let{computation:i,manipulatorMeasureType:n,view:s}=e,a=h.n.Direct,o=0,r=0;return[t.events.on("grab-changed",(e=>{if("start"!==e.action||!X(i))return;const{dimension:l,geometry:c}=i;a=l.measureType,o=l.offset,r=l.orientation;const d=(0,S.c)(C.WM.get(),t.renderLocation);l.measureType=n,l.offset=function(t,e,i,n){const{directSegment:s}=i,a=j(C.WM.get(),{measureType:e,directSegment:s,renderCoordsHelper:n}),o=N(E,{offsetAxis:a,offset:0,relativeToSegment:s,renderCoordsHelper:n}).eval(.5,C.WM.get()),r=(0,S.z)(C.WM.get(),t,o);return(0,S.m)(r,a)*n.unitInMeters}(d,n,c,s.renderCoordsHelper),l.orientation=0})),(0,vt.Xd)(t,((t,e,l)=>{if(!X(i))return;const{geometry:c,dimension:d}=i,{renderCoordsHelper:u}=s,p=z(Zt,n,i,u),h=j(C.WM.get(),{measureType:n,directSegment:c.directSegment,renderCoordsHelper:u}),m=(0,ct.J4)(t);e.next(m).next(Tt(s,d,p,h)),l.next(m).next((t=>(d.measureType=a,d.offset=o,d.orientation=r,t)))}))]}function Tt(t,e,i,n){const s=(0,S.f)(C.WM.get(),i.endRenderSpace,i.startRenderSpace);(0,S.b)(s,s,n);const a=(0,tt.Yq)(i.startRenderSpace,s,(0,tt.Ue)()),o=(0,tt.Yq)(i.startRenderSpace,n,(0,tt.Ue)()),r=e.offset;let l,c=0;const d=new vt.hM;return d.next((0,ct._N)(t,a)).next((i=>{"start"===i.action&&(c=(0,tt.jH)(o,i.renderStart));const n=((0,tt.jH)(o,i.renderEnd)-c)*t.renderCoordsHelper.unitInMeters;e.offset=r+n,l=i})),t=>(d.execute(t),l)}function Ot(t,e){const{directSegment:i}=t,{renderCoordsHelper:n}=e,s=U(C.WM.get(),t,n),a=V(C.WM.get(),t),o=(0,S.b)(C.WM.get(),a,s),{viewForward:r}=e.state.camera;(0,S.m)(o,r)>0&&(0,S.j)(o,o,-1);const l=i.eval(.5,C.WM.get());return n.headingAtPosition(l,o)}function It(t,e,i,n){let{forHeading:s}=n;const{dimension:a,geometry:o}=e,{primaryOffsetAxis:r}=o,l=(0,S.j)(At,r,a.offset>=0?1:-1),c=Ht(Rt,{forHeading:s,geometry:o,renderCoordsHelper:i});(0,S.b)(c,c,l);const d=(0,rt.Aq)(l,c,b.AG,Vt);t.modelTransform=d,t.renderLocation=zt(Nt,o,o.dimensionSegment,i)}const At=(0,b.Ue)(),Rt=(0,b.Ue)();function zt(t,e,i,n){const{startRenderSpace:s,endRenderSpace:a}=i,o=function(t,e){const i=V(kt,t),n=U(Et,t,e);return(0,S.m)(i,n)>0}(e,n)?s:a;return(0,S.c)(t,o)}function Ht(t,e){let{forHeading:i,geometry:n,renderCoordsHelper:s}=e;return i?U(t,n,s):Z(t,n,{invert:!0})}const kt=(0,b.Ue)(),Et=(0,b.Ue)();function jt(t){return(0,J.F2)(t)+st}function Lt(t,e){const i=e.material??new gt.j({transparent:!0,writeDepth:!1,textureId:e.texture?.id,renderOccluded:mt.yD.Opaque,isDecoration:!0}),n=e.focusMultiplier??rt.rotateManipulatorDefaults.focusMultiplier,s=e.calloutLength??rt.rotateManipulatorDefaults.calloutLength,a=rt.rotateManipulatorDefaults.discRadius*(e.discScale??1),o=a*n,r=(t,e)=>{const i=[0,1,2,2,3,0];return new pt.Z(e,[[_t.T.POSITION,new ut.a([s-t,-t,0,s+t,-t,0,s+t,t,0,s-t,t,0],i,3,!0)],[_t.T.UV0,new ut.a([0,0,1,0,1,1,0,1],i,2,!0)]])},l=e.calloutWidth??rt.rotateManipulatorDefaults.calloutWidth,c=new ft.U({width:l,color:e.calloutColor,renderOccluded:mt.yD.OccludeAndTransparent,isDecoration:!0}),d=(0,ht.rh)(c,[[0,0,0],[s-a,0,0]]),u=(0,ht.rh)(c,[[0,0,0],[s-o,0,0]]),p=e.customStateMask??yt.jg.None;t.collisionType={type:"disc",direction:[0,0,1],offset:[s,0,0]},t.focusMultiplier=n,t.metadata=e.metadata,t.radius=a,t.renderObjects=[new lt.r(r(a,i),yt.Q9.Unfocused|p),new lt.r(d,yt.Q9.Unfocused|p),new lt.r(r(o,i),yt.Q9.Focused|p),new lt.r(u,yt.Q9.Focused|p)]}const Gt=yt.jg.Custom1,Nt=(0,b.Ue)(),Ut=(0,b.Ue)(),Vt=(0,y.Ue)(),Zt=new x.y;var Yt,Wt=i(25810),Ft=i(100),Xt=i(84652),Bt=i(97942),$t=i(66978),Qt=i(46634);function qt(t,e,i){const{constraint:n,elevationAlignedStartPoint:s,elevationAlignedEndPoint:a,unconstrainedGeometry:o,view:r}=i,{dimension:l,previousConstraint:c,preConstraintProperties:d}=t;if(null==s||null==a)return;const u=()=>{"startPoint"in e?l.startPoint=e.startPoint:"endPoint"in e&&(l.endPoint=e.endPoint)};if(null==n)u(),null!=c&&null!=d&&(l.measureType=d.measureType,l.orientation=d.orientation);else switch(l.measureType=h.n.Direct,n){case Yt.Horizontal:if(n!==c&&(l.orientation=0),"startPoint"in e){const t=e.startPoint;null!=t&&(t.z=a.z),l.startPoint=t}else if("endPoint"in e){const t=e.endPoint;null!=t&&(t.z=s.z),l.endPoint=t}break;case Yt.Vertical:if(n!==c&&(l.orientation=Ot(o,r)),"startPoint"in e){const t=e.startPoint;null!=t&&(t.x=a.x,t.y=a.y),l.startPoint=t}else if("endPoint"in e){const t=e.endPoint;null!=t&&(t.x=s.x,t.y=s.y),l.endPoint=t}break;case Yt.Direct:n!==c&&null!=d&&(l.orientation=d.orientation),u()}t.previousConstraint=n,t.unconstrainedGeometry=o}!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.Direct=2]="Direct"}(Yt||(Yt={}));var Jt=i(11526),Kt=i(79311),te=i(33837),ee=i(27676),ie=i(86700),ne=i(14813),se=i(84954),ae=i(17877),oe=i(34019),re=i(80151),le=i(14285),ce=i(71040),de=i(34356);let ue=class extends a.Z{constructor(t){super(t),this._stagedDimension=null,this._computationManipulators=new Map,this._computationHandles=new Ft.Z,this._orientationManipulatorTexture=null,this._updatingHandles=new Qt.R,this._getSnappingContext=(0,Bt.H)((t=>new oe.N({elevationInfo:{mode:"absolute-height",offset:0},pointer:t,editGeometryOperations:new ae.c(new se.XE("point",(0,ne.Y6)(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new Kt._})));const{view:e}=t;this._snappingManagerResult=(0,le.u)(e),this.addHandles(this._snappingManagerResult),this._unfocusedOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._focusedOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._thinOffsetManipulatorMaterial=this._createOffsetManipulatorMaterial(),this._thinOffsetManipulatorMaterial.setParameters({stipplePattern:(0,ie.z5)(2)}),this._constraintSnappingIndicator=new te.r({view:e,attached:!0,width:1,renderOccluded:mt.yD.OccludeAndTransparent,stipplePattern:(0,ie.z5)(5),isDecoration:!0});const i=Q.Z.toUnitRGBA(nt);this._stagedStartIndicator=new ee.j({view:e,attached:!1,elevationInfo:{mode:"absolute-height",offset:0},spatialReference:t.view.renderCoordsHelper.spatialReference,color:i,size:10,outlineSize:0,renderOccluded:mt.yD.OccludeAndTransparent,isDecoration:!0})}initialize(){const{view:t}=this;this._snappingOperation=new ce.y({view:t});const e=!t._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this._orientationManipulatorMaterial=new gt.j({transparent:!0,writeDepth:!1,renderOccluded:mt.yD.Opaque,isDecoration:!0}),this.addHandles((0,c.YP)((()=>{return{accentColor:it(t.effectiveTheme),contrastColor:(e=t.effectiveTheme,(0,et.mj)(e.accentColor))};var e}),(i=>{let{accentColor:n,contrastColor:s}=i;const a=this._orientationManipulatorTexture,o=(0,Jt.O)(t.textures,{accentColor:n,contrastColor:s,preMultiplyAlpha:e});this._orientationManipulatorMaterial.setParameters({textureId:o.texture.id}),this._orientationManipulatorTexture=o,a?.release();const r=Q.Z.toUnitRGBA(n);this._unfocusedOffsetManipulatorMaterial.setParameters({color:r}),this._focusedOffsetManipulatorMaterial.setParameters({color:r}),this._thinOffsetManipulatorMaterial.setParameters({color:r}),this._constraintSnappingIndicator.color=r}),c.nn));const i=(0,c.wZ)((()=>this.analysisViewData.computations),(t=>{let{computation:e}=t;return this._createManipulators(e)}));this.addHandles((0,o.ed)(i)),this.addHandles([(0,c.YP)((()=>({stagedPoint:this._snappingOperation.stagedPoint,stagedComputation:this._stagedComputation})),(t=>{let{stagedPoint:e,stagedComputation:i}=t;if(null==i||null==e)return;const n=(0,P.WG)(e,new St.Z);this._applyPointUpdate(i,{endPoint:n})}),c.Z_),(0,c.YP)((()=>({stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator})),((t,e)=>{const{stagedDimension:i,selectedComputation:n,firstGrabbedManipulator:s}=t;if(i===e?.stagedDimension&&s===e?.firstGrabbedManipulator){for(const a of[n,e?.selectedComputation])if(null!=a){const e=this._computationManipulators.get(a);null!=e&&this._updateManipulators(a,e,t)}}else for(const[a,o]of this._computationManipulators)this._updateManipulators(a,o,t)}),c.tX),(0,c.YP)((()=>this.analysis.style.lineSize),(t=>{this._updateManipulatorStyle(t)}),c.nn),(0,c.YP)((()=>this.view.state.camera),(()=>{null!=this._stagedComputation&&this._updateStagedDimensionOffset(this._stagedComputation)})),(0,c.YP)((()=>{const t=this._stagedComputation;if(!t)return null;const e=t.elevationAlignedStartPoint,i=(0,b.Ue)();return null!=e&&this.view.renderCoordsHelper.toRenderCoords(e,i)?i:null}),(t=>{null!=t?(this._stagedStartIndicator.vertices=[t],this._stagedStartIndicator.attached=!0):this._stagedStartIndicator.attached=!1}))]),this.addHandles(this._constraintHandles),this.addHandles(this._snappingIndicatorHandles),(0,de.Ob)(this,(()=>{const t=this._activeComputation,e=this._stagedComputation;if(null==t||null!=e){const t=this.view.inputManager.latestPointerType??"mouse",e=this._getSnappingContext(t);this._updatingHandles.addPromise((0,$t.R8)(this._snappingOperation.snapAgainNearPreviousMapPoint(this._snappingManager,e)))}if(null!=t){const{start:e,end:i}=this._computationManipulators.get(t);if(e.grabbing||i.grabbing){!function(t,e,i){let{constraint:n,view:s}=i;const{unconstrainedGeometry:a}=t;if(null==a)return;const{renderCoordsHelper:o,spatialReference:r}=s,{startRenderSpace:l,endRenderSpace:c}=a.directSegment,d=o.fromRenderCoords(l,new St.Z({spatialReference:r})),u=o.fromRenderCoords(c,new St.Z({spatialReference:r}));let p;p="start"===e?{startPoint:d}:{endPoint:u},qt(t,p,{constraint:n,elevationAlignedStartPoint:t.elevationAlignedStartPoint,elevationAlignedEndPoint:t.elevationAlignedEndPoint,unconstrainedGeometry:a,view:s})}(t,e.grabbing?"start":"end",{constraint:this._computeConstraint(t),view:this.view})}}}))}destroy(){this._snappingOperation=(0,l.SC)(this._snappingOperation),this._computationHandles.destroy(),this._constraintSnappingIndicator.destroy(),this._stagedStartIndicator.destroy(),this._orientationManipulatorTexture?.release()}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}get firstGrabbedManipulator(){return this.parentTool.firstGrabbedManipulator}get hasGrabbedManipulators(){return this.parentTool.hasGrabbedManipulators}get snappingOptions(){return this._snappingManager.options}get _snappingManager(){return this._snappingManagerResult.snappingManager}get _activeComputation(){if(null!=this._stagedComputation)return this._stagedComputation;const{selectedComputation:t}=this.analysisViewData;return this.hasGrabbedManipulators&&null!=t?t:null}get _stagedComputation(){const t=this._stagedDimension,e=this.analysisViewData.computations.at(-1)?.computation;return null==t||null==e||e.dimension!==t?null:e}get _constraintHandles(){return[(0,c.gx)((()=>this.analysisViewData.selectedComputation),(t=>{t.previousConstraint=this._computeConstraint(t)}),{...c.tX,equals:Xt.fS}),(0,c.YP)((()=>{const t=this._activeComputation;if(null==t)return null;const{measureType:e,orientation:i}=t.dimension;return{measureType:e,orientation:i,computation:t}}),((t,e)=>{if(null!=t&&null==e){const{measureType:e,orientation:i,computation:n}=t;switch(n.previousConstraint){case Yt.Horizontal:n.preConstraintProperties={measureType:h.n.Horizontal,orientation:0};break;case Yt.Vertical:n.preConstraintProperties={measureType:h.n.Vertical,orientation:0};break;case Yt.Direct:n.preConstraintProperties={measureType:h.n.Direct,orientation:i};break;default:n.preConstraintProperties={measureType:e,orientation:i}}}null==t&&null!=e&&(e.computation.preConstraintProperties=null)}),c.Z_)]}get _snappingIndicatorHandles(){const t="snapping-indicator-event-handles";return[(0,c.YP)((()=>({stagedComputation:this._stagedComputation,activeComputation:this._activeComputation})),(e=>{let{stagedComputation:i,activeComputation:n}=e;const s=this._constraintSnappingIndicator;if(this.removeHandles(t),null!=n)if(n===i)s.attached=!0;else{const{start:e,end:i}=this._computationManipulators.get(n),a=()=>{s.attached=e.grabbing||i.grabbing};a(),this.addHandles([e.events.on("grab-changed",a),i.events.on("grab-changed",a)],t)}else s.attached=!1})),(0,c.YP)((()=>{const t=this._activeComputation;return null!=t?{geometry:t.geometry,constraint:t.previousConstraint}:{}}),(t=>{let{geometry:e,constraint:i}=t;const n=this._constraintSnappingIndicator;null!=e&&null!=i&&i!==Yt.Direct?(n.visible=!0,n.setGeometryFromSegment(e.directSegment)):n.visible=!1}))]}removeStaged(){return null!=this._stagedDimension&&(this.analysis.dimensions.remove(this._stagedDimension),this._stagedDimension=null,!0)}onDeactivate(){this.removeStaged(),this._resetSnappingState()}onClick(t){const{_stagedDimension:e}=this;if(null==e){const e=this._onUnstagedClick(t);return this.analysis.dimensions.add(e),null}return this._onStagedClick(t),e}onPointerMove(t){let{mapPoint:e,pointerType:i}=t;if("touch"===i)return;const n=this._getSnappingContext(i);this._updatingHandles.addPromise((0,$t.R8)(this._snappingOperation.snap({point:e},this._snappingManager,n)))}onManipulatorSelectionChanged(){null!=this.analysisViewData.selectedComputation&&(this._computationManipulators.get(this.analysisViewData.selectedComputation).offset.selected||(this.analysisViewData.selectedDimension=null))}_onUnstagedClick(t){let{mapPoint:e,pointerType:i}=t,n=e;if("mouse"===i){const t=this._getSnappingContext(i);n=this._snappingManager.update({point:e,context:t})}const s=new Wt.Z({startPoint:(0,P.WG)(n,new St.Z),endPoint:null,measureType:h.n.Horizontal});return this._stagedDimension=s,this._resetSnappingState(),s}_onStagedClick(t){let{mapPoint:e,pointerType:i}=t;const n=this._stagedComputation;if(null==n)return;let s=e;if("mouse"===i){const t=this._getSnappingContext(i);s=this._snappingManager.update({point:e,context:t})}const a=(0,P.WG)(s,new St.Z);this._applyPointUpdate(n,{endPoint:a}),this._stagedDimension=null,this._resetSnappingState()}_resetSnappingState(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}_createManipulators(t){const e=this._setupPointManipulator(t,{isStart:!0}),i=this._setupPointManipulator(t,{isStart:!1}),n=this._setupOffsetManipulator(t),s=this._setupHeadingManipulator(t),a=this._setupRotationManipulator(t),o=this._setupMeasureTypeManipulator(t,h.n.Direct),r=this._setupMeasureTypeManipulator(t,h.n.Horizontal),l=this._setupMeasureTypeManipulator(t,h.n.Vertical),c=new bt({start:e,end:i,offset:n,heading:s,rotation:a,direct:o,horizontal:r,vertical:l});return this._setupComputationToManipulatorsSync(t,c),this._computationManipulators.set(t,c),this.manipulators.addMany(c.values()),{manipulators:c,remove:()=>{this._computationHandles.remove(t),this._computationManipulators.delete(t);for(const t of c.values())this.manipulators.remove(t)}}}_setupComputationToManipulatorsSync(t,e){this._computationHandles.add([(0,c.YP)((()=>t.geometry),(()=>this._updateManipulators(t,e)),{...c.tX,equals:Xt.fS})],t)}_setupPointManipulator(t,e){const{view:i}=this,{dimension:n}=t,s=new Mt(i,{metadata:n}),a=function(t,e){let{isStart:i,createSnappingPipelineStep:n,dimension:s,onUpdate:a,view:o}=e;const r=i?"startPoint":"endPoint",l=(0,vt.Xd)(t,((t,e,i,l)=>{const c=(0,ct.J4)(t),{snappingStep:d,cancelSnapping:u}=n(l);i=i.next(c).next((0,vt.di)(s,[r,"measureType","orientation"])).next(u),e.next(c).next((0,ct.gv)(o)).next(...d).next((t=>{const e=(0,P.WG)(t.mapEnd,new St.Z);a("startPoint"===r?{startPoint:e}:{endPoint:e})}))}));return[l]}(s,{isStart:e.isStart,createSnappingPipelineStep:t=>(0,re.W)({snappingContext:this._getSnappingContext(t),snappingManager:this._snappingManager,updatingHandles:this._updatingHandles}),dimension:n,onUpdate:e=>this._applyPointUpdate(t,e),view:i});return this._computationHandles.add(a,t),s}_setupOffsetManipulator(t){const{view:e}=this,i=function(t,e){const i=[(0,b.al)(-.5,0,0),(0,b.al)(.5,0,0)],n=(0,ht.rh)(e.unfocusedMaterial,i.map((t=>(0,S.j)((0,b.Ue)(),t,.5)))),s=n.instantiate({material:e.focusedMaterial});return new ot.Z({view:t,renderObjects:[new lt.r(n,yt.Q9.Unfocused|yt.Q9.Selected|Gt),new lt.r(s,yt.Q9.Focused|Gt)],collisionType:{type:"line",paths:[i]},radius:jt(e.lineSizePt)/2,metadata:e.metadata,available:!1,...rt.X9})}(e,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,metadata:t.dimension}),n=function(t,e){let{computation:i,view:n}=e;return[(0,vt.Xd)(t,((t,e,s)=>{if(!X(i)||!t.selected)return;const{geometry:a,dimension:o}=i,r=(0,ct.J4)(t);e.next(r).next(Tt(n,o,a.dimensionSegment,a.primaryOffsetAxis)),s.next(r).next((0,vt.di)(o,["offset"]))}))]}(i,{computation:t,view:e});return this._computationHandles.add(n,t),i}_setupHeadingManipulator(t){const{view:e}=this,i=new Ct(e,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:t.dimension}),n=function(t,e){let{computation:i,view:n}=e;return[(0,vt.Xd)(t,((t,e,s)=>{xt({cancel:s,computation:i,settingHeading:!0,steps:e,view:n})}))]}(i,{computation:t,view:e});return this._computationHandles.add(n,t),i}_setupRotationManipulator(t){const{view:e}=this,i=new Ct(e,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:t.dimension}),n=Pt(i,{computation:t,view:e});return this._computationHandles.add(n,t),i}_setupMeasureTypeManipulator(t,e){const{view:i}=this,n=function(t,e){const i=[(0,b.al)(-.5,0,0),(0,b.al)(.5,0,0)],n=(0,ht.rh)(e.thinOffsetManipulatorMaterial,i),s=(0,ht.rh)(e.unfocusedMaterial,i.map((t=>(0,S.j)((0,b.Ue)(),t,.5)))),a=s.instantiate({material:e.focusedMaterial});return new ot.Z({view:t,renderObjects:[new lt.r(s,yt.Q9.Unfocused|Gt),new lt.r(a,yt.Q9.Focused|Gt),new lt.r(n,Gt)],collisionType:{type:"line",paths:[i]},radius:jt(e.lineSizePt)/2,available:!1,metadata:e.metadata,...rt.X9})}(i,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,thinOffsetManipulatorMaterial:this._thinOffsetManipulatorMaterial,metadata:t.dimension}),s=Dt(n,{computation:t,manipulatorMeasureType:e,view:i});return this._computationHandles.add(s,t),n}_updateManipulators(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator};const{stagedDimension:n,selectedComputation:s,firstGrabbedManipulator:a}=i,{start:o,end:r,offset:l,heading:c,rotation:d}=e,u=s===t,p=X(t),{dimension:m}=t;for(const h of e.values()){const t=p&&null==n&&(null==a||h===a);h===l?(h.available=t,h.selected=u):h.available=t&&u}if(!p)return;null!=this._computeConstraint(t)?e.forEachMeasureTypeManipulator((t=>t.available=!1)):e.manipulatorForMeasureType(m.measureType).available=!1;for(const f of[c,d])m.measureType===h.n.Direct&&0!==m.offset||(f.available=!1);G(t)?d.available=!1:c.available=!1;const{geometry:_}=t;o.renderLocation=_.directSegment.startRenderSpace,r.renderLocation=_.directSegment.endRenderSpace;const{renderCoordsHelper:g}=this.view;(function(t,e,i){const{dimensionSegment:n,primaryOffsetAxis:s}=e,a=Z(Nt,e),o=(0,S.e)(a,b.AG)?(0,v.yR)(Vt):(0,rt.Aq)(a,s,b.AG,Vt),r=Math.max((0,S.l)(a),.1/i.unitInMeters);(0,v.bA)(o,o,(0,S.s)(Nt,r,r,r)),t.modelTransform=o,t.renderLocation=n.eval(.5,Nt)})(l,_,g),c.available&&function(t,e,i){It(t,e,i,{forHeading:!0})}(c,t,g),d.available&&function(t,e,i){It(t,e,i,{forHeading:!1})}(d,t,g),e.forEachMeasureTypeManipulator(((e,i)=>{e.available&&function(t,e,i,n){const{geometry:s}=e,a=z(Zt,i,e,n),o=j(Nt,{measureType:i,directSegment:s.directSegment,renderCoordsHelper:n}),r=(0,S.z)(Ut,a.endRenderSpace,a.startRenderSpace),l=(0,rt.Aq)(r,o,b.AG,Vt),c=(0,S.l)(r);(0,v.bA)(l,l,(0,S.s)(Ut,c,c,c)),t.modelTransform=l,t.renderLocation=a.eval(.5,Ut)}(e,t,i,g)}))}_updateManipulatorStyle(t){const e=function(t){return(0,J.F2)(t)+4}(t),i=jt(t),n={lineSizePt:t,material:this._orientationManipulatorMaterial};for(const{offset:s,heading:a,rotation:o}of this._computationManipulators.values())s.radius=i/2,a.update(n),o.update(n);this._unfocusedOffsetManipulatorMaterial.setParameters({width:e}),this._focusedOffsetManipulatorMaterial.setParameters({width:i})}_applyPointUpdate(t,e){const{view:i}=this,n=I(t);"startPoint"in e&&(n.elevationAlignedStartPoint=e.startPoint),"endPoint"in e&&(n.elevationAlignedEndPoint=e.endPoint);const s=A(n,i.renderCoordsHelper);if(null==s)return;const a=this._computeConstraint({...n,geometry:s});qt(t,e,{...n,constraint:a,unconstrainedGeometry:s,view:i}),t===this._stagedComputation&&this._updateStagedDimensionOffset(t)}_updateStagedDimensionOffset(t){if(null==t.geometry)return;t.geometry.directSegment.eval(.5,pe);const e=this.view.state.camera.computeScreenPixelSizeAt(pe);t.dimension.offset=50*e}_computeConstraint(t){return function(t,e){if(F(t))return Yt.Direct;if(!t.enabled)return null;const{geometry:i}=t;if(null==i||(0,S.e)(i.directSegment.startRenderSpace,i.directSegment.endRenderSpace))return null;const{camera:n}=e.state,s=U(C.WM.get(),i,e.renderCoordsHelper),a=V(C.WM.get(),i),o=(0,S.j)(C.WM.get(),s,(0,S.m)(a,s)),r=(0,S.f)(C.WM.get(),a,o),l=(0,S.q)(r),c=(0,S.q)(o),{startRenderSpace:d,endRenderSpace:u}=i.directSegment,p=Math.max(10*n.computeScreenPixelSizeAt(d),10*n.computeScreenPixelSizeAt(u))**2;return l<p?Yt.Vertical:c<p?Yt.Horizontal:null}(function(t,e){return{enabled:e.effectiveFeatureEnabled,elevationAlignedStartPoint:t.elevationAlignedStartPoint,elevationAlignedEndPoint:t.elevationAlignedEndPoint,geometry:t.geometry}}(t,this._snappingManager.options),this.view)}_createOffsetManipulatorMaterial(){return new ft.U({width:1,renderOccluded:mt.yD.OccludeAndTransparent,writeDepth:!1,hasPolygonOffset:!0,isDecoration:!0})}get testInfo(){}};(0,s._)([(0,d.Cb)({constructOnly:!0})],ue.prototype,"analysis",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],ue.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],ue.prototype,"manipulators",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],ue.prototype,"parentTool",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],ue.prototype,"view",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],ue.prototype,"updating",null),(0,s._)([(0,d.Cb)()],ue.prototype,"firstGrabbedManipulator",null),(0,s._)([(0,d.Cb)()],ue.prototype,"hasGrabbedManipulators",null),(0,s._)([(0,d.Cb)()],ue.prototype,"snappingOptions",null),(0,s._)([(0,d.Cb)()],ue.prototype,"_stagedDimension",void 0),(0,s._)([(0,d.Cb)()],ue.prototype,"_activeComputation",null),(0,s._)([(0,d.Cb)()],ue.prototype,"_stagedComputation",null),ue=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.LengthDimensionSubTool")],ue);const pe=(0,b.Ue)();var he,me=i(86509),_e=i(87888),ge=i(81298),fe=i(72612);!function(t){t.Ready="ready",t.Creating="creating",t.Created="created"}(he||(he={}));let ve=class extends me.f{constructor(t){super(t),this.automaticManipulatorSelection=!1,this.removeIncompleteOnCancel=!1,this._pointerMoveTimerMs=2500,this._prevPointerMoveTimeout=null}initialize(){this._intersector=(0,ge.w)(this.view.state.viewingMode),this._lengthDimensionSubTool=new ue({analysis:this.analysis,analysisViewData:this.analysisViewData,manipulators:this.manipulators,parentTool:this,view:this.view}),this.addHandles([(0,o.ed)(this._lengthDimensionSubTool),(0,o.kB)((()=>this._clearPointerMoveTimeout())),(0,c.YP)((()=>this.state),(t=>{t===he.Created&&this.finishToolCreation()}),c.tX),(0,c.gx)((()=>this.firstGrabbedManipulator),(t=>{this.selectedDimension=t.metadata}),c.tX),(0,c.YP)((()=>this.selectedDimension),(()=>this._resetPointerMoveTimeout()),c.tX)])}get state(){return this.analysis.dimensions.some((t=>"length"===t.type))?null!=this._activeSubTool?he.Creating:he.Created:he.Ready}get updating(){return this._lengthDimensionSubTool.updating}get cursor(){return this.active?"crosshair":null}get selectedDimension(){return this.analysisViewData.selectedDimension}set selectedDimension(t){this.analysisViewData.selectedDimension=t}onInputEvent(t){switch(t.type){case"immediate-click":this._clickHandler(t);break;case"immediate-double-click":this._doubleClickHandler(t);break;case"pointer-move":this._pointerMoveHandler(t);break;case"key-down":if(_e.Sn.cancel===t.key){if(null!=this._activeSubTool&&this._activeSubTool.removeStaged())return void t.stopPropagation();this.active||(this.selectedDimension=null)}else _e.Sn.delete.includes(t.key)&&this._deleteKeyHandler()}}onActivate(){this._activeSubTool=this._lengthDimensionSubTool}onDeactivate(){null!=this._activeSubTool&&(this._activeSubTool.onDeactivate(),this._activeSubTool=null)}onShow(){this._resetPointerMoveTimeout()}onManipulatorSelectionChanged(){this._lengthDimensionSubTool.onManipulatorSelectionChanged()}onHide(){this.selectedDimension=null}_clickHandler(t){if(this.hasFocusedManipulators)return void t.stopPropagation();if(null==this._activeSubTool)return;const e=this._intersectScreen(t);null!=e&&(this.selectedDimension=this._activeSubTool.onClick({mapPoint:e,pointerType:t.pointerType}),t.stopPropagation())}_doubleClickHandler(t){this.active&&(this.view.activeTool=null,t.stopPropagation())}_pointerMoveHandler(t){if(this._resetPointerMoveTimeout(),null==this._activeSubTool)return;if(this.hasFocusedManipulators)return;const e=this._intersectScreen(t);null!=e&&this._activeSubTool.onPointerMove({mapPoint:e,pointerType:t.pointerType})}_deleteKeyHandler(){null!=this._activeSubTool&&this._activeSubTool.removeStaged(),this._removeSelected()}_intersectScreen(t){const e=(0,fe.Sj)(t);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(e,this._intersector);const i=this._intersector.results.min,n=C.WM.get();return i.getIntersectionPoint(n)?this.view.renderCoordsHelper.fromRenderCoords(n,new St.Z({spatialReference:this.view.spatialReference})):null}_removeSelected(){null!=this.selectedDimension&&(this.analysis.dimensions.remove(this.selectedDimension),this.selectedDimension=null)}_clearPointerMoveTimeout(){this._prevPointerMoveTimeout=(0,l.hw)(this._prevPointerMoveTimeout)}_resetPointerMoveTimeout(){this._clearPointerMoveTimeout(),this.manipulators.forEach((t=>t.manipulator.state|=Gt)),this._prevPointerMoveTimeout=$.m.setTimeout((()=>{this.manipulators.forEach((t=>t.manipulator.state&=~Gt))}),this._pointerMoveTimerMs)}get testInfo(){}};(0,s._)([(0,d.Cb)({constructOnly:!0})],ve.prototype,"view",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],ve.prototype,"analysis",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],ve.prototype,"state",null),(0,s._)([(0,d.Cb)({readOnly:!0})],ve.prototype,"updating",null),(0,s._)([(0,d.Cb)({readOnly:!0})],ve.prototype,"cursor",null),(0,s._)([(0,d.Cb)({constructOnly:!0})],ve.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)()],ve.prototype,"selectedDimension",null),(0,s._)([(0,d.Cb)()],ve.prototype,"automaticManipulatorSelection",void 0),(0,s._)([(0,d.Cb)()],ve.prototype,"_activeSubTool",void 0),(0,s._)([(0,d.Cb)()],ve.prototype,"_lengthDimensionSubTool",void 0),ve=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.DimensionTool")],ve);i(59166);var ye=i(58935),Se=i(27210),be=i(99894),Me=i(52168),Ce=i(79685),we=i(21317);class Pe extends Me._{constructor(t,e){super(t),this._hasExternalMaterial=!1,this._renderOccluded=mt.yD.OccludeAndTransparent,this._width=1,this._color=(0,be.al)(1,0,1,1),this._placement="end",this._markerPrimitive="arrow",this._material=e,this._hasExternalMaterial=null!=e,this.applyProperties(t)}setGeometryFromSegment(t,e){const i=t.endRenderSpace;this.transform=(0,v.vc)(xe,i),this._normal=e;const{points:n}=t.createRenderGeometry(i,this.view.renderCoordsHelper);this.geometry=[n]}get renderOccluded(){return null!=this._material?this._material.parameters.renderOccluded:this._renderOccluded}set renderOccluded(t){this._renderOccluded=t,null!=this._material&&this._material.setParameters({renderOccluded:t})}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this.recreateGeometry()}get normal(){return this._normal}set normal(t){this._normal=t,this.recreateGeometry()}get width(){return null!=this._material?this._material.parameters.width:this._width}set width(t){this._width=t,null!=this._material&&this._material.setParameters({width:t})}get color(){return null!=this._material?this._material.parameters.color:this._color}set color(t){this._color=(0,be.d9)(t),null!=this._material&&this._material.setParameters({color:this._color})}get placement(){return null!=this._material?this._material.parameters.placement:this._placement}set placement(t){this._placement=t,null!=this._material&&this._material.setParameters({placement:this._placement})}get markerPrimitive(){return this._material?.parameters.markerPrimitive??this._markerPrimitive}set markerPrimitive(t){this._markerPrimitive=t,null!=this._material&&this._material.setParameters({markerPrimitive:t})}createExternalResources(){this._hasExternalMaterial||(this._material=new we.X({width:this._width,color:this._color,placement:this._placement,renderOccluded:this._renderOccluded,markerPrimitive:this._markerPrimitive,isDecoration:this.isDecoration}))}destroyExternalResources(){this._hasExternalMaterial||(this._material=null)}createGeometries(t){for(const e of(0,Ce.c)(this.geometry,this.normal)){const i=(0,Ce.Y)(this._material,e);t.addGeometry(i)}}forEachExternalMaterial(t){this._hasExternalMaterial||t(this._material)}}const xe=(0,y.Ue)();class De{set visible(t){for(const e of this._visualElements.values())e.attached=t}constructor(t){this.destroyed=!1,this._handles=new Ft.Z,this._messages=null,this._labelSegment=new x.y;const{analysis:e,computation:i,view:n,messages:s,isDecoration:a}=t;this.analysis=e,this.computation=i,this.view=n,this._messages=s;const o=t.visible,r={view:n,attached:o,isDecoration:a},{fontSize:l,textColor:d,textBackgroundColor:u}=e.style;this._visualElements=new Ae({marker:new Pe(r,t.markerMaterial),dimension:new te.r(r,t.dimensionLineMaterial),startOffset:new te.r(r,t.offsetLineMaterial),endOffset:new te.r(r,t.offsetLineMaterial),dimensionSmall:new te.r(r,t.smallDimensionLineMaterial),startOffsetSmall:new te.r(r,t.smallOffsetLineMaterial),endOffsetSmall:new te.r(r,t.smallOffsetLineMaterial),label:new Se.K({view:n,attached:o,distance:0,geometry:{type:"segment",sampleLocation:"center",segment:this._labelSegment,callout:!1},fontSize:(0,J.F2)(l),textColor:d.clone(),backgroundColor:u.clone(),isDecoration:a})}),this._handles.add([(0,c.YP)((()=>i.geometry),(t=>{this.updateCameraDependentElements(n.state.camera,t,e.style),null!=i.geometry&&this._updateLines(i.geometry)}),{...c.nn,equals:Xt.fS}),(0,c.YP)((()=>i.length),(t=>this._updateLabelContent(t)),c.nn)])}destroy(){this.destroyed=!0,this._handles=(0,l.SC)(this._handles);for(const t of this._visualElements.values())t.destroy()}get testInfo(){}_updateLines(t){const e=R(Te,n.Start,t.directSegment,t.dimensionSegment),i=R(Oe,n.End,t.directSegment,t.dimensionSegment),s=this._visualElements;s.marker.setGeometryFromSegment(t.dimensionSegment,t.primaryOffsetAxis),s.dimension.setGeometryFromSegment(t.dimensionSegment),s.startOffset.setGeometryFromSegment(e),s.endOffset.setGeometryFromSegment(i),s.dimensionSmall.setGeometryFromSegment(t.dimensionSegment),s.startOffsetSmall.setGeometryFromSegment(e),s.endOffsetSmall.setGeometryFromSegment(i)}updateCameraDependentElements(t,e,i){const n=this._visualElements;if(null==e){for(const t of n.values())t.visible=!1;return}const s=t.computeScreenPixelSizeAt(e.dimensionSegment.eval(.5,Ie)),a=function(t,e){return(0,S.q)(Z(W,t))/e**2}(e,s),o=a<(2*(0,J.F2)(i.lineSize))**2,r=!o;n.marker.visible=r,n.dimension.visible=r,n.startOffset.visible=r,n.endOffset.visible=r,n.dimensionSmall.visible=o,n.startOffsetSmall.visible=o,n.endOffsetSmall.visible=o;const l=5*(0,J.F2)(i.fontSize),{label:c}=n;if(c.visible=a>=l**2,!c.visible)return;const{dimensionSegment:d,primaryOffsetAxis:u}=e,{offset:p}=this.computation.dimension,h=(Math.sign(p)>=0?1:-1)*function(t){return 1.5*(0,J.F2)(t.fontSize)+20+(0,J.F2)(t.lineSize/2)}(i)*s;(function(t,e,i,n){(0,S.r)(t.startRenderSpace,e.startRenderSpace,i,n),(0,S.r)(t.endRenderSpace,e.endRenderSpace,i,n)})(this._labelSegment,d,u,h),c.updateLabelPosition()}updateLabelStyle(t){const{label:e}=this._visualElements;e.fontSize=(0,J.F2)(t.fontSize),e.textColor=t.textColor,e.backgroundColor=t.textBackgroundColor}updateUnitsMessages(t){this._messages=t;const{length:e}=this.computation;this._updateLabelContent(e)}_updateLabelContent(t){const{label:e}=this._visualElements;null!=t&&null!=this._messages?e.text=(0,ye.VG)(this._messages,t,t.unit):e.text=""}}const Te=new x.y,Oe=new x.y,Ie=(0,b.Ue)();class Ae{constructor(t){this.marker=t.marker,this.dimension=t.dimension,this.startOffset=t.startOffset,this.endOffset=t.endOffset,this.dimensionSmall=t.dimensionSmall,this.startOffsetSmall=t.startOffsetSmall,this.endOffsetSmall=t.endOffsetSmall,this.label=t.label}values(){return[this.marker,this.dimension,this.startOffset,this.endOffset,this.dimensionSmall,this.startOffsetSmall,this.endOffsetSmall,this.label]}}var Re=i(33720),ze=i(36257),He=i(41201);let ke=class extends a.Z{get analysis(){return this.analysisViewData.analysis}get visible(){return this.analysisViewData.visible}constructor(t){super(t),this.loadingMessages=!1,this._messages=null}initialize(){const t=this.isDecoration;this._markerMaterial=new we.X({width:1,anchor:Re.i5.Tip,color:K.AG,placement:"begin-end",worldSpace:!0,hideOnShortSegments:!0,hasTip:!0,renderOccluded:mt.yD.OccludeAndTransparent,markerPrimitive:"triangle",isDecoration:t}),this._dimensionLineMaterial=new ft.U({width:1,color:K.AG,renderOccluded:mt.yD.OccludeAndTransparent,markerParameters:this._markerMaterial.parameters,isDecoration:t}),this._offsetLineMaterial=new ft.U({width:1,color:K.AG,renderOccluded:mt.yD.OccludeAndTransparent,stipplePattern:(0,ie.z5)(5),isDecoration:t}),this._smallDimensionLineMaterial=new ft.U({width:1,color:K.AG,renderOccluded:mt.yD.OccludeAndTransparent,isDecoration:t}),this._smallOffsetLineMaterial=new ft.U({width:1,color:K.AG,renderOccluded:mt.yD.OccludeAndTransparent,stipplePattern:(0,ie.z5)(5),isDecoration:t});for(const i of this._lineMaterials())this.view._stage.add(i),this.addHandles((0,o.kB)((()=>{this.view._stage?.remove(i)})));const e=(0,c.wZ)((()=>this.analysisViewData.computations),(t=>{let{computation:e}=t;return this._createVisualization(e)}));this._dimensionVisualizations=e,this.addHandles([(0,o.ed)(e),(0,c.YP)((()=>Q.Z.toUnitRGBA(this.analysis.style.color)),(t=>{for(const e of this._lineMaterials())e.setParameters({color:t})}),c.tX),(0,c.YP)((()=>this.analysis.style.lineSize),(t=>{const e=(0,J.F2)(t);this._markerMaterial.setParameters({width:.8*e}),this._dimensionLineMaterial.setParameters({width:e,markerParameters:this._markerMaterial.parameters});const i=Math.max(.25*e,1);this._offsetLineMaterial.setParameters({width:i})}),c.tX),(0,c.YP)((()=>({camera:this.view.state.camera,style:Ee(this.analysis)})),(t=>{let{camera:e,style:i}=t;for(const{visualization:n}of this._dimensionVisualizations)n.updateCameraDependentElements(e,n.computation.geometry,i),n.updateLabelStyle(i)})),(0,c.YP)((()=>this.visible),(t=>{for(const{visualization:e}of this._dimensionVisualizations)e.visible=t}))]),this.addHandles([(0,ze.qe)((()=>this._updateMessageBundle())),(0,c.gx)((()=>!this.loadingMessages),(()=>{for(const{visualization:t}of this._dimensionVisualizations)t.updateUnitsMessages(this._messages)}),c.Z_)]),this._updateMessageBundle()}get testInfo(){}_createVisualization(t){const e=new De({analysis:this.analysis,computation:t,view:this.view,visible:this.visible,markerMaterial:this._markerMaterial,dimensionLineMaterial:this._dimensionLineMaterial,offsetLineMaterial:this._offsetLineMaterial,smallDimensionLineMaterial:this._smallDimensionLineMaterial,smallOffsetLineMaterial:this._smallOffsetLineMaterial,messages:this._messages,isDecoration:this.isDecoration});return{visualization:e,remove:()=>e.destroy()}}_lineMaterials(){return[this._markerMaterial,this._dimensionLineMaterial,this._offsetLineMaterial,this._smallDimensionLineMaterial,this._smallOffsetLineMaterial]}async _updateMessageBundle(){this.loadingMessages=!0;try{this._messages=await(0,He.ME)("esri/core/t9n/Units")}finally{this.loadingMessages=!1}}};function Ee(t){const{fontSize:e,lineSize:i,textColor:n,textBackgroundColor:s}=t.style;return{fontSize:e,lineSize:i,textBackgroundColor:s.clone(),textColor:n.clone()}}(0,s._)([(0,d.Cb)({constructOnly:!0})],ke.prototype,"analysisViewData",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],ke.prototype,"view",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],ke.prototype,"isDecoration",void 0),(0,s._)([(0,d.Cb)()],ke.prototype,"analysis",null),(0,s._)([(0,d.Cb)()],ke.prototype,"visible",null),(0,s._)([(0,d.Cb)()],ke.prototype,"loadingMessages",void 0),ke=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.DimensionVisualization")],ke);let je=class extends a.Z{constructor(t){super(t),this.dimension=null,this.length=null}};(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],je.prototype,"dimension",void 0),(0,s._)([(0,d.Cb)()],je.prototype,"length",void 0),je=(0,s._)([(0,u.j)("esri.views.analysis.LengthDimensionResult")],je);const Le=je;let Ge=class extends a.Z{constructor(t){super(t),this.geometry=null,this.unconstrainedGeometry=null,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}normalizeCtorArgs(t){const{dimension:e,...i}=t;return{result:new Le({dimension:e}),...i}}initialize(){this.addHandles([(0,c.YP)((()=>this.dimension.startPoint),(t=>this.elevationAlignedStartPoint=this.projectAndAlignPoint(t)),c.tX),(0,c.YP)((()=>this.dimension.endPoint),(t=>this.elevationAlignedEndPoint=this.projectAndAlignPoint(t)),c.tX)])}get dimension(){return this.result.dimension}get length(){return this.result.length}};(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Ge.prototype,"result",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Ge.prototype,"projectAndAlignPoint",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"dimension",null),(0,s._)([(0,d.Cb)()],Ge.prototype,"length",null),(0,s._)([(0,d.Cb)()],Ge.prototype,"geometry",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"unconstrainedGeometry",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"elevationAlignedStartPoint",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"elevationAlignedEndPoint",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"preConstraintProperties",void 0),(0,s._)([(0,d.Cb)()],Ge.prototype,"previousConstraint",void 0),Ge=(0,s._)([(0,u.j)("esri.views.3d.analysis.Dimension.LengthDimensionComputation")],Ge);var Ne=i(33906),Ue=i(70209),Ve=i(80987);const Ze=t=>{let e=class extends t{constructor(){super(...arguments),this.analysis=null,this.tool=null,this.selectedDimension=null,this.interactive=!1,this.visible=null}get results(){return new Ve.Z}createLengthDimensions(t){throw new Error("Method not implemented.")}};return(0,s._)([(0,d.Cb)({constructOnly:!0})],e.prototype,"view",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],e.prototype,"analysis",void 0),(0,s._)([(0,d.Cb)()],e.prototype,"tool",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],e.prototype,"results",null),(0,s._)([(0,d.Cb)()],e.prototype,"selectedDimension",void 0),(0,s._)([(0,d.Cb)()],e.prototype,"interactive",void 0),(0,s._)([(0,d.Cb)()],e.prototype,"visible",void 0),e=(0,s._)([(0,u.j)("esri.views.analysis.DimensionAnalysisView")],e),e};let Ye=class extends(Ze((0,p.p)(a.Z))){constructor(t){super(t),this.type="dimension-view-3d",this.tool=null,this.selectedDimension=null,this._dimensionsToComputations=new Map,this._placementTask=null,this._projectAndAlignPoint=null}initialize(){this._projectAndAlignPoint=t=>{if(null==t)return null;const{spatialReference:e,elevationProvider:i}=this.view,n=(0,Ne.G)(t,e,i);return null==n&&(0,Ne.e)(this.analysis,t.spatialReference,r.Z.getLogger(this)),n};const t=(0,c.wZ)((()=>this.analysis.dimensions),(t=>this._createComputation(t)));this.computations=t,this.addHandles([(0,Ue.Lp)(this,ve),(0,o.ed)(t)]),this._analysisVisualization=new ke({analysisViewData:this,view:this.view,isDecoration:!this.parent}),this._analysisController=new B({analysisViewData:this,view:this.view})}destroy(){this._placementTask=(0,l.IM)(this._placementTask),this._analysisVisualization=(0,l.SC)(this._analysisVisualization),(0,Ue.Yq)(this)}get updating(){return this._analysisVisualization?.loadingMessages??!1}get results(){return this.analysis.dimensions.map((t=>this._dimensionsToComputations.get(t).result))}get selectedComputation(){const{selectedDimension:t}=this;return null==t?null:this._dimensionsToComputations.get(t)}get testInfo(){}async createLengthDimensions(t){return this.selectedDimension=null,this._placementTask=(0,l.IM)(this._placementTask),this._placementTask=(0,Ue.Er)(this,t),this._placementTask.promise}_createComputation(t){const{_dimensionsToComputations:e}=this,i=new Ge({dimension:t,projectAndAlignPoint:this._projectAndAlignPoint});return e.set(t,i),{computation:i,remove:()=>this._removeComputation(i)}}_removeComputation(t){const{dimension:e}=t;e===this.selectedDimension&&(this.selectedDimension=null),this._dimensionsToComputations.delete(e),t.destroy()}};(0,s._)([(0,d.Cb)({readOnly:!0})],Ye.prototype,"type",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"tool",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"updating",null),(0,s._)([(0,d.Cb)({readOnly:!0})],Ye.prototype,"results",null),(0,s._)([(0,d.Cb)()],Ye.prototype,"computations",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"selectedDimension",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"selectedComputation",null),(0,s._)([(0,d.Cb)()],Ye.prototype,"_analysisVisualization",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"_analysisController",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"_dimensionsToComputations",void 0),(0,s._)([(0,d.Cb)()],Ye.prototype,"_placementTask",void 0),Ye=(0,s._)([(0,u.j)("esri.views.3d.analysis.DimensionAnalysisView3D")],Ye);const We=Ye},11526:(t,e,i)=>{i.d(e,{O:()=>d,s:()=>u});const n="theme-style";function s(t,e){return function(t,e){const i=new Image(e,e);return i.src=t,i}(function(t){const e=(new XMLSerializer).serializeToString(t);return`data:image/svg+xml;base64,${btoa(e)}`}(a(function(t){const e=t.split(",")[1],i=atob(e);return(new DOMParser).parseFromString(i,"image/svg+xml")}(t),e)),e.size)}function a(t,e){let{accentColor:i,contrastColor:s}=e;const a=i.toHex(),o=i.a,r=s.toHex(),l=s.a,c=t.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem(n);return c&&(c.innerHTML=`\n      .contrast-fill { fill: ${r}; fill-opacity: ${l}; }\n      .contrast-stroke { stroke: ${r}; stroke-opacity: ${l};  }\n      .accent-fill { fill: ${a}; fill-opacity: ${o}; }\n      .accent-stroke { stroke: ${a}; stroke-opacity:  ${o}; }`),t}const o="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NiIgY2xhc3M9ImFjY2VudC1maWxsIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI0Ljk5IiBkPSJNMjAuMDUgNDAuODZhMTUuMDUgMTUuMDUgMCAwIDAgMTcuMTQtMS41IDE1LjA1IDE1LjA1IDAgMCAwIDQuNDctMTYuNjUgMTUuMDUgMTUuMDUgMCAwIDAtMjIuNzItNy4xNSAxNS4wNSAxNS4wNSAwIDAgMC01LjUgNy4xNSIgY2xhc3M9ImNvbnRyYXN0LXN0cm9rZSIvPjxwYXRoIGQ9Im0xMC45NyAzNS41NyA1LjM4IDEyLjA3IDcuNzktMTMuNDd6IiBjbGFzcz0iY29udHJhc3QtZmlsbCIvPjwvc3ZnPg==",r="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxjaXJjbGUgY3g9IjM5LjQ3OCIgY3k9IjMuMDc4IiByPSIyOCIgY2xhc3M9ImFjY2VudC1maWxsIiB0cmFuc2Zvcm09InJvdGF0ZSg0MC41NDIpIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI1IiBkPSJtNy4wNzQgMzAuMDUzIDI5LjM5NyAxMS45ODUtMy42NzMtMzMuNDkzIiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSIyLjk5NiIgZD0iTTI0LjUwNCAyMy4yMDdhMTEuOTggMTEuOTggMCAwIDAtOS44IDcuNTA3IiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIGNvbnRyYXN0LWZpbGwiLz48cGF0aCBkPSJtMjkuODE4IDIyLjgwOC02LjE4NCA0LjYtLjU0MS04LjM2NHoiIGNsYXNzPSJjb250cmFzdC1maWxsIi8+PC9zdmc+";var l=i(1487);const c=64;function d(t,e){const{accentColor:i,contrastColor:n,preMultiplyAlpha:a}=e;return t.fromData(`heading-rotate:[accent:${i},contrast:${n},size:${c}]`,(()=>new l.x(s(o,{accentColor:i,contrastColor:n,size:c}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:a})))}function u(t,e){const{accentColor:i,contrastColor:n,preMultiplyAlpha:a}=e;return t.fromData(`tilt-rotate:[accent:${i},contrast:${n},size:${c}]`,(()=>new l.x(s(r,{accentColor:i,contrastColor:n,size:c}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:a})))}},27210:(t,e,i)=>{i.d(e,{K:()=>b,j:()=>C});var n=i(51995),s=i(100),a=i(94172),o=i(17842),r=i(13611),l=i(32035),c=i(12400),d=i(86244),u=i(11208),p=i(27366),h=i(7138),m=i(49861),_=(i(93169),i(32718),i(84936),i(69912)),g=(i(42877),i(11422));i(88367);let f=class extends h.Z{get startPosition(){return[this.startX,this.startY]}set startPosition(t){this._set("startX",t[0]),this._set("startY",t[1])}get endPosition(){return[this.endX,this.endY]}set endPosition(t){this._set("endX",t[0]),this._set("endY",t[1])}constructor(t){super(t),this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.width=1,this.color=[0,0,0,.5],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const t=this.color;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _lineCap(){return"round"}render(){const{height:t,left:e,top:i,width:n,x1:s,x2:a,y1:o,y2:r}=this._calculateCoordinates(v),l=`stroke: ${this._strokeStyle}; stroke-width: ${this.width}; stroke-linecap: ${this._lineCap};`;return(0,g.h)("div",{classes:{"esri-line-overlay-item":!0},styles:{left:e+"px",top:i+"px",width:n+"px",height:t+"px",visibility:this.visible?"visible":"hidden"}},[(0,g.h)("svg",{width:n,height:t},[(0,g.h)("line",{x1:s,y1:o,x2:a,y2:r,style:l})])])}renderCanvas(t){if(!this.visible)return;t.strokeStyle=this._strokeStyle,t.lineWidth=this.width,t.lineCap=this._lineCap;const e=this._calculateCoordinates(v);t.beginPath(),t.moveTo(e.left+e.x1,e.top+e.y1),t.lineTo(e.left+e.x2,e.top+e.y2),t.stroke()}_calculateCoordinates(t){const e=Math.min(this.startX,this.endX),i=Math.max(this.startX,this.endX),n=Math.min(this.startY,this.endY),s=Math.max(this.startY,this.endY),a=this.width;return t.left=e-a,t.top=n-a,t.width=i-e+2*a,t.height=Math.max(20,s-n+2*a),t.x1=this.startX-e+a,t.y1=this.startY-n+a,t.x2=this.endX-e+a,t.y2=this.endY-n+a,t}};(0,p._)([(0,m.Cb)()],f.prototype,"startX",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"startY",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"endX",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"endY",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"startPosition",null),(0,p._)([(0,m.Cb)()],f.prototype,"endPosition",null),(0,p._)([(0,m.Cb)()],f.prototype,"width",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"color",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"visible",void 0),(0,p._)([(0,m.Cb)()],f.prototype,"isDecoration",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],f.prototype,"_strokeStyle",null),f=(0,p._)([(0,_.j)("esri.views.overlay.LineOverlayItem")],f);const v={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},y=f;var S=i(36444);class b extends d.l{constructor(t){super(t),this._handles=new s.Z,this._textItem=null,this._calloutItem=null,this._showCallout=!0,this._showText=!0,this._geometry=null,this._text="-",this._fontSize=14,this._backgroundColor=new n.Z([0,0,0,.6]),this._calloutColor=new n.Z([0,0,0,.5]),this._textColor=new n.Z([255,255,255]),this._distance=25,this._anchor="right",this.updatePositionOnCameraMove=!0,this.applyProperties(t)}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this.updateLabelPosition()}get isDecoration(){return this._isDecoration}set isDecoration(t){this._isDecoration=t,this._textItem&&(this._textItem.isDecoration=t),this._calloutItem&&(this._calloutItem.isDecoration=t)}get textItem(){return this._textItem}get text(){return this._text}set text(t){this._text=t,this.attached&&(this._textItem.text=this._text)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t,this.attached&&(this._textItem.fontSize=this._fontSize)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this.attached&&(this._textItem.backgroundColor=this._backgroundColor)}get calloutColor(){return this._calloutColor}set calloutColor(t){this._calloutColor=t,this.attached&&(this._calloutItem.color=this._calloutColor.toRgba())}get textColor(){return this._textColor}set textColor(t){this._textColor=t,this.attached&&(this._textItem.textColor=this._textColor)}get distance(){return this._distance}set distance(t){this._distance!==t&&(this._distance=t,this.updateLabelPosition())}get anchor(){return this._anchor}set anchor(t){this._anchor!==t&&(this._anchor=t,this.updateLabelPosition())}get _camera(){return this.view.state.cssCamera}overlaps(t){return!!this.attached&&this.textItem.visible&&t.textItem.visible&&!!this.view.overlay?.overlaps(this._textItem,t.textItem)}updateLabelPosition(){if(!this.attached)return;this._showText=!1,this._showCallout=!1;const{geometry:t,view:e,visible:i}=this;if(null!=t&&e._stage)switch(t.type){case"point":if(!this._computeLabelPositionFromPoint(t.point,z))break;if(t.callout){const e=this._camera,i=t.callout.distance;(0,r.IH)(R,R,[0,t.callout.offset]),e.renderToScreen(R,z),(0,r.t8)(O,0,1),(0,r.bA)(O,O,i),(0,r.IH)(O,O,R),e.renderToScreen(O,H),this._showCallout=this._updatePosition(z,H)}else this._textItem.position=[z[0],z[1]],this._textItem.anchor="center";this._showText=!0;break;case"corner":if(!this._computeLabelPositionFromCorner(t,this._distance,z,H))break;this._showCallout=this._updatePosition(z,H),this._showText=!0;break;case"segment":{if(!this._computeLabelPositionFromSegment(t,this._distance,this._anchor,z,H))break;this._showText=!0;const e=this._updatePosition(z,H);this._showCallout=!1!==t.callout&&e,this._showCallout||(this._textItem.anchor="center")}}this.updateVisibility(i)}_computeLabelPositionFromPoint(t,e){const i=this._camera;return i.projectToRenderScreen(t,A),!(A[2]<0||A[2]>1)&&(i.renderToScreen(A,e),!0)}_computeLabelPositionFromCorner(t,e,i,n){if(!t)return!1;const s=this._camera;return M(t.left,1,s,D),(0,r.tk)(D,D),M(t.right,0,s,T),(0,r.IH)(O,D,T),(0,r.tk)(O,O),(0,r.Fv)(O,O),s.projectToRenderScreen(t.left.endRenderSpace,A),!(A[2]<0||A[2]>1)&&(s.renderToScreen(A,i),(0,r.bA)(O,O,e),(0,r.IH)(O,O,A),s.renderToScreen(O,n),!0)}_computeLabelPositionFromSegment(t,e,i,n,s){if(!t)return!1;const a=t.segment,o=this._camera;(0,u.CM)(a.startRenderSpace,a.endRenderSpace,o,D),(0,r.t8)(O,-D[1],D[0]);let l=!1;switch(i){case"top":l=O[1]<0;break;case"bottom":l=O[1]>0;break;case"left":l=O[0]>0;break;case"right":l=O[0]<0}if(l&&(0,r.tk)(O,O),0===(0,r.kE)(O))switch(i){case"top":O[1]=1;break;case"bottom":O[1]=-1;break;case"left":O[0]=-1;break;case"right":O[0]=1}return a.eval(k[t.sampleLocation],I),o.projectToRenderScreen(I,A),!(A[2]<0||A[2]>1)&&(o.renderToScreen(A,n),(0,r.bA)(O,O,e),(0,r.IH)(O,O,A),o.renderToScreen(O,s),!0)}_updatePosition(t,e){if(e){const i=e[0]-t[0],n=e[1]-t[1];return this._textItem.position=[e[0],e[1]],this._textItem.anchor=Math.abs(i)>Math.abs(n)?i>0?"left":"right":n>0?"top":"bottom",this._calloutItem.startPosition=[t[0],t[1]],this._calloutItem.endPosition=[e[0],e[1]],!0}return this._textItem.position=[t[0],t[1]],this._textItem.anchor="center",!1}createResources(){this._textItem=new S.Z({visible:!0,text:this._text,fontSize:this._fontSize,backgroundColor:this._backgroundColor,textColor:this._textColor,isDecoration:this._isDecoration}),this._calloutItem=new y({color:this._calloutColor.toRgba(),visible:!0,width:2,isDecoration:this._isDecoration}),this.updateLabelPosition(),this.view.overlay?.items.addMany([this._textItem,this._calloutItem]),this.updatePositionOnCameraMove&&this._handles.add((0,a.YP)((()=>this.view.state.camera),(()=>this.updateLabelPosition())))}destroyResources(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}updateVisibility(t){this._textItem.visible=this._showText&&t,this._calloutItem.visible=this._showCallout&&t}}function M(t,e,i,n){return t.eval(e,w,x),(0,l.g)(P,w,x),(0,u.CM)(w,P,i,n)}function C(t){switch(t){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}const w=(0,c.Ue)(),P=(0,c.Ue)(),x=(0,c.Ue)(),D=(0,o.gX)(),T=(0,o.gX)(),O=(0,o.gX)(),I=(0,c.Ue)(),A=(0,o.J$)(),R=(0,o.gX)(),z=(0,o.s1)(),H=(0,o.s1)(),k={start:0,center:.5,end:1}},27676:(t,e,i)=>{i.d(e,{j:()=>_});var n=i(32035),s=i(12400),a=i(19093),o=i(86361),r=i(52168),l=i(78935),c=i(86372),d=i(69691);var u=i(68401),p=i(70619),h=i(56529),m=i(11606);class _ extends r._{constructor(t){super(t),this.view=null,this._renderOccluded=h.yD.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=(0,o.nI)([1,127/255,0,1]),this._size=11,this._outlineColor=(0,o.nI)([0,0,0,.5]),this._outlineSize=1,this._elevationInfo=null,this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(t){this._vertices=t,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(t){this._spatialReference=t,this.recreateGeometry()}get color(){return this._color}set color(t){(0,a.a)(t,this._color)||((0,a.c)(this._color,t),this._updateMaterial())}get size(){return this._size}set size(t){t!==this._size&&(this._size=t,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(t){(0,a.a)(t,this._outlineColor)||((0,a.c)(this._outlineColor,t),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(t){t!==this._outlineSize&&(this._outlineSize=t,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const t=this.vertices;if(null==t||0===t.length)return[];const e=function(t,e,i,n,s){const a=(0,c.bg)(3*t.length),o=(0,c.bg)(a.length);t.forEach(((t,e)=>{a[3*e]=t[0],a[3*e+1]=t[1],a[3*e+2]=t.length>2?t[2]:0}));const r=(0,d.rR)(a,e,0,o,0,a,0,a.length/3,i,n,s),l=null!=r;return{numVertices:t.length,position:a,mapPositions:o,projectionSuccess:l,sampledElevation:r}}(t,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,l.o.fromElevationInfo(this.elevationInfo)),i=[],s=e.numVertices,a=e.position;for(let o=0;o<s;++o){const t=(0,n.s)(g,a[3*o],a[3*o+1],a[3*o+2]),e=f(this._vertexMaterial,.5,t),s=f(this._vertexOutlineMaterial,.5,t);i.push({vertexGeometry:e,vertexOutlineGeometry:s})}return i}createGeometries(t){const e=this._createRenderGeometries();for(const{vertexGeometry:i,vertexOutlineGeometry:n}of e)t.addGeometry(i),t.addGeometry(n)}createExternalResources(){this._vertexMaterial=new m.Q({...this._vertexMaterialParameters,writeDepth:!0,cullFace:u.Vr.Back,screenSizeEnabled:!0}),this._vertexOutlineMaterial=new m.Q({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:u.Vr.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(t){t(this._vertexMaterial),t(this._vertexOutlineMaterial)}}const g=(0,s.Ue)();function f(t,e,i){return(0,p.PI)(t,e,16,16,{offset:i})}},9052:(t,e,i)=>{i.d(e,{u:()=>u,y:()=>d});var n=i(32035),s=i(12400),a=i(79803),o=i(29691),r=i(5986),l=i(51378),c=i(80064);class d{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.Ue)(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,s.Ue)();this.startRenderSpace=t,this.endRenderSpace=e,this.type="euclidean"}eval(t,e,i){return(0,n.o)(e,this.startRenderSpace,this.endRenderSpace,t),i&&((0,n.f)(i,this.endRenderSpace,this.startRenderSpace),(0,n.n)(i,i)),e}createRenderGeometry(t,e){const i=[],s=[],a=(e,a)=>{const o=h;(0,n.f)(o,e,t),i.push([o[0],o[1],o[2]]),s.push([a[0],a[1],a[2]])},o=e.worldUpAtPosition(this.eval(.5,p),l.WM.get());return a(this.startRenderSpace,o),a(this.endRenderSpace,o),{points:i,normals:s}}static fromPositionAndVector(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,n.j)(p,e,i),(0,n.g)(p,t,p),new d((0,s.d9)(t),(0,s.d9)(p))}}class u{_projectIn(t,e){this._project?(0,r.S)(t,this.renderSpatialReference,e,this._pcpf):(0,n.c)(e,t)}constructor(t,e,i){this.startRenderSpace=t,this.endRenderSpace=e,this.renderSpatialReference=i,this.type="geodesic",this._start=(0,s.Ue)(),this._end=(0,s.Ue)(),this._pcpf=(0,o.rS)(i),this._project=(0,a.canProjectWithoutEngine)(i,this._pcpf),this._projectIn(t,this._start),this._projectIn(e,this._end)}eval(t,e,i){if(this._project)if(i){const s=h;(0,c.ek)(this._start,this._end,t,e,s),(0,n.g)(m,e,s),(0,r.S)(e,this._pcpf,e,this.renderSpatialReference),(0,r.S)(m,this._pcpf,m,this.renderSpatialReference),(0,n.f)(i,m,e),(0,n.n)(i,i)}else(0,c.ZA)(this._start,this._end,t,e),(0,r.S)(e,this._pcpf,e,this.renderSpatialReference);else(0,n.o)(e,this._start,this._end,t),i&&((0,n.f)(i,this._end,this._start),(0,n.n)(i,i));return e}createRenderGeometry(t,e){const i=[],s=[],a=(e,a)=>{const o=m;(0,n.f)(o,e,t),i.push([o[0],o[1],o[2]]),s.push([a[0],a[1],a[2]])};for(let n=0;n<128;++n){const t=n/127,i=p,s=h;this.eval(t,i),e.worldUpAtPosition(i,s),a(i,s)}return{points:i,normals:s}}}const p=(0,s.Ue)(),h=(0,s.Ue)(),m=(0,s.Ue)()},66156:(t,e,i)=>{i.d(e,{j:()=>A});var n=i(25158),s=i(37081),a=i(68401),o=i(17363),r=i(56529),l=i(78041),c=i(93822),d=i(97731),u=i(4760),p=i(12594),h=i(64642),m=i(11983),_=i(33236),g=i(27366),f=(i(98634),i(82144)),v=i(31132),y=i(33559),S=i(27627),b=i(50411),M=i(25920),C=i(8883),w=i(32500),P=i(8548),x=i(36207);class D extends v.A{initializeProgram(t){return new S.$(t.rctx,D.shader.get().build(this.configuration),I)}_setPipelineState(t,e){const i=this.configuration,n=t===M.A.NONE,a=t===M.A.FrontFace;return(0,x.sm)({blending:i.output===s.H_.Color&&i.transparent?n?T:(0,l.j7)(t):null,culling:(0,x.zp)(i.cullFace),depthTest:{func:(0,l.Bh)(t)},depthWrite:n?i.writeDepth?x.LZ:null:(0,l.K5)(t),drawBuffers:(0,l.V7)(t),colorWrite:x.BK,stencilWrite:i.hasOccludees?b.s3:null,stencilTest:i.hasOccludees?e?b.eD:b.RY:null,polygonOffset:n||a?null:(0,l.je)(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipeline(t){return t?this._occludeePipelineState:super.getPipeline()}}D.shader=new f.J(w.I,(()=>i.e(8957).then(i.bind(i,18957))));const T=(0,x.if)(P.zi.ONE,P.zi.ONE_MINUS_SRC_ALPHA);class O extends C.W{constructor(){super(...arguments),this.output=s.H_.Color,this.cullFace=a.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=M.A.NONE,this.multipassEnabled=!1,this.cullAboveGround=!1,this.perspectiveInterpolation=!0}}(0,g._)([(0,y.o)({count:s.H_.COUNT})],O.prototype,"output",void 0),(0,g._)([(0,y.o)({count:a.Vr.COUNT})],O.prototype,"cullFace",void 0),(0,g._)([(0,y.o)()],O.prototype,"hasSlicePlane",void 0),(0,g._)([(0,y.o)()],O.prototype,"transparent",void 0),(0,g._)([(0,y.o)()],O.prototype,"enableOffset",void 0),(0,g._)([(0,y.o)()],O.prototype,"writeDepth",void 0),(0,g._)([(0,y.o)()],O.prototype,"hasOccludees",void 0),(0,g._)([(0,y.o)({count:M.A.COUNT})],O.prototype,"transparencyPassType",void 0),(0,g._)([(0,y.o)()],O.prototype,"multipassEnabled",void 0),(0,g._)([(0,y.o)()],O.prototype,"cullAboveGround",void 0),(0,g._)([(0,y.o)()],O.prototype,"perspectiveInterpolation",void 0),(0,g._)([(0,y.o)({constValue:!1})],O.prototype,"occlusionPass",void 0);const I=new Map([[u.T.POSITION,0],[u.T.UV0,2],[u.T.PERSPECTIVEDIVIDE,3]]);class A extends m.c{constructor(t){super(t,new H),this.supportsEdges=!0,this.produces=new Map([[c.r.OPAQUE_MATERIAL,t=>(0,s.ou)(t)||(0,s.D5)(t)&&!this.parameters.transparent],[c.r.TRANSPARENT_MATERIAL,t=>(0,s.D5)(t)&&this.parameters.transparent&&this.parameters.writeDepth],[c.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,t=>(0,s.D5)(t)&&this.parameters.transparent&&!this.parameters.writeDepth],[c.r.DRAPED_MATERIAL,t=>(0,s.D5)(t)||(0,s.ou)(t)]]),this._vertexAttributeLocations=I,this._configuration=new O}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=e.transparencyPassType,this._configuration.enableOffset=e.camera.relativeElevation<l.ve,this._configuration.multipassEnabled=e.multipassEnabled,this._configuration.cullAboveGround=e.multipassTerrain.cullAboveGround,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}createGLMaterial(t){return new R(t)}createBufferWriter(){const t=h.W1.clone();return this.parameters.perspectiveInterpolation&&t.f32(u.T.PERSPECTIVEDIVIDE),new z(t)}}class R extends o.F{constructor(t){super({...t,...t.material.parameters})}_updateParameters(t){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(D,t)}_updateOccludeeState(t){t.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:t.hasOccludees}),this._updateParameters(t))}beginSlot(t){return this._output===s.H_.Color&&this._updateOccludeeState(t),this._updateParameters(t)}}class z extends p.G{write(t,e,i,s,a){for(const o of this.vertexBufferLayout.fields.keys()){const r=i.attributes.get(o);if(r)if(o===u.T.PERSPECTIVEDIVIDE){(0,d.hu)(1===r.size);const t=s.getField(o,n.ly);t&&(0,_.XW)(r,t,a)}else(0,_.i9)(o,r,t,e,s,a)}}}class H extends r.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=a.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0,this.perspectiveInterpolation=!1}}},70209:(t,e,i)=>{i.d(e,{Er:()=>r,Lp:()=>l,Yq:()=>c});var n=i(14921),s=i(92026),a=i(66978),o=i(94172);function r(t,e){t.interactive=!0;const{tool:i,view:r}=t;r.activeTool=i;let l=(0,a.fu)(e,(()=>{r.activeTool===i&&(r.activeTool=null)}));return(0,n.vr)((async t=>{await(0,o.N1)((()=>null==i||!i.active),t),l=(0,s.hw)(l)}),e)}function l(t,e){return(0,o.YP)((()=>t.interactive),(()=>function(t,e){t.interactive?function(t,e){c(t);const{view:i,analysis:n}=t,s=new e({view:i,analysis:n,analysisViewData:t});t.tool=s,i.tools.add(s)}(t,e):c(t)}(t,e)),o.tX)}function c(t){const{view:e,tool:i}=t;null!=i&&(e.tools.remove(i),t.tool=null)}},86509:(t,e,i)=>{i.d(e,{f:()=>r});var n=i(27366),s=i(94172),a=(i(32718),i(93169),i(84936),i(10064),i(69912)),o=i(45900);let r=class extends o.m{constructor(t){super(t)}initialize(){this.addHandles((0,s.YP)((()=>this.analysisViewData.visible),(t=>this.visible=t),s.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};r=(0,n._)([(0,a.j)("esri.views.interactive.AnalysisToolBase")],r)},81298:(t,e,i)=>{i.d(e,{w:()=>a});var n=i(88153),s=i(54463);function a(t){const e=(0,n.Z8)(t);return e.options.store=s.eC.MIN,e.options.hud=!1,e}},71040:(t,e,i)=>{i.d(e,{y:()=>d});var n=i(27366),s=i(7138),a=i(92026),o=i(66978),r=i(49861),l=(i(93169),i(32718),i(84936),i(69912)),c=i(93463);let d=class extends s.Z{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,o.Ds)((async(t,e,i,n)=>{const s=this._frameTask;if(null==s)return;const a=await s.schedule((()=>e.snap({...t,context:i,signal:n})),n);a.valid&&await s.schedule((()=>{this.stagedPoint=a.apply(),t!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=e.update({...this._snapPoints,context:i}))}),n)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){const t="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=t?t.registerTask(c.T8.SNAPPING):c.sq}destroy(){this._abortController=(0,a.IM)(this._abortController),this._frameTask=(0,a.hw)(this._frameTask)}update(t,e,i){this._snapPoints=t;const{point:n,scenePoint:s}=t,a=e.update({point:n,scenePoint:s,context:i});return this.stagedPoint=a,a}async snap(t,e,i){const{point:n,scenePoint:s}=t;return this.stagedPoint=e.update({point:n,scenePoint:s,context:i}),this._snapPoints=t,null==this._abortController&&(this._abortController=new AbortController),this._snap(t,e,i,this._abortController.signal)}async snapAgainNearPreviousMapPoint(t,e){null!=this._snapPoints&&await this.snap(this._snapPoints,t,e)}abort(){this._abortController=(0,a.IM)(this._abortController),this._snapPoints=null}};(0,n._)([(0,r.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,n._)([(0,r.Cb)()],d.prototype,"stagedPoint",null),(0,n._)([(0,r.Cb)()],d.prototype,"constrainResult",void 0),(0,n._)([(0,r.Cb)()],d.prototype,"_stagedPoint",void 0),d=(0,n._)([(0,l.j)("esri.views.interactive.snapping.SnappingOperation")],d)},59418:(t,e,i)=>{i.d(e,{C_:()=>o,Qw:()=>r,x:()=>l});var n=i(12400),s=i(4914),a=i(13615);function o(t){return(0,a.kQ)(t)??(0,s.Sx)(t)}function r(t,e){return(0,a.RT)(t,e)??(0,s.xI)(t,e)}function l(t,e,i){return c[0]=t[0],c[1]=t[1],c[2]=3===t.length?t[2]:0,d[0]=e[0],d[1]=e[1],d[2]=3===e.length?e[2]:0,(0,a.FB)(c,d,i)??(0,s.qj)(c,d,i)}const c=(0,n.Ue)(),d=(0,n.Ue)()}}]);
//# sourceMappingURL=9290.35f2bd80.chunk.js.map