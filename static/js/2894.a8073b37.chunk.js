"use strict";(self.webpackChunksc_land=self.webpackChunksc_land||[]).push([[2894],{47741:(e,t,n)=>{n.d(t,{F:()=>a,a:()=>c,b:()=>u});var r=n(24967),i=n(99339),s=n(98634),o=n(64201),l=n(19253);class a extends s.K{}function u(){const e=new o.kG;return e.include(r.k),e.outputs.add("fragColor","vec4",0),e.fragment.uniforms.add(new l.A("colorTexture",(e=>e.color)),new l.A("focusArea",(e=>e.focusArea)),new i._("focusAreaEffectMode",(e=>e.effect??1))).main.add(s.H`float mask = texture( focusArea, uv, 0.0 ).r;
vec4 color = texture( colorTexture, uv, 0.0 );
vec4 colorDeSaturate = vec4(color.r * 0.25 + color.g * 0.5 + color.b * 0.25);
if (focusAreaEffectMode == 1) {
fragColor = mask > 0.0 ? color : 0.55 * colorDeSaturate + 0.45;
} else {
fragColor = mask > 0.0 ? color : 0.33 * mix(color, colorDeSaturate, 0.);
}`),e}const c=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaColorPassParameters:a,build:u},Symbol.toStringTag,{value:"Module"}))},68908:(e,t,n)=>{n.d(t,{F:()=>c,a:()=>d,b:()=>h});var r=n(29134),i=n(7025),s=n(12400),o=n(98634),l=n(8654),a=n(64201),u=n(4760);class c extends o.K{constructor(){super(...arguments),this.origin=s.AG}}function h(){const e=new a.kG;return e.attributes.add(u.T.POSITION,"vec3"),e.outputs.add("fragColor","vec4",0),e.vertex.uniforms.add(new l.g("proj",((e,t)=>t.camera.projectionMatrix)),new l.g("view",((e,t)=>(0,r.Iu)(f,t.camera.viewMatrix,e.origin)))).main.add(o.H`gl_Position = proj * view * vec4(position, 1.0);`),e.fragment.main.add(o.H`fragColor = vec4(1., 0., 0., 1.);`),e}const f=(0,i.Ue)(),d=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaMaskPassParameters:c,build:h},Symbol.toStringTag,{value:"Module"}))},79347:(e,t,n)=>{function r(e,t,n){n=n||2;var r,s,l,a,u,c,f,d=t&&t.length,p=d?t[0]*n:e.length,x=i(e,0,p,n,!0),y=[];if(!x||x.next===x.prev)return y;if(d&&(x=h(e,t,x,n)),e.length>80*n){r=l=e[0],s=a=e[1];for(var v=n;v<p;v+=n)(u=e[v])<r&&(r=u),(c=e[v+1])<s&&(s=c),u>l&&(l=u),c>a&&(a=c);f=0!==(f=Math.max(l-r,a-s))?1/f:0}return o(x,y,n,r,s,f),y}function i(e,t,n,r,i){var s,o;if(i===I(e,t,n,r)>0)for(s=t;s<n;s+=r)o=T(s,e[s],e[s+1],o);else for(s=n-r;s>=t;s-=r)o=T(s,e[s],e[s+1],o);if(o&&m(o,o.next)){var l=o.next;N(o),o=l}return o}function s(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{var i=r.prev;if(N(r),(r=t=i)===r.next)break;n=!0}}while(n||r!==t);return t}function o(e,t,n,r,i,h,f){if(e){!f&&h&&y(e,r,i,h);for(var d,p,x=e;e.prev!==e.next;)if(d=e.prev,p=e.next,h?a(e,r,i,h):l(e))t.push(d.i/n),t.push(e.i/n),t.push(p.i/n),N(e),e=p.next,x=p.next;else if((e=p)===x){f?1===f?o(e=u(s(e),t,n),t,n,r,i,h,2):2===f&&c(e,t,n,r,i,h):o(s(e),t,n,r,i,h,1);break}}}function l(e){var t=e.prev,n=e,r=e.next;if(w(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(_(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&w(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,n,r){var i=e.prev,s=e,o=e.next;if(w(i,s,o)>=0)return!1;for(var l=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,a=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,u=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,c=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,h=v(l,a,t,n,r),f=v(u,c,t,n,r),d=e.prevZ,p=e.nextZ;d&&d.z>=h&&p&&p.z<=f;){if(d!==e.prev&&d!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==e.prev&&p!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function u(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!m(i,o)&&A(i,r,r.next,o)&&S(i,o)&&S(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),N(r),N(r.next),r=e=o),r=r.next}while(r!==e);return s(r)}function c(e,t,n,r,i,l){var a=e;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&b(a,u)){var c=R(a,u);return a=s(a,a.next),c=s(c,c.next),o(a,t,n,r,i,l),void o(c,t,n,r,i,l)}u=u.next}a=a.next}while(a!==e)}function h(e,t,n,r){var o,l,a,u=[];for(o=0,l=t.length;o<l;o++)(a=i(e,t[o]*r,o<l-1?t[o+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),u.push(g(a));for(u.sort(f),o=0;o<u.length;o++)n=s(n=p(u[o],n),n.next);return n}function f(e,t){return e.x-t.x}function d(e){if(e.next.prev===e)return e;let t=e;for(;;){const n=t.next;if(n.prev===t||n===t||n===e)break;t=n}return t}function p(e,t){var n=function(e,t){var n,r=t,i=e.x,s=e.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var l=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=i&&l>o){if(o=l,l===i){if(s===r.y)return r;if(s===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var a,u=n,c=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&_(s<h?i:o,s,c,h,s<h?o:i,s,r.x,r.y)&&(a=Math.abs(s-r.y)/(i-r.x),S(r,e)&&(a<f||a===f&&(r.x>n.x||r.x===n.x&&x(n,r)))&&(n=r,f=a)),r=r.next}while(r!==u);return n}(e,t);if(!n)return t;var r=R(n,e),i=s(n,n.next);let o=d(r);return s(o,o.next),i=d(i),d(t===n?i:t)}function x(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function y(e,t,n,r){var i=e;do{null===i.z&&(i.z=v(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,s,o,l,a,u=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,r=n,l=0,t=0;t<u&&(l++,r=r.nextZ);t++);for(a=u;l>0||a>0&&r;)0!==l&&(0===a||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,a--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,u*=2}while(o>1)}(i)}function v(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function g(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function _(e,t,n,r,i,s,o,l){return(i-o)*(t-l)-(e-o)*(s-l)>=0&&(e-o)*(r-l)-(n-o)*(t-l)>=0&&(n-o)*(s-l)-(i-o)*(r-l)>=0}function b(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&A(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||m(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,n,r){var i=E(w(e,t,n)),s=E(w(e,t,r)),o=E(w(n,r,e)),l=E(w(n,r,t));return i!==s&&o!==l||!(0!==i||!C(e,n,t))||!(0!==s||!C(e,r,t))||!(0!==o||!C(n,e,r))||!(0!==l||!C(n,t,r))}function C(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function E(e){return e>0?1:e<0?-1:0}function S(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function R(e,t){var n=new P(e.i,e.x,e.y),r=new P(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function T(e,t,n,r){var i=new P(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function N(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function P(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(e,t,n,r){for(var i=0,s=t,o=n-r;s<n;s+=r)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}n.d(t,{e:()=>r}),r.deviation=function(e,t,n,r){var i=t&&t.length,s=i?t[0]*n:e.length,o=Math.abs(I(e,0,s,n));if(i)for(var l=0,a=t.length;l<a;l++){var u=t[l]*n,c=l<a-1?t[l+1]*n:e.length;o-=Math.abs(I(e,u,c,n))}var h=0;for(l=0;l<r.length;l+=3){var f=r[l]*n,d=r[l+1]*n,p=r[l+2]*n;h+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[i][s][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},35888:(e,t,n)=>{n.d(t,{d:()=>s});var r=n(16889),i=n(39406);function s(e,t,n){const s=Array.isArray(e),c=s?e.length/t:e.byteLength/(4*t),h=s?e:new Uint32Array(e,0,c*t),f=n?.minReduction??0,d=n?.originalIndices||null,p=d?d.length:0,x=n?.componentOffsets||null;let y=0;if(x)for(let r=0;r<x.length-1;r++){const e=x[r+1]-x[r];e>y&&(y=e)}else y=c;const v=Math.floor(1.1*y)+1;(null==u||u.length<2*v)&&(u=new Uint32Array((0,r.Sf)(2*v)));for(let r=0;r<2*v;r++)u[r]=0;let g=0;const _=!!x&&!!d,b=_?p:c;let w=(0,i.$z)(c);const m=new Uint32Array(p),A=1.96;let C=0!==f?Math.ceil(4*A*A/(f*f)*f*(1-f)):b,E=1,S=x?x[1]:b;for(let r=0;r<b;r++){if(r===C){const e=1-g/r;if(e+A*Math.sqrt(e*(1-e)/r)<f)return null;C*=2}if(r===S){for(let e=0;e<2*v;e++)u[e]=0;if(d)for(let e=x[E-1];e<x[E];e++)m[e]=w[d[e]];S=x[++E]}const e=_?d[r]:r,n=e*t,i=a(h,n,t);let s=i%v,l=g;for(;0!==u[2*s+1];){if(u[2*s]===i){const e=u[2*s+1]-1;if(o(h,n,e*t,t)){l=w[e];break}}s++,s>=v&&(s-=v)}l===g&&(u[2*s]=i,u[2*s+1]=e+1,g++),w[e]=l}if(0!==f&&1-g/c<f)return null;if(_){for(let e=x[E-1];e<m.length;e++)m[e]=w[d[e]];w=(0,i.mi)(m)}const R=s?new Array(g):new Uint32Array(g*t);g=0;for(let r=0;r<b;r++)w[r]===g&&(l(h,(_?d[r]:r)*t,R,g*t,t),g++);if(d&&!_){const e=new Uint32Array(p);for(let t=0;t<e.length;t++)e[t]=w[d[t]];w=(0,i.mi)(e)}return{buffer:Array.isArray(R)?R:R.buffer,indices:w,uniqueCount:g}}function o(e,t,n,r){for(let i=0;i<r;i++)if(e[t+i]!==e[n+i])return!1;return!0}function l(e,t,n,r,i){for(let s=0;s<i;s++)n[r+s]=e[t+s]}function a(e,t,n){let r=0;for(let i=0;i<n;i++)r=e[t+i]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let u=null},26844:(e,t,n)=>{n.d(t,{i:()=>a});var r=n(16889),i=n(68860),s=n(32035),o=n(14320),l=n(55652);function a(e,t,n){const a=function(e,t,n,r){const o=(e=>!Array.isArray(e[0]))(t)?(e,n)=>t[3*e+n]:(e,n)=>t[e][n],a=r?(0,i.c9)(r)/(0,i._R)(r):1;return(0,l.zu)(e,((e,t)=>(0,s.i)(e,o(t,0)*a,o(t,1)*a,o(t,2))),n)}(u,e,t,n)?(0,l.st)(u):[0,0,1];return Math.abs(a[2])>Math.cos((0,r.Vl)(80))?o.R.Z:Math.abs(a[1])>Math.abs(a[0])?o.R.Y:o.R.X}const u=(0,l.Ue)()},91320:(e,t,n)=>{n.d(t,{Ni:()=>d,ZI:()=>r,bT:()=>f});var r,i,s=n(79347),o=n(14320),l=n(69662),a=n(86372),u=n(39406),c=n(26844),h=n(35888);function f(e){const t=d(e.rings,e.hasZ,r.CCW_IS_HOLE,e.spatialReference),n=new Array;let i=0,o=0;for(const r of t.polygons){const e=r.count,l=r.index,c=(0,a.Rq)(t.position,3*l,3*e),h=r.holeIndices.map((e=>e-l)),f=(0,u.mi)((0,s.e)(c,h,3));n.push({position:c,faces:f}),i+=c.length,o+=f.length}const l=function(e,t,n){if(1===e.length)return e[0];const r=(0,a.bg)(t),i=new Array(n);let s=0,o=0,l=0;for(const a of e){for(let e=0;e<a.position.length;e++)r[s++]=a.position[e];for(const e of a.faces)i[o++]=e+l;l=s/3}return{position:r,faces:(0,u.mi)(i)}}(n,i,o),c=Array.isArray(l.position)?(0,h.d)(l.position,3,{originalIndices:l.faces}):(0,h.d)(l.position.buffer,6,{originalIndices:l.faces});return l.position=(0,a.QZ)(new Float64Array(c.buffer)),l.faces=c.indices,l}function d(e,t,n,i){const s=e.length,o=new Array(s),l=new Array(s),u=new Array(s);let c=0;for(let r=0;r<s;++r)c+=e[r].length;let h=0,f=0,d=0;const y=(0,a.bg)(3*c);let v=0;for(let a=s-1;a>=0;a--){const c=e[a],g=n===r.CCW_IS_HOLE&&x(c,t,i);if(g&&1!==s)o[h++]=c;else{let e=c.length;for(let t=0;t<h;++t)e+=o[t].length;const n={index:v,pathLengths:new Array(h+1),count:e,holeIndices:new Array(h)};n.pathLengths[0]=c.length,c.length>0&&(u[d++]={index:v,count:c.length}),v=g?p(c,c.length-1,-1,y,v,c.length,t):p(c,0,1,y,v,c.length,t);for(let r=0;r<h;++r){const e=o[r];n.holeIndices[r]=v,n.pathLengths[r+1]=e.length,e.length>0&&(u[d++]={index:v,count:e.length}),v=p(e,0,1,y,v,e.length,t)}h=0,n.count>0&&(l[f++]=n)}}for(let r=0;r<h;++r){const e=o[r];e.length>0&&(u[d++]={index:v,count:e.length}),v=p(e,0,1,y,v,e.length,t)}return l.length=f,u.length=d,{position:y,polygons:l,outlines:u}}function p(e,t,n,r,i,s,o){i*=3;for(let l=0;l<s;++l){const s=e[t];r[i++]=s[0],r[i++]=s[1],r[i++]=o&&s[2]?s[2]:0,t+=n}return i/3}function x(e,t,n){if(!t)return!(0,l.bu)(e);const r=e.length-1;switch((0,c.i)(e,r,n)){case o.R.X:return!(0,l.bu)(e,o.R.Y,o.R.Z);case o.R.Y:return!(0,l.bu)(e,o.R.X,o.R.Z);case o.R.Z:return!(0,l.bu)(e,o.R.X,o.R.Y)}}(i=r||(r={}))[i.NONE=0]="NONE",i[i.CCW_IS_HOLE=1]="CCW_IS_HOLE"},15380:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var r=n(27366),i=n(92026),s=n(94172),o=n(49861),l=n(69912),a=n(79347),u=n(7025),c=n(32035),h=n(12400),f=n(37998),d=n(86372),p=n(39406),x=n(11186),y=n(50951),v=n(42069),g=n(78935),_=n(4714),b=n(96387),w=n(27689),m=(n(93169),n(32718),n(84936),n(18020)),A=n(31239),C=n(82144),E=n(78914),S=n(47741),R=n(36207);class T extends E.A{constructor(e,t,r){super(e,t,new C.J(S.a,(()=>n.e(1140).then(n.bind(n,91140)))),r)}initializePipeline(){return(0,R.sm)({colorWrite:R.gf})}}var N=n(68908),P=n(8548);class I extends E.A{constructor(e,t,r){super(e,t,new C.J(N.a,(()=>n.e(7878).then(n.bind(n,37878)))),r)}initializePipeline(){return(0,R.sm)({colorWrite:R.gf,depthTest:{func:P.wb.LEQUAL}})}}var M=n(7566),Z=n(53641),O=n(80658),H=n(44070);let L=class extends A.Z{constructor(e){super(e),this.consumes={required:["final-color"]},this.produces="final-color",this.focusAreaGeometries=new Array,this._vaos=Array(),this._count=new Array,this._origins=new Array,this._colorParameters=new S.F,this._maskParameters=new N.F,e.techniques.precompile(I),e.techniques.precompile(T)}initialize(){this.setExtrudedVolume()}destroy(){this._vaos.forEach((e=>e.dispose())),this._vaos=[],this._count=[],this._origins=[]}render(e){const t=this.techniques.acquire(I),n=this.techniques.acquire(T),r=this.bindParameters,i=e.find((e=>{let{name:t}=e;return"final-color"===t})),s=i?.getTexture(),o=r.camera,l=o.fullViewport[2],a=o.fullViewport[3],u=this.fboCache.acquire(l,a,"focusArea",m.q.RGBA),c=this.fboCache.acquire(l,a,this.produces);if(!t.compiled||!n.compiled||!this._vaos||this.effect===F.NONE)return this.requestRender(),t.release(),n.release(),c.release(),u.release(),i;const h=this.renderingContext;u.attachDepth(i.getAttachment(this.gl.DEPTH_STENCIL_ATTACHMENT)),h.bindFramebuffer(u.fbo),h.clear(P.Hf.COLOR|P.Hf.STENCIL),h.setViewport(0,0,l,a),h.gl.clearStencil(0),h.gl.clear(h.gl.STENCIL_BUFFER_BIT),h.setClearStencil(0);for(let f=0;f<this._vaos.length;f++){const e=this._vaos[f],n=this._count[f];e&&(this._maskParameters.origin=this._origins[f],h.bindTechnique(t,r,this._maskParameters),h.setFaceCullingEnabled(!1),h.setStencilTestEnabled(!0),h.setStencilWriteMask(255),h.setStencilFunction(P.wb.ALWAYS,0,255),h.setStencilOpSeparate(P.LR.FRONT,P.xS.KEEP,P.xS.INCR_WRAP,P.xS.KEEP),h.setStencilOpSeparate(P.LR.BACK,P.xS.KEEP,P.xS.DECR_WRAP,P.xS.KEEP),h.setDepthWriteEnabled(!1),h.setColorMask(!1,!1,!1,!1),h.bindVAO(e),h.drawArrays(P.MX.TRIANGLES,0,n),h.setFaceCullingEnabled(!1),h.setDepthTestEnabled(!1),h.setStencilFunction(P.wb.NOTEQUAL,0,255),h.setStencilWriteMask(0),h.setColorMask(!0,!0,!0,!0),h.drawArrays(P.MX.TRIANGLES,0,n))}return t.release(),h.gl.clear(h.gl.STENCIL_BUFFER_BIT),h.bindFramebuffer(c.fbo),this._colorParameters.color=s,this._colorParameters.focusArea=u.getTexture(),this._colorParameters.effect=this.effect,h.bindTechnique(n,r,this._colorParameters),h.screen.draw(),u.release(),n.release(),c.attachDepth(i.getAttachment(this.gl.DEPTH_STENCIL_ATTACHMENT)),c}setExtrudedVolume(){const e=this.focusAreaGeometries;this._vaos=[],this._count=[],this._origins=[];for(let t=0;t<e.length;t++){const n=e[t],r=new Array,i=n.indicesBottom;this._origins.push(n.origin);for(let e=0;e<i.length;e++)r.push(n.positions[3*(i[e]-1)]),r.push(n.positions[3*(i[e]-1)+1]),r.push(n.positions[3*(i[e]-1)+2]);const s=n.indicesExtruded;for(let e=0;e<s.length;e++)r.push(n.positions[3*s[e]]),r.push(n.positions[3*s[e]+1]),r.push(n.positions[3*s[e]+2]);const o=new Float32Array(r),l=new O.U(this.renderingContext,M.i,new Map([["geometry",Z.ap]]),new Map([["geometry",H.f.createVertex(this.renderingContext,P.l1.STATIC_DRAW,o)]]));this._vaos?.push(l),this._count.push(i.length+s.length)}}};(0,r._)([(0,o.Cb)()],L.prototype,"consumes",void 0),(0,r._)([(0,o.Cb)()],L.prototype,"produces",void 0),(0,r._)([(0,o.Cb)({constructOnly:!0})],L.prototype,"techniques",void 0),(0,r._)([(0,o.Cb)()],L.prototype,"focusAreaGeometries",void 0),(0,r._)([(0,o.Cb)()],L.prototype,"effect",void 0),L=(0,r._)([(0,l.j)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaRenderNode")],L);class k{constructor(e,t,n,r,i){this.positions=e,this.indicesBottom=t,this.indicesExtruded=n,this.height=r,this.origin=i}}var F,q;(q=F||(F={}))[q.NONE=0]="NONE",q[q.BRIGHT=1]="BRIGHT",q[q.DARK=2]="DARK";const z={none:F.NONE,bright:F.BRIGHT,dark:F.DARK};var U=n(67581);let G=class extends((0,v.A)(U.Z)){constructor(){super(...arguments),this.type="focusArea-3d",this._elevationContext=new g.o,this._geometries=new Array}initialize(){this.addHandles([(0,s.YP)((()=>this.layer.geometries),((e,t)=>{t=e,this._extrudePolygons(t),this._setFocusAreaRenderNode()}),s.tX),(0,s.YP)((()=>this.layer.tmpEffect),((e,t)=>{t=e,this._renderNode&&t&&(this._renderNode.effect=z[t])}),s.tX),(0,s.YP)((()=>this.layer.visible),((e,t)=>{e?this._renderNode??=new L({view:this.view,techniques:this.view._stage.renderView.techniques,focusAreaGeometries:this._geometries,effect:z[this.layer.tmpEffect??"none"]}):this._renderNode=(0,i.SC)(this._renderNode)}),s.tX)])}destroy(){this._renderNode=(0,i.SC)(this._renderNode),this._geometries=[]}_extrudePolygons(e){this._geometries=[];for(const t of e){const e=(0,u.Ue)(),n=(0,h.Ue)(),r=this.view.renderCoordsHelper.viewingMode===y.JY.Global;r||this.view.renderCoordsHelper.worldUpAtPosition(null,n);const i=(0,b.zE)(t);if(null==i)return;(0,f.B)(t.spatialReference,[i.x,i.y,0],e,this.view.renderCoordsHelper.spatialReference);const s=(0,c.n)(D,[e[12]-0*n[0],e[13]-0*n[1],e[14]-0*n[2]]),o=(0,u.Ue)();o[12]=-e[12],o[13]=-e[13],o[14]=-e[14];const l=(0,w.VP)(t,this.view.elevationProvider,this.view.renderCoordsHelper,this._elevationContext),{polygons:v,mapPositions:g,position:m}=l;for(const t of v){const i=t.count,l=(0,a.e)(t.mapPositions,t.holeIndices,3);if(0===l.length)continue;const u=l.length,c=6*i,h=(0,p.$z)(c+u),f=(0,p.$z)(u),y=(0,d.bg)(3*c),v=(0,d.bg)(3*c),b=(0,d.bg)(3*c),w=(0,d.bg)(c);(0,_.A)(m,g,l,t,y,b,v,w,h,f,1e4,n,r),(0,x.t)(y,y,o);const A=new k(y,f,h,1e4,[e[12]+0*s[0],e[13]+0*s[1],e[14]+0*s[2]]);this._geometries.push(A)}}}_setFocusAreaRenderNode(){this._renderNode?(this._renderNode.focusAreaGeometries=this._geometries,this._renderNode.setExtrudedVolume()):this._renderNode=new L({view:this.view,techniques:this.view._stage.renderView.techniques,focusAreaGeometries:this._geometries,effect:z[this.layer.tmpEffect??"none"]})}};(0,r._)([(0,o.Cb)()],G.prototype,"type",void 0),(0,r._)([(0,o.Cb)()],G.prototype,"layer",void 0),G=(0,r._)([(0,l.j)("esri.views.3d.layers.FocusAreaLayerView3D")],G);const D=(0,h.Ue)(),V=G},42069:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(27366),i=n(42537),s=n(66978),o=n(94172),l=n(49861),a=(n(93169),n(32718),n(84936),n(69912)),u=n(5354);const c=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,u.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,i.kB)((()=>e.abort()))),await(0,o.N1)((()=>this.view.defaultsFromMap?.heightModelInfoReady),t),(0,s.k_)(t);const n=(0,u.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(n)throw n}};return(0,r._)([(0,l.Cb)()],t.prototype,"view",void 0),(0,r._)([(0,l.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,r._)([(0,a.j)("esri.views.3d.layers.LayerView3D")],t),t}},67581:(e,t,n)=>{n.d(t,{Z:()=>x});var r=n(27366),i=n(7138),s=n(91505),o=n(79056),l=n(32718),a=n(92026),u=n(67426),c=n(49861),h=(n(93169),n(84936),n(69912)),f=n(46634),d=n(69787);let p=class extends((0,o.IG)((0,u.v)(s.Z.EventedMixin(i.Z)))){constructor(e){super(e),this._updatingHandles=new f.R,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",n=this.layer?.title||"no title";l.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${n}', id: '${t}')`,e)}}))}destroy(){this._updatingHandles=(0,a.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,d.Cy)(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,d.Cy)(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,r._)([(0,c.Cb)()],p.prototype,"view",void 0),(0,r._)([(0,c.Cb)()],p.prototype,"fullOpacity",null),(0,r._)([(0,c.Cb)()],p.prototype,"layer",void 0),(0,r._)([(0,c.Cb)()],p.prototype,"parent",void 0),(0,r._)([(0,c.Cb)({readOnly:!0})],p.prototype,"suspended",null),(0,r._)([(0,c.Cb)({readOnly:!0})],p.prototype,"suspendInfo",null),(0,r._)([(0,c.Cb)({readOnly:!0})],p.prototype,"legendEnabled",null),(0,r._)([(0,c.Cb)({type:Boolean,readOnly:!0})],p.prototype,"updating",null),(0,r._)([(0,c.Cb)({readOnly:!0})],p.prototype,"updatingProgress",null),(0,r._)([(0,c.Cb)()],p.prototype,"updateSuspended",null),(0,r._)([(0,c.Cb)()],p.prototype,"visible",null),(0,r._)([(0,c.Cb)({readOnly:!0})],p.prototype,"visibleAtCurrentScale",null),(0,r._)([(0,c.Cb)({readOnly:!0})],p.prototype,"visibleAtCurrentTimeExtent",null),p=(0,r._)([(0,h.j)("esri.views.layers.LayerView")],p);const x=p}}]);
//# sourceMappingURL=2894.a8073b37.chunk.js.map