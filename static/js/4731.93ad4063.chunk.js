"use strict";(self.webpackChunksc_land=self.webpackChunksc_land||[]).push([[4731],{97613:(e,t,n)=>{n.d(t,{Z:()=>v});var i=n(27366),r=n(84314),o=n(7138),s=n(11582),a=n(46784),l=n(92026),u=n(49861),c=(n(93169),n(32718),n(84936),n(69912)),d=n(96866),p=n(848),h=n(64575);let g=class extends((0,a.eC)((0,s.J)(o.Z))){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,l._W)(this.position,e.position)&&(0,l._W)(this.elevationInfo,e.elevationInfo)&&(0,r.kk)(this.feature,e.feature)}};(0,i._)([(0,u.Cb)({type:p.Z,json:{write:{isRequired:!0}}})],g.prototype,"position",void 0),(0,i._)([(0,u.Cb)({type:h.Z}),(0,d.B)()],g.prototype,"elevationInfo",void 0),(0,i._)([(0,u.Cb)(r.rX)],g.prototype,"feature",void 0),g=(0,i._)([(0,c.j)("esri.analysis.LineOfSightAnalysisObserver")],g);const v=g},33985:(e,t,n)=>{n.d(t,{Z:()=>g});var i=n(27366),r=n(84314),o=n(11582),s=n(46784),a=n(92026),l=n(49861),u=(n(93169),n(32718),n(84936),n(69912)),c=n(96866),d=n(848),p=n(64575);let h=class extends((0,s.eC)(o.j)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,a._W)(this.position,e.position)&&(0,a._W)(this.elevationInfo,e.elevationInfo)&&(0,r.kk)(this.feature,e.feature)}};(0,i._)([(0,l.Cb)({type:d.Z}),(0,c.B)()],h.prototype,"position",void 0),(0,i._)([(0,l.Cb)({type:p.Z}),(0,c.B)()],h.prototype,"elevationInfo",void 0),(0,i._)([(0,l.Cb)(r.rX)],h.prototype,"feature",void 0),h=(0,i._)([(0,u.j)("esri.analysis.LineOfSightAnalysisTarget")],h);const g=h},84314:(e,t,n)=>{n.d(t,{NS:()=>d,kk:()=>l,pD:()=>u,rX:()=>c});var i=n(32035),r=n(12400),o=n(40885),s=n(54463),a=n(41781);function l(e,t){return u(e)===u(t)}function u(e){if(null==e)return null;const t=null!=e.layer?e.layer.id:"";let n=null;return n=null!=e.objectId?e.objectId:null!=e.layer&&"objectIdField"in e.layer&&null!=e.layer.objectIdField&&null!=e.attributes?e.attributes[e.layer.objectIdField]:e.uid,null==n?null:`o-${t}-${n}`}const c={json:{write:{writer:function(e,t){null!=e?.layer?.objectIdField&&null!=e.attributes&&(t.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})},target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:function(e){if(null!=e.layerId&&null!=e.objectId)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}}}}};function d(e,t,n,l){const{sceneIntersectionHelper:c}=e,{observer:d,observerFeatureId:h,targetFeatureId:_,target:m}=n;if(null==h&&null==_)return;l||(l=e=>e),(0,i.a)(v,d,m);const y=(0,i.l)(v);(0,i.b)(v,d,v,1/y);const f=(0,o.zk)(v,m,g);t.options.store=s.eC.ALL,c.intersectToolIntersectorRay(f,t);let b=null,C=null,w=null,I=null;for(const i of t.results.all){const t=(0,a.tB)(i,e);if(null==t||null==i.distanceInRenderSpace)continue;const n=u(t);null!=n&&(null!=h&&n===h&&(b??=l(p(i,e,y)),i.distanceInRenderSpace-1<b&&(w=i)),null!=_&&n===_&&(C??=l(p(i,e,y)),null==I&&i.distanceInRenderSpace-1<y&&y-i.distanceInRenderSpace+1<C&&(I=i)))}const{observerAdjusted:O,targetAdjusted:T}=n;w?.getIntersectionPoint(O)?n.observerSurfaceNormal=w.getTransformedNormal((0,r.Ue)()):n.observerSurfaceNormal=null,I?.getIntersectionPoint(T)?n.targetSurfaceNormal=I.getTransformedNormal((0,r.Ue)()):n.targetSurfaceNormal=null}function p(e,t,n){if((0,a._s)(e)){const i=(0,a.VB)(e,t);if(null!=i)return Math.min(i*h,n)}return 1e-5*n}const h=.05,g=(0,o.Ue)(),v=(0,r.Ue)()},96866:(e,t,n)=>{n.d(t,{B:()=>h});var i=n(10064),r=n(9997),o=n(80292),s=n(35995),a=n(71907),l=n(33397),u=n(25265),c=n(49861),d=n(22892),p=n(53283);function h(e){const t=e?.origins??[void 0];return(n,i)=>{const r=function(e,t,n){if("resource"===e?.type)return function(e,t,n){const i=(0,l.Oe)(t,n);return{type:String,read:(e,t,n)=>{const r=(0,p.r)(e,t,n);return i.type===String?r:"function"==typeof i.type?new i.type({url:r}):void 0},write:{writer(t,r,a,l){if(!l?.resources)return"string"==typeof t?void(r[a]=(0,p.t)(t,l)):void(r[a]=t.write({},l));const c=function(e){return null==e?null:"string"==typeof e?e:e.url}(t),h=(0,p.t)(c,{...l,verifyItemRelativeUrls:l?.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},p.M.NO),m=i.type!==String&&(!(0,o.l)(this)||l?.origin&&this.originIdOf(n)>(0,u.M9)(l.origin)),y={object:this,propertyName:n,value:t,targetUrl:h,dest:r,targetPropertyName:a,context:l,params:e};l?.portalItem&&h&&!(0,s.YP)(h)?m&&e?.contentAddressed?g(y):m?function(e){const{context:t,targetUrl:n,params:i,value:r,dest:o,targetPropertyName:a}=e;if(!t.portalItem)return;const l=t.portalItem.resourceFromPath(n),u=_(r,n,t),c=(0,d.B)(u),p=(0,s.Ml)(l.path),h=i?.compress??!1;c===p?(t.resources&&v({...e,resource:l,content:u,compress:h,updates:t.resources.toUpdate}),o[a]=n):g(e)}(y):function(e){let{context:t,targetUrl:n,dest:i,targetPropertyName:r}=e;t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(n),compress:!1}),i[r]=n)}(y):l?.portalItem&&(null==h||null!=(0,p.i)(h)||(0,s.jc)(h)||m)?g(y):r[a]=h}}}}(e,t,n);switch(e?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=p.b;return{read:e,write:t}}}}(e,n,i);for(const e of t){const t=(0,c.CJ)(n,e,i);for(const e in r)t[e]=r[e]}}}function g(e){const{targetUrl:t,params:n,value:o,context:l,dest:u,targetPropertyName:c}=e;if(!l.portalItem)return;const h=(0,p.p)(t),g=_(o,t,l);if(n?.contentAddressed&&"json"!==g.type)return void l.messages?.push(new i.Z("persistable:contentAddressingUnsupported",`Property "${c}" is trying to serializing a resource with content of type ${g.type} with content addressing. Content addressing is only supported for json resources.`,{content:g}));const m=n?.contentAddressed&&"json"===g.type?(0,r.F)(g.jsonString):h?.filename??(0,a.DO)(),y=(0,s.v_)(n?.prefix??h?.prefix,m),f=`${y}.${(0,d.B)(g)}`;if(n?.contentAddressed&&l.resources&&"json"===g.type){const e=l.resources.toKeep.find((e=>{let{resource:t}=e;return t.path===f}))??l.resources.toAdd.find((e=>{let{resource:t}=e;return t.path===f}));if(e)return void(u[c]=e.resource.itemRelativeUrl)}const b=l.portalItem.resourceFromPath(f);(0,s.jc)(t)&&l.resources&&l.resources.pendingOperations.push((0,s.gi)(t).then((e=>{b.path=`${y}.${(0,d.B)({type:"blob",blob:e})}`,u[c]=b.itemRelativeUrl})).catch((()=>{})));const C=n?.compress??!1;l.resources&&v({...e,resource:b,content:g,compress:C,updates:l.resources.toAdd}),u[c]=b.itemRelativeUrl}function v(e){let{object:t,propertyName:n,updates:i,resource:r,content:o,compress:s}=e;i.push({resource:r,content:o,compress:s,finish:e=>{!function(e,t,n){"string"==typeof e[t]?e[t]=n.url:e[t].url=n.url}(t,n,e)}})}function _(e,t,n){return"string"==typeof e?{type:"url",url:t}:{type:"json",jsonString:JSON.stringify(e.toJSON(n))}}},80292:(e,t,n)=>{function i(e){return e&&"getAtOrigin"in e&&"originOf"in e}n.d(t,{l:()=>i})},22892:(e,t,n)=>{n.d(t,{B:()=>r});var i=n(35995);function r(e){return o[function(e){return"json"===e.type?"application/json":"blob"===e.type?e.blob.type:function(e){const t=(0,i.Ml)(e);return l[t]||s}(e.url)}(e)]||a}const o={},s="text/plain",a=o[s],l={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const u in l)o[l[u]]=u},98074:(e,t,n)=>{n.d(t,{p:()=>l});var i=n(27366),r=n(42537),o=n(67426),s=n(49861),a=(n(93169),n(32718),n(84936),n(69912));const l=e=>{let t=class extends((0,o.v)(e)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return null==this.parent||this.parent.visible&&!this.parent.suspended}set visible(e){this._overrideIfSome("visible",e)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,r.kB)((()=>this._interactiveViewModelCount--))}};return(0,i._)([(0,s.Cb)({constructOnly:!0})],t.prototype,"parent",void 0),(0,i._)([(0,s.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,i._)([(0,s.Cb)({type:Boolean})],t.prototype,"interactive",null),(0,i._)([(0,s.Cb)()],t.prototype,"_userInteractive",void 0),(0,i._)([(0,s.Cb)({readOnly:!0})],t.prototype,"updating",null),(0,i._)([(0,s.Cb)()],t.prototype,"visible",null),(0,i._)([(0,s.Cb)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,i._)([(0,a.j)("esri.views.3d.analysis.AnalysisView3D")],t),t}},77897:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ge});var i=n(27366),r=n(7138),o=n(80987),s=n(91505),a=(n(93169),n(92026)),l=n(49861),u=n(32718),c=(n(84936),n(69912)),d=n(12400),p=n(98074),h=(n(59486),n(84314)),g=n(14921),v=n(100),_=n(42537),m=n(66978),y=n(94172),f=n(32035),b=n(46634),C=n(79803),w=n(77258),I=n(65156),O=n(40885),T=n(74509);let P=class extends r.Z{constructor(e){super(e),this.target=null,this.intersectedGraphic=null,this.intersectedLocation=null,this.elevationAlignedTargetLocation=null,this.visible=void 0}};(0,i._)([(0,l.Cb)()],P.prototype,"target",void 0),(0,i._)([(0,l.Cb)()],P.prototype,"intersectedGraphic",void 0),(0,i._)([(0,l.Cb)()],P.prototype,"intersectedLocation",void 0),(0,i._)([(0,l.Cb)()],P.prototype,"elevationAlignedTargetLocation",void 0),(0,i._)([(0,l.Cb)({type:Boolean})],P.prototype,"visible",void 0),P=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSightAnalysisResult")],P);const R=P;let L=class extends r.Z{constructor(e){super(e),this.elevationAlignedTargetLocation=null,this.inputPoints={isValid:!1,observer:(0,d.Ue)(),observerSurfaceNormal:null,observerFeatureId:null,target:(0,d.Ue)(),targetSurfaceNormal:null,targetFeatureId:null,observerAdjusted:(0,d.Ue)(),targetAdjusted:(0,d.Ue)()},this.computationResult={start:(0,d.Ue)(),end:(0,d.Ue)(),intersection:(0,d.Ue)(),isValid:!1,isTargetVisible:!1},this.result=null}notifyResultChanged(){this.notifyChange("computationResult")}notifyInputPointsChanged(){this.notifyChange("inputPoints")}};(0,i._)([(0,l.Cb)()],L.prototype,"target",void 0),(0,i._)([(0,l.Cb)()],L.prototype,"elevationAlignedTargetLocation",void 0),(0,i._)([(0,l.Cb)()],L.prototype,"inputPoints",void 0),(0,i._)([(0,l.Cb)()],L.prototype,"computationResult",void 0),(0,i._)([(0,l.Cb)()],L.prototype,"result",void 0),L=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSight.LineOfSightComputation")],L);var S,A=n(17842),E=n(51378),V=n(65618),H=n(63780),D=n(84652);let M=S=class extends r.Z{constructor(e){super(e)}clone(){return new S({type:this.type,id:(0,D.d9)(this.id),mapPoint:(0,D.d9)(this.mapPoint),renderPoint:(0,d.d9)(this.renderPoint),normal:(0,D.d9)(this.normal),ray:(0,D.d9)(this.ray),graphic:this.graphic})}equals(e){return this.type===e.type&&this.id===e.id&&(0,a._W)(this.mapPoint,e.mapPoint)&&(0,f.H)(this.renderPoint,e.renderPoint)&&(0,H.fS)(this.normal,e.normal)&&(0,O.fS)(this.ray,e.ray)&&this.graphic===e.graphic}};(0,i._)([(0,l.Cb)()],M.prototype,"type",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],M.prototype,"id",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],M.prototype,"mapPoint",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],M.prototype,"renderPoint",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],M.prototype,"normal",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],M.prototype,"graphic",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],M.prototype,"ray",void 0),M=S=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSight.LineOfSightIntersectionResult")],M);var U=n(81703),j=n(43449),k=n(88153),F=n(54463),x=n(41781),Z=n(848);let G=class extends r.Z{constructor(e){super(e),this._terrainIntersectionOptionsLayerUids=new Set(["terrain"])}initialize(){this.intersector=(0,k.Z8)(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=F.eC.MIN}getScreenPointIntersection(e){const t=(0,A.md)(e,E.qW.get()),n=(0,U.u4)(this.view.state.camera,t,$);return this._getRayIntersection(n)}_getRayIntersection(e,t){const{view:n,intersector:i}=this;if(null==e||null==n.sceneIntersectionHelper)return null;i.options.store=F.eC.MIN,n.sceneIntersectionHelper.intersectToolIntersectorRay(e,i,t);const r=i.results.min;if(null==r.target)return null;const o=(0,d.Ue)();if(!r.getIntersectionPoint(o))return null;if(null!=t?.maxDistance&&(0,f.s)(o,e.origin)>t.maxDistance**2)return null;const s=n.renderCoordsHelper.fromRenderCoords(o,new Z.Z({spatialReference:n.spatialReference})),a=(0,d.d9)(r.normal);if((0,j.TX)(r))return new M({type:F.q7.TERRAIN,id:r.target.lij.slice(),mapPoint:s,renderPoint:o,normal:a,ray:(0,O.JG)(e),graphic:null});const l=(0,x.tB)(r,n);if(null==l)return null;const{layer:u,sourceLayer:c}=l,p="scene"===c?.type?(0,V.MS)(l,c.objectIdField):l.uid;return new M({type:F.q7.OBJECT,id:`${u?.uid}/${p}`,mapPoint:s,renderPoint:o,normal:a,ray:(0,O.JG)(e),graphic:l})}updateFromGroundIntersection(e,t,n){const i=z,r=N,o=B,s=W;(0,f.c)(r,e),this.view.renderCoordsHelper.worldUpAtPosition(r,o),(0,f.n)(o,o);const a=this.view.basemapTerrain.visibleElevationBounds,l=(t>=0?1:-1)*((a?Math.abs(a.max-a.min):100)+Math.abs(t));(0,f.h)(s,o,l),(0,f.g)(i,r,s),(0,O.zk)(i,r,$);const u=this._getRayIntersection($,{include:this._terrainIntersectionOptionsLayerUids,maxDistance:l});if(null!=u){const e=W;return(0,f.h)(e,o,t),(0,f.g)(n,u.renderPoint,e),(0,d.d9)(u.normal)}return(0,f.c)(n,e),null}};(0,i._)([(0,l.Cb)()],G.prototype,"view",void 0),(0,i._)([(0,l.Cb)()],G.prototype,"intersector",void 0),G=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSight.LineOfSightRayIntersector")],G);const z=(0,d.Ue)(),N=(0,d.Ue)(),B=(0,d.Ue)(),W=(0,d.Ue)(),$=(0,O.Ue)();var q=n(33906),X=n(93463);let Y=class extends(s.Z.EventedMixin(r.Z)){constructor(e){super(e),this.updateOnCameraChange=!0,this._observerGroundOffsetRenderSpace=0,this._effectiveObserverElevationMode="absolute-height",this._observerFeatureId=null,this._updatingHandles=new b.R,this._frameTask=X.sq,this._computationHandles=new v.Z,this._externalObserverUpdate=!0}initialize(){const e=this.view.resourceController?.scheduler;this._frameTask=e?e.registerTask(X.T8.LINE_OF_SIGHT_TOOL):X.sq,this._intersector=new G({view:this.view}),this.addHandles([this._connectObserver(),this._connectComputations(),this._connectTargets()])}destroy(){this._computationHandles.destroy(),this._computations.removeAll(),this._updatingHandles.destroy()}get updating(){return this._frameTask.updating||this._updatingHandles.updating}get priority(){return this._frameTask.priority}set priority(e){this._frameTask.priority=e}get _computations(){return this.analysisViewData.computations}get _elevationAlignedObserverPositionRenderSpace(){return this.analysisViewData.observerEngineLocation}set _elevationAlignedObserverPositionRenderSpace(e){this.analysisViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._elevationAlignedObserverPositionRenderSpace)}_computeResult(e){const t=e.computation,{inputPoints:n,computationResult:i}=t,{observerAdjusted:r,targetAdjusted:o}=n,{start:s,end:a}=i;(0,f.c)(s,r),(0,f.c)(a,o),this._canCompute(t)?this._computeIntersection(e):function(e){let{computation:t,interpolationInfo:n}=e;const{computationResult:i,inputPoints:r}=t,{start:o,end:s,intersection:a}=i,{originalIntersection:l,originalObserver:u,originalTarget:c}=n;if((0,f.c)(a,l),r.isValid){const e=Q,t=(0,f.F)(u,l)/(0,f.F)(u,c);(0,f.a)(e,o,u),(0,f.h)(e,e,1-t),(0,f.g)(a,a,e),(0,f.a)(e,s,c),(0,f.h)(e,e,t),(0,f.g)(a,a,e),i.isValid=!0}else t.result=null,i.isValid=!1,i.isTargetVisible=!1}(e),t.notifyResultChanged(),this.emit("result-changed",{target:e.computation.target,result:t.result})}_adjustStartEndPositions(e){const{view:t}=this,{inputPoints:n}=e,{observer:i,target:r,observerAdjusted:o,targetAdjusted:s}=n;(0,f.c)(o,i),(0,f.c)(s,r),(0,h.NS)(t,this._intersector.intersector,n);const{observerSurfaceNormal:a,targetSurfaceNormal:l}=n,u=this._screenPixelSize,c=Q;null!=a?(0,f.c)(c,a):(0,f.d)(c,s,o);const d=u;(0,f.n)(c,c),(0,f.h)(c,c,Math.min(d,1)),(0,f.g)(o,o,c),null!=l?(0,f.c)(c,l):(0,f.d)(c,o,s);const p=t.state.camera.computeScreenPixelSizeAt(s);(0,f.n)(c,c),(0,f.h)(c,c,Math.min(p,1)),(0,f.g)(s,s,c)}_computeIntersection(e){let{computation:t,interpolationInfo:n}=e;const{view:i}=this,{sceneIntersectionHelper:r,renderCoordsHelper:o}=i;if(null==r)return;const s=this._intersector.intersector,{computationResult:a,inputPoints:l}=t,{observer:u,target:c}=l,{start:d,end:p}=a,h=(0,O.zk)(d,p,ee);s.options.store=F.eC.MIN,r.intersectToolIntersectorRay(h,s);const g=s.results.min,v=a.intersection,_=Q;let m=!0;if(null!=g&&g.getIntersectionPoint(v)){(0,f.c)(n.originalIntersection,v),(0,f.c)(n.originalObserver,d),(0,f.c)(n.originalTarget,p),o.fromRenderCoords(v,_,i.spatialReference);const e=1-(0,f.F)(p,c)/(0,f.F)(d,c);m=(0,f.F)(u,v)>=e*(0,f.F)(u,c)}const y=new Z.Z(_,i.spatialReference);{const{result:e,target:n}=t;null!=e?(e.target=n,e.intersectedGraphic=m?null:(0,x.tB)(g,i),e.intersectedLocation=m?null:y,e.visible=m):t.result=new R({target:n,elevationAlignedTargetLocation:t.elevationAlignedTargetLocation,intersectedGraphic:m?null:(0,x.tB)(g,i),intersectedLocation:m?null:y,visible:m})}a.isValid=l.isValid=!0,a.isTargetVisible=m}_canCompute(e){const t=this.analysisViewData.elevationAlignedObserver,n=this.view.frustum;if(null==t||null==e.elevationAlignedTargetLocation||null==n)return!1;const{observerAdjusted:i,targetAdjusted:r}=e.inputPoints,o=n.intersectsPoint(i),s=n.intersectsPoint(r);return o&&s}_onObserverPositionChange(e,t,n,i,r){if(this._externalObserverUpdate=r,null==e)return this.analysisViewData.elevationAlignedObserver=null,void(this._observerFeatureId=null);if(null==t)return(0,q.e)(this.analysis,e.spatialReference,u.Z.getLogger(this)),void(this.analysisViewData.elevationAlignedObserver=null);const o=J(t,n),{absoluteZ:s,elevation:a}=(0,T.tq)(t.x,t.y,t.z,this.view.spatialReference,this.view,o),l=t.clone();l.z=s,this._effectiveObserverElevationMode=o.mode,this.analysisViewData.elevationAlignedObserver=l;const c=(0,d.Ue)();this.view.renderCoordsHelper.toRenderCoords(l,c),this._elevationAlignedObserverPositionRenderSpace=c,this._observerGroundOffsetRenderSpace=s-a,this._observerFeatureId=(0,h.pD)(i),this.priority=X.T8.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onObserverRenderSpacePositionChangeForComputation(e,t,n,i,r){const{inputPoints:o}=e;switch((0,f.c)(o.observer,t),o.observerFeatureId=r,o.observerSurfaceNormal=null,i){case"on-the-ground":case"relative-to-ground":{const e=this._intersector.updateFromGroundIntersection(o.observer,n,o.observer);null==o.observerFeatureId&&(o.observerSurfaceNormal=e)}}this._adjustStartEndPositions(e),e.notifyInputPointsChanged(),this.priority=X.T8.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetPositionChange(e,t,n,i,r){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const s=e.inputPoints;if(o&&(s.isValid=!1),null==n)return null!=t&&(0,q.e)(this.analysis,t.spatialReference,u.Z.getLogger(this)),e.elevationAlignedTargetLocation=null,void e.notifyInputPointsChanged();const a=J(n,i),{absoluteZ:l,elevation:c}=(0,T.tq)(n.x,n.y,n.z,this.view.spatialReference,this.view,a),d=n.clone();switch(d.z=l,e.elevationAlignedTargetLocation=d,this.view.renderCoordsHelper.toRenderCoords(e.elevationAlignedTargetLocation,s.target),s.targetFeatureId=(0,h.pD)(r),s.targetSurfaceNormal=null,a.mode){case"on-the-ground":case"relative-to-ground":{const e=this._intersector.updateFromGroundIntersection(s.target,l-c,s.target);null==s.targetFeatureId&&(s.targetSurfaceNormal=e)}}this._adjustStartEndPositions(e),e.notifyInputPointsChanged(),this.priority=X.T8.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectComputationToTarget(e){return(0,_.AL)([this._updatingHandles.add((()=>({computation:e,targetPosition:e.target.position,targetElevationInfo:e.target.elevationInfo,targetFeatureInfo:e.target.feature,projectedTargetPosition:(0,C.projectOrLoad)(e.target.position,this.view.spatialReference)})),(e=>{let{computation:t,targetPosition:n,targetElevationInfo:i,targetFeatureInfo:r,projectedTargetPosition:o}=e;null==o.pending?this._onTargetPositionChange(t,n,o.geometry,i,r):this._updatingHandles.addPromise(o.pending)}),y.nn)])}_connectComputationToObserver(e){return this._updatingHandles.add((()=>({computation:e,observer:this.analysisViewData.elevationAlignedObserver})),(e=>{let{computation:t}=e;this._externalObserverUpdate&&(t.inputPoints.isValid=!1,t.notifyInputPointsChanged())}),y.nn)}_connectComputationToRenderSpaceObserver(e){return this._updatingHandles.add((()=>({computation:e,observer:this._elevationAlignedObserverPositionRenderSpace,observerGroundOffset:this._observerGroundOffsetRenderSpace,observerElevationMode:this._effectiveObserverElevationMode,observerFeatureId:this._observerFeatureId})),(e=>{let{computation:t,observer:n,observerGroundOffset:i,observerElevationMode:r,observerFeatureId:o}=e;this._onObserverRenderSpacePositionChangeForComputation(t,n,i,r,o)}),y.nn)}_connectComputationToCamera(e){return this._updatingHandles.add((()=>({camera:this.view.state.camera,isDirty:this._isCameraDirty})),(t=>{let{isDirty:n}=t;!this.updateOnCameraChange||e.inputPoints.isValid&&!n||e.notifyInputPointsChanged()}))}_connectComputationToSlicePlane(e){return this._updatingHandles.add((()=>this.view.slicePlane),(()=>{e.inputPoints.isValid=!1,e.notifyInputPointsChanged()}))}_connectComputationToElevation(e){const t=(n,i)=>{const r=this.analysis.observer,o=e.target;let s=null,a=null,l=null,u=null,c=null,d=null;if(null!=r?.position){const e=(0,C.projectOrLoad)(r.position,this.view.spatialReference);if(null!=e.pending)return this._updatingHandles.addPromise(e.pending),void e.pending.finally((()=>t(n,i)));s=e.geometry,a=r.elevationInfo,l=r.feature}if(null!=o.position){const e=(0,C.projectOrLoad)(o.position,this.view.spatialReference);if(null!=e.pending)return this._updatingHandles.addPromise(e.pending),void e.pending.finally((()=>t(n,i)));u=e.geometry,c=o.elevationInfo,d=o.feature}null==s&&null==u||((0,w.d)(n,i,te,this.view.spatialReference),null!=s&&(0,I.Qn)(te,s)&&this._onObserverPositionChange(null!=r?r.position:null,s,a,l,!1),null!=u&&(0,I.Qn)(te,u)&&this._onTargetPositionChange(e,o.position,u,c,d,!1),null!=s&&null!=u&&(0,I.I7)(te,s,u)&&e.notifyInputPointsChanged())};return this.view.elevationProvider.on("elevation-change",(e=>{let{extent:n,spatialReference:i}=e;return t(n,i)}))}_connectComputationToTask(e){let t=null;const n={computation:e,interpolationInfo:{originalIntersection:(0,d.Ue)(),originalObserver:(0,d.Ue)(),originalTarget:(0,d.Ue)()}};return(0,_.AL)([this._updatingHandles.add((()=>e.inputPoints),(()=>{t=(0,a.IM)(t),t=(0,g.vr)((async e=>{await(0,m.R8)(this._frameTask.schedule((()=>this._computeResult(n)),e))}))}),{initial:!0,equals:()=>!1}),(0,_.kB)((()=>t=(0,a.IM)(t)))])}_connectComputation(e){const t=this._computationHandles;t.has(e)||t.add([this._connectComputationToTarget(e),this._connectComputationToObserver(e),this._connectComputationToRenderSpaceObserver(e),this._connectComputationToCamera(e),this._connectComputationToSlicePlane(e),this._connectComputationToElevation(e),this._connectComputationToTask(e)],e)}_disconnectComputation(e){this._computationHandles.remove(e)}_onComputationCollectionChange(e){let{added:t,removed:n}=e;for(const i of n)this._disconnectComputation(i);for(const i of t)this._connectComputation(i)}_onTargetCollectionChange(e){let{added:t,removed:n}=e;for(const i of n)this._removeTarget(i);for(const i of t)this._addTarget(i)}_onCursorTargetChange(e,t){null!=t&&this._removeTarget(t),null!=e&&this._addTarget(e)}_addTarget(e){this._computations.some((t=>t.target===e))||this._computations.add(new L({target:e}))}_removeTarget(e){const t=this._computations.findIndex((t=>t.target===e));this._computations.removeAt(t)}_connectObserver(){return(0,_.AL)([this._updatingHandles.add((()=>({observerPosition:null!=this.analysis.observer?this.analysis.observer.position:null,projectedObserverPosition:(0,C.projectOrLoad)(null!=this.analysis.observer?this.analysis.observer.position:null,this.view.spatialReference),observerElevationInfo:null!=this.analysis.observer?this.analysis.observer.elevationInfo:null,observerFeatureInfo:null!=this.analysis.observer?this.analysis.observer.feature:null})),(e=>{let{observerPosition:t,projectedObserverPosition:n,observerElevationInfo:i,observerFeatureInfo:r}=e;null==n.pending?this._onObserverPositionChange(t,n.geometry,i,r,!0):this._updatingHandles.addPromise(n.pending)}),y.nn)])}_connectComputations(){return this._updatingHandles.addOnCollectionChange((()=>this._computations),(e=>this._onComputationCollectionChange(e)),{initial:!0,final:!0})}_connectTargets(){return(0,_.AL)([this._updatingHandles.addOnCollectionChange((()=>this.analysis.targets),(e=>this._onTargetCollectionChange(e)),{initial:!0,final:!0}),this._updatingHandles.add((()=>this.analysisViewData.cursorTarget),((e,t)=>{this._onCursorTargetChange(e,t)}))])}get _isCameraDirty(){const e=this.analysisViewData.elevationAlignedObserver,{view:t}=this,{renderCoordsHelper:n}=t;if(null==e||null==n)return!1;const i=Q;n.toRenderCoords(e,i);const r=t.state.camera.computeScreenPixelSizeAt(i);return Math.abs((r-this._screenPixelSize)/this._screenPixelSize)>K}};function J(e,t){return e.hasZ?t??{mode:"absolute-height",offset:0}:{mode:"on-the-ground",offset:0}}(0,i._)([(0,l.Cb)({constructOnly:!0})],Y.prototype,"analysis",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],Y.prototype,"analysisViewData",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],Y.prototype,"view",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"updating",null),(0,i._)([(0,l.Cb)()],Y.prototype,"priority",null),(0,i._)([(0,l.Cb)()],Y.prototype,"updateOnCameraChange",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"_computations",null),(0,i._)([(0,l.Cb)()],Y.prototype,"_elevationAlignedObserverPositionRenderSpace",null),(0,i._)([(0,l.Cb)()],Y.prototype,"_observerGroundOffsetRenderSpace",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"_effectiveObserverElevationMode",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"_observerFeatureId",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"_screenPixelSize",null),(0,i._)([(0,l.Cb)({readOnly:!0})],Y.prototype,"_updatingHandles",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"_frameTask",void 0),(0,i._)([(0,l.Cb)()],Y.prototype,"_isCameraDirty",null),Y=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSight.LineOfSightController")],Y);const K=.1,Q=(0,d.Ue)(),ee=(0,O.Ue)(),te=(0,I.cS)();var ne=n(51995),ie=n(97613),re=n(33985),oe=n(85981),se=n(64575),ae=n(86950);const le=new class{constructor(){this.glowWidth=8,this.innerWidth=.75}};const ue=new class{constructor(){this.size=.5}};function ce(e){return(0,ae.Ch)(e.accentColor,.75)}const de=new class{constructor(){this.size=.5,this.visibleColor=new ne.Z([3,252,111,.75]),this.occludedColor=new ne.Z([252,3,69,.75]),this.undefinedColor=new ne.Z([127,127,127,.75])}};const pe=new class{constructor(){this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new ne.Z([3,252,111,1]),this.visibleOuterColor=new ne.Z([3,252,111,.15]),this.occludedInnerColor=new ne.Z([252,3,69,1]),this.occludedOuterColor=new ne.Z([252,3,69,.1]),this.undefinedInnerColor=new ne.Z([255,255,255,1]),this.undefinedOuterColor=new ne.Z([127,127,127,.2])}};var he=n(35284),ge=n(83639),ve=n(40508),_e=n(81655),me=n(70619),ye=n(99034);class fe extends he.Z{constructor(e,t){const n=(0,ge.EA)(ce(e.effectiveTheme)),i=(0,me.PI)(n,ue.size,32,32),r=new ve.r(i);super({view:e,renderObjects:[r],metadata:t,elevationInfo:{mode:"absolute-height",offset:0}}),(0,_e.c)(this),this.themeHandle=(0,y.YP)((()=>({color:ce(e.effectiveTheme)})),(e=>{n.setParameters(e)}))}destroy(){this.themeHandle.remove(),super.destroy()}}class be extends he.Z{constructor(e,t){const{size:n,visibleColor:i,occludedColor:r,undefinedColor:o}=de;super({view:e,renderObjects:[Ce(n,i,ye.jg.Custom1),Ce(n,r,ye.jg.Custom2),Ce(n,o,ye.jg.Custom3)],metadata:t,elevationInfo:{mode:"absolute-height",offset:0}}),(0,_e.c)(this)}}function Ce(e,t,n){return new ve.r((0,me.PI)((0,ge.EA)(ne.Z.toUnitRGBA(t)),e,32,32),n)}var we,Ie=n(96026),Oe=(n(84057),n(86509)),Te=n(74229),Pe=n(72612),Re=n(63920);!function(e){e.Ready="ready",e.Creating="creating",e.Created="created"}(we||(we={}));let Le=class extends Oe.f{constructor(e){super(e),this._creationMode=!1,this.removeIncompleteOnCancel=!1,this.analysisViewData=null,this._latestPointerMovePointerType=null,this._laserlineVisualElement=null,this._grabbedManipulator=null,this._analysisHandles=new v.Z,this._updatingHandles=new b.R,this._manipulatorHandles=new v.Z,this._targetTrackerManipulator=null}initialize(){this._intersector=new G({view:this.view}),this.addHandles((0,y.YP)((()=>this.state),(e=>{e===we.Created&&this.finishToolCreation()}),y.tX)),this._observerManipulator=this._createObserverManipulator(),this._createLaserLine(),this.addHandles([this._updatingHandles.add((()=>this.analysisViewData?.elevationAlignedObserver),(e=>this._onObserverLocationChange(e)),y.nn),this._updatingHandles.add((()=>function(e){const t=e.accentColor;return{glowColor:t,innerColor:(0,ae.mj)(t),globalAlpha:.75*t.a}}(this.view.effectiveTheme)),(e=>{let{glowColor:t,innerColor:n,globalAlpha:i}=e;return this._updateLaserLineStyle(t,n,i)}),y.nn),this._updatingHandles.add((()=>this._laserLineRendererDependencies()),(e=>this._updateLaserLineRenderer(e))),this._connectComputations(),this._updatingHandles.addWhen((()=>!this._shouldRenderTracker),(()=>this._clearCursorTracker()),y.nn),this._updatingHandles.add((()=>({active:this.active,hasGrabbedManipulators:this.hasGrabbedManipulators})),(e=>{let{active:t,hasGrabbedManipulators:n}=e;this._creationMode=!!t&&(this._creationMode||!n)}),y.nn)])}destroy(){this._updatingHandles=(0,a.SC)(this._updatingHandles),this._manipulatorHandles=(0,a.SC)(this._manipulatorHandles),this._analysisHandles=(0,a.SC)(this._analysisHandles),this._observerManipulator=null,this._clearCursorTracker(),this._removeLaserLine(),this._intersector=null,this._set("analysis",null)}get state(){return this.active?!this.hasGrabbedManipulators||this._creationMode?we.Creating:we.Created:null!=this.analysis.observer?.position?we.Created:we.Ready}get cursor(){return this.active&&this._showTracker?"crosshair":null}get updating(){return null!=this.analysisViewData&&this.analysisViewData.updating||this._updatingHandles.updating}get _showTracker(){return this.active&&"mouse"===this._latestPointerMovePointerType}get _shouldRenderTracker(){return this._showTracker&&null!=this.analysis.observer?.position&&!this.hasGrabbedManipulators}continue(){this.view.activeTool=this}stop(){this.view.activeTool=null}onEditableChange(){this.analysisViewData.editable=this.internallyEditable}onInputEvent(e){switch(e.type){case"immediate-double-click":this._doubleClickHandler(e);break;case"key-down":this._keyDownHandler(e);break;case"pointer-move":this._pointerMoveHandler(e)}}onInputEventAfter(e){"immediate-click"===e.type&&this._clickHandler(e)}onShow(){}onHide(){}onDeactivate(){this._clearCursorTracker()}_connectComputations(){return this._updatingHandles.addOnCollectionChange((()=>this.analysisViewData.computations),(e=>this._onComputationsCollectionChange(e)),{initial:!0,final:!0})}_onComputationsCollectionChange(e){let{added:t,removed:n}=e;for(const i of n)this._disconnectComputation(i);for(const i of t)this._connectComputation(i)}_connectComputation(e){if(this.destroyed)return void u.Z.getLogger(this).warn("Attempting to connect an analysis to a destroyed LineOfSight tool. Ignoring.");const t=this._analysisHandles;if(t.has(e))return;const n=this._createTargetManipulator(e.target);null==this._targetTrackerManipulator&&n.metadata.target===this.analysisViewData.cursorTarget&&(this._targetTrackerManipulator=n,this._targetTrackerManipulator.available=!1,this._targetTrackerManipulator.interactive=!1,this._updateLaserLineRenderer()),t.add([this._updatingHandles.add((()=>function(e){const{isValid:t,isTargetVisible:n}=e.computationResult;return{isValid:t,isTargetVisible:n}}(e)),(()=>function(e,t){const{isValid:n,isTargetVisible:i}=t.computationResult;e.state=n?i?ye.jg.Custom1:ye.jg.Custom2:ye.jg.Custom3}(n,e)),y.nn),this._updatingHandles.add((()=>e.elevationAlignedTargetLocation),(e=>this._onTargetLocationChange(e,n)),y.nn)],e)}_disconnectComputation(e){if(this.destroyed)return void u.Z.getLogger(this).warn("Attempting to disconnect an analysis from a destroyed LineOfSight tool. Ignoring.");this._analysisHandles.remove(e);const t=this._getTargetManipulator(e.target);null!=t&&(this.manipulators.remove(t),this._manipulatorHandles.remove(t),null!=this._targetTrackerManipulator&&this._targetTrackerManipulator===t&&(this._targetTrackerManipulator=null))}_clearCursorTracker(){this.analysisViewData.cursorTarget=(0,a.SC)(this.analysisViewData.cursorTarget)}_createTargetManipulator(e){const t={target:e,type:"target"},n=new be(this.view,t);return this._manipulatorHandles.add([this._createTargetManipulatorDragPipeline(n),n.events.on("grab-changed",(e=>this._manipulatorGrabChanged(n,e))),n.events.on("immediate-click",(e=>this._manipulatorClick(n,e)))],n),this.manipulators.add(n),null!=e.position?n.elevationAlignedLocation=e.position:n.available=!1,n}_getTargetManipulator(e){let t=null;return this.manipulators.forEach((n=>{const i=n.manipulator;null==t&&"target"===i.metadata.type&&i.metadata.target===e&&(t=i)})),t}_createObserverManipulator(){const e=new fe(this.view,{type:"observer",intersection:null});return this._manipulatorHandles.add([this._createObserverManipulatorDragPipeline(e),e.events.on("grab-changed",(t=>this._manipulatorGrabChanged(e,t))),e.events.on("immediate-click",(t=>this._manipulatorClick(e,t)))],e),this.manipulators.add(e),e}_screenToIntersection(){return e=>{const t=this._intersector.getScreenPointIntersection(e.screenEnd);return null==t?null:{...e,intersection:t}}}_createTargetManipulatorDragPipeline(e){return(0,Te.Xd)(e,((t,n,i)=>{n.next(this._screenToIntersection()).next(this._updateTargetDragStep(e)).next((()=>this._updateLaserLineRenderer())),i.next(function(e){const t=e.position?.clone();return n=>(e.position=t,n)}(e.metadata.target)).next((()=>this._updateLaserLineRenderer()))}))}_createObserverManipulatorDragPipeline(e){return(0,Te.Xd)(e,((e,t,n)=>{t.next(this._screenToIntersection()).next(this._updateObserverDragStep()).next((()=>this._updateLaserLineRenderer())),n.next(this._cancelObserverDragStep()).next((()=>this._updateLaserLineRenderer()))}))}_updateObserverDragStep(){return e=>(null!=e.intersection.mapPoint?(null==this.analysis.observer&&(this.analysis.observer=new ie.Z),this._updateFromIntersection(this.analysis.observer,e.intersection)):this.analysis.observer=null,e)}_cancelObserverDragStep(){const e=null!=this.analysis.observer?.position?this.analysis.observer.clone():null;return t=>(this.analysis.observer=e,t)}_updateTargetDragStep(e){return t=>{this._updateFromIntersection(e.metadata.target,t.intersection);const n=t.intersection.mapPoint;return null!=n&&(e.elevationAlignedLocation=n),t}}_manipulatorGrabChanged(e,t){switch(t.action){case"start":this._grabbedManipulator=e;break;case"end":this._grabbedManipulator===e&&(this._grabbedManipulator=null)}}_laserLineRendererDependencies(){return{laserlineVisualElement:this._laserlineVisualElement,grabbedManipulator:this._grabbedManipulator,shouldRenderTracker:this._shouldRenderTracker,observerPosition:null!=this.analysis.observer?this.analysis.observer.position:null,visible:this.visible}}_updateLaserLineRenderer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._laserLineRendererDependencies();const{laserlineVisualElement:t,grabbedManipulator:n,shouldRenderTracker:i,observerPosition:r,visible:o}=e;if(null==t)return;const s=null!=n?n:i&&null!=r?this._targetTrackerManipulator:null;null!=s&&o?(t.visible=!0,t.heightManifoldTarget=s.renderLocation,s!==this._observerManipulator?t.lineVerticalPlaneSegment=(0,oe.zk)(this._observerManipulator.renderLocation,s.renderLocation,Se):t.lineVerticalPlaneSegment=null):(t.visible=!1,t.heightManifoldTarget=null,t.lineVerticalPlaneSegment=null)}_createLaserLine(){this._removeLaserLine();const{glowWidth:e,innerWidth:t}=le;this._laserlineVisualElement=new Ie.W({view:this.view,attached:!0,visible:this.visible,style:{glowWidth:e,innerWidth:t},isDecoration:!0})}_removeLaserLine(){null!=this._laserlineVisualElement&&(this._laserlineVisualElement.destroy(),this._laserlineVisualElement=null)}_updateLaserLineStyle(e,t,n){const i=this._laserlineVisualElement;if(null==i)return;const r=i.style;i.style={...r,glowColor:ne.Z.toUnitRGB(e),innerColor:ne.Z.toUnitRGB(t),globalAlpha:n}}_onObserverLocationChange(e){null!=e?(this._observerManipulator.metadata.intersection=null,this._observerManipulator.available=!0,this._observerManipulator.elevationAlignedLocation=e):this._observerManipulator.available=!1}_onTargetLocationChange(e,t){null!=e?(t.elevationAlignedLocation=e,t!==this._targetTrackerManipulator&&(t.available=!0)):t.available=!1}_addPointFromClickEvent(e){const t=this._intersector.getScreenPointIntersection(e);if(null!=t?.mapPoint)if(null!=this.analysis.observer?.position){this._clearCursorTracker();const e=new re.Z;this._updateFromIntersection(e,t),this.analysis.targets.add(e)}else{const e=new ie.Z;this._updateFromIntersection(e,t),this.analysis.observer=e}}_clickHandler(e){this.active&&e.button!==Re.t.Right&&(this._addPointFromClickEvent((0,Pe.vT)(e)),e.stopPropagation())}_doubleClickHandler(e){this.active&&e.button!==Re.t.Right&&(this.stop(),e.stopPropagation())}_keyDownHandler(e){this.active&&"Escape"===e.key&&(this.stop(),e.stopPropagation())}_pointerMoveHandler(e){if(this.hasGrabbedManipulators)return;if(this._latestPointerMovePointerType=e.pointerType,this._updateLaserLineRenderer(),!this._showTracker||null==this.analysis.observer?.position)return;const t=(0,Pe.vT)(e),n=this._intersector.getScreenPointIntersection(t);null!=n?.mapPoint&&(null==this.analysisViewData.cursorTarget&&(this.analysisViewData.cursorTarget=new re.Z),this._updateFromIntersection(this.analysisViewData.cursorTarget,n),this._updateLaserLineRenderer())}_updateFromIntersection(e,t){if(null==t.mapPoint)return e.position=null,e.elevationInfo=null,void(e.feature=null);switch(t.type){case F.q7.OBJECT:if(null!=t.graphic){const n=t.graphic,i=(0,T.RL)(n);"on-the-ground"===i.mode&&(i.mode="relative-to-ground",i.offset=0),e.elevationInfo=new se.Z(i),e.feature=n}else e.elevationInfo=null,e.feature=null;break;case F.q7.TERRAIN:e.elevationInfo=new se.Z({mode:"on-the-ground"}),e.feature=null;break;default:e.elevationInfo=null,e.feature=null}const n=t.mapPoint.clone();n.z=(0,T.vQ)(this.view,n,{mode:"absolute-height",offset:0},e.elevationInfo),e.position=n}_manipulatorClick(e,t){if("observer"===e.metadata.type||e.grabbing||e.dragging||t.button!==Re.t.Right||this.analysis.targets.length<=1)return;const{target:n}=e.metadata;this.analysis.targets.remove(n),t.stopPropagation()}get testInfo(){}};(0,i._)([(0,l.Cb)({constructOnly:!0})],Le.prototype,"view",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],Le.prototype,"analysis",void 0),(0,i._)([(0,l.Cb)()],Le.prototype,"_creationMode",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],Le.prototype,"state",null),(0,i._)([(0,l.Cb)({readOnly:!0})],Le.prototype,"cursor",null),(0,i._)([(0,l.Cb)()],Le.prototype,"removeIncompleteOnCancel",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],Le.prototype,"updating",null),(0,i._)([(0,l.Cb)({constructOnly:!0})],Le.prototype,"analysisViewData",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],Le.prototype,"_showTracker",null),(0,i._)([(0,l.Cb)()],Le.prototype,"_latestPointerMovePointerType",void 0),(0,i._)([(0,l.Cb)()],Le.prototype,"_shouldRenderTracker",null),(0,i._)([(0,l.Cb)()],Le.prototype,"_laserlineVisualElement",void 0),(0,i._)([(0,l.Cb)()],Le.prototype,"_grabbedManipulator",void 0),Le=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSight.LineOfSightTool")],Le);const Se=(0,oe.Ue)();var Ae=n(7025);class Ee{constructor(e,t,n,i){this.visibleLineVisualElement=e,this.occludedLineVisualElement=t,this.undefinedLineVisualElement=n,this.targetVisualElement=i}destroy(){this.visibleLineVisualElement.destroy(),this.occludedLineVisualElement.destroy(),this.undefinedLineVisualElement.destroy(),this.targetVisualElement.destroy()}}var Ve=n(33837),He=n(66730);n(56529);let De=class extends r.Z{constructor(e){super(e),this._lineOfSightVisualElements=new Array,this._computationHandles=new v.Z,this._updatingHandles=new b.R}initialize(){this.addHandles(this._connectComputations()),this._createObserverVisualization()}destroy(){this._updatingHandles=(0,a.SC)(this._updatingHandles),this._computationHandles=(0,a.SC)(this._computationHandles),this._observerVisualElement=(0,a.SC)(this._observerVisualElement)}get visible(){return this.analysisViewData.visible}get updating(){return this._updatingHandles.updating}get interactiveAndEditable(){return this.analysisViewData.interactive&&this.analysisViewData.editable}get test(){}_createLineOfSightVisualization(){const e=pe,t=this.view,n=this.isDecoration,i={view:t,attached:!0,width:e.outerWidth,innerWidth:e.innerWidth,isDecoration:n},r=ne.Z.toUnitRGBA(e.visibleOuterColor),o=ne.Z.toUnitRGBA(e.visibleInnerColor),s=ne.Z.toUnitRGBA(e.occludedOuterColor),a=ne.Z.toUnitRGBA(e.occludedInnerColor),l=ne.Z.toUnitRGBA(e.undefinedOuterColor),u=ne.Z.toUnitRGBA(e.undefinedInnerColor),c=new Ve.r({...i,color:r,innerColor:o}),d=new Ve.r({...i,color:s,innerColor:a}),p=new Ve.r({...i,color:l,innerColor:u}),h=new He.L({view:t,attached:!0,...Me,size:8,isDecoration:n}),g=new Ee(c,d,p,h);return this._lineOfSightVisualElements.push(g),g}_destroyLineOfSightVisualization(e){e.destroy(),this._lineOfSightVisualElements.splice(this._lineOfSightVisualElements.indexOf(e),1)}_updateLineOfSightVisualization(e,t,n){const i=pe,{computationResult:r,inputPoints:o}=e,{start:s,end:a,intersection:l,isValid:u,isTargetVisible:c}=r,{observer:p}=o,h=Fe;h[12]=p[0],h[13]=p[1],h[14]=p[2];const g=(0,f.d)(Ue,s,p),v=(0,f.d)(je,a,p),_=(0,f.d)(ke,l,p),{visibleLineVisualElement:m,occludedLineVisualElement:y,undefinedLineVisualElement:b,targetVisualElement:C}=t,w=null==this.analysisViewData.elevationAlignedObserver||null==e.elevationAlignedTargetLocation,I=this.visible&&!w;m.visible=I,y.visible=I,b.visible=I,C.visible=I,C.attached=!n.interactiveAndEditable,I&&(m.geometry=null,y.geometry=null,b.geometry=null,C.geometry=e.elevationAlignedTargetLocation,u?c?(m.geometry=[[(0,d.nI)(g),(0,d.nI)(v)]],m.transform=h,m.color=ne.Z.toUnitRGBA(i.visibleOuterColor),C.color=ne.Z.toUnitRGBA(i.visibleInnerColor)):(m.geometry=[[(0,d.nI)(g),(0,d.nI)(_)]],m.transform=h,m.color=ne.Z.toUnitRGBA(i.occludedOuterColor),y.geometry=[[(0,d.nI)(_),(0,d.nI)(v)]],y.transform=h,C.color=ne.Z.toUnitRGBA(i.occludedInnerColor)):(b.geometry=[[(0,d.nI)(g),(0,d.nI)(v)]],b.transform=h,C.color=ne.Z.toUnitRGBA(i.undefinedInnerColor)))}_getLineOfSightVisualizationDependencies(e){const{computationResult:t}=e,{occludedOuterColor:n,visibleOuterColor:i}=pe;return{computationResult:t,occludedOuterColor:n,visibleOuterColor:i,visible:this.visible,interactiveAndEditable:this.interactiveAndEditable}}_connectComputation(e){const t=this._computationHandles;if(t.has(e))return;const n=this._createLineOfSightVisualization();t.add([this._updatingHandles.add((()=>this._getLineOfSightVisualizationDependencies(e)),(t=>this._updateLineOfSightVisualization(e,n,t)),{initial:!0,equals:()=>!1}),(0,_.kB)((()=>this._destroyLineOfSightVisualization(n)))],e)}_disconnectComputation(e){this._computationHandles.remove(e)}_connectComputations(){return this._updatingHandles.addOnCollectionChange((()=>this.analysisViewData.computations),(e=>this._onComputationsCollectionChange(e)),{initial:!0,final:!0})}_onComputationsCollectionChange(e){let{added:t,removed:n}=e;for(const i of n)this._disconnectComputation(i);for(const i of t)this._connectComputation(i)}_createObserverVisualization(){const e=ne.Z.toUnitRGBA(pe.visibleInnerColor),t=new He.L({view:this.view,color:e,...Me,isDecoration:this.isDecoration});this._observerVisualElement=t,this.addHandles(this._updatingHandles.add((()=>({observer:this.analysisViewData.elevationAlignedObserver,interactiveAndEditable:this.interactiveAndEditable,visible:this.visible})),(e=>{let{observer:n,interactiveAndEditable:i,visible:r}=e;null!=n&&!i&&r?(t.geometry=n,this._observerVisualElement.attached=!0):t.attached=!1}),y.nn))}};(0,i._)([(0,l.Cb)({constructOnly:!0})],De.prototype,"analysis",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],De.prototype,"analysisViewData",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],De.prototype,"view",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],De.prototype,"visible",null),(0,i._)([(0,l.Cb)({constructOnly:!0})],De.prototype,"isDecoration",void 0),(0,i._)([(0,l.Cb)()],De.prototype,"updating",null),(0,i._)([(0,l.Cb)()],De.prototype,"interactiveAndEditable",null),(0,i._)([(0,l.Cb)()],De.prototype,"test",null),De=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSight.LineOfSightVisualization")],De);const Me={size:6,pixelSnappingEnabled:!1,primitive:"circle",elevationInfo:{mode:"absolute-height",offset:0},outlineSize:0},Ue=(0,d.Ue)(),je=(0,d.Ue)(),ke=(0,d.Ue)(),Fe=(0,Ae.Ue)();var xe=n(70209);let Ze=class extends((0,p.p)(s.Z.EventedMixin(r.Z))){constructor(e){super(e),this.type="line-of-sight-view-3d",this.analysis=null,this.tool=null,this.computations=new o.Z,this.elevationAlignedObserver=null,this.observerEngineLocation=(0,d.Ue)(),this.cursorTarget=null,this.editable=!0}initialize(){const e=this.view,t=this.analysis;this._analysisController=new Y({analysis:t,analysisViewData:this,view:e}),this._analysisVisualization=new De({analysis:t,analysisViewData:this,view:e,isDecoration:!this.parent}),this.addHandles([this._analysisController.on("result-changed",(e=>{e.target!==this.cursorTarget&&this.emit("result-changed",e)})),(0,xe.Lp)(this,Le)])}destroy(){(0,xe.Yq)(this),this._analysisController=(0,a.SC)(this._analysisController),this._analysisVisualization=(0,a.SC)(this._analysisVisualization)}get results(){return this.computations.map((e=>e.result))}get priority(){return this._analysisController.priority}set priority(e){this._analysisController.priority=e}get updating(){return null!=this._analysisController&&this._analysisController.updating||null!=this._analysisVisualization&&this._analysisVisualization.updating}getResultForTarget(e){return this.computations.find((t=>t.target===e))?.result}get testInfo(){}};(0,i._)([(0,l.Cb)({readOnly:!0})],Ze.prototype,"type",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0,nonNullable:!0})],Ze.prototype,"analysis",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"tool",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],Ze.prototype,"results",null),(0,i._)([(0,l.Cb)()],Ze.prototype,"priority",null),(0,i._)([(0,l.Cb)()],Ze.prototype,"computations",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"elevationAlignedObserver",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"observerEngineLocation",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"cursorTarget",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"updating",null),(0,i._)([(0,l.Cb)()],Ze.prototype,"editable",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"_analysisController",void 0),(0,i._)([(0,l.Cb)()],Ze.prototype,"_analysisVisualization",void 0),Ze=(0,i._)([(0,c.j)("esri.views.3d.analysis.LineOfSightAnalysisView3D")],Ze);const Ge=Ze},33906:(e,t,n)=>{n.d(t,{G:()=>o,e:()=>s});var i=n(79803),r=n(77648);function o(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=(0,i.tryProjectWithZConversion)(e,t);return null==s?null:(s.hasZ&&!o||null==n||(s.z=(0,r.KO)(n,s)??0),s)}function s(e,t,n){n.warnOnce(`Failed to project analysis geometry (id: '${e.id}'), projection from spatial reference (wkid: '${t.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}},81655:(e,t,n)=>{n.d(t,{I:()=>o,c:()=>s});var i=n(42537),r=n(74509);function o(e,t){return function(e,t){return!!e&&"on-the-ground"!==t.mode&&!(0,r.fl)(t)}(e?.data.coordinateHelper.hasZ(),t)}function s(e,t){let n=null;const r=e.events.on("grab-changed",(i=>{null!=n&&(n.remove(),n=null),"start"===i.action?(n=e.disableDisplay(),t&&t(i)):t&&t(i)}));return(0,i.kB)((()=>{n?.remove(),r.remove()}))}},33837:(e,t,n)=>{n.d(t,{r:()=>p});var i=n(29134),r=n(7025),o=n(32035),s=n(12400),a=n(86361),l=n(52168),u=n(79685),c=n(56529),d=n(58901);class p extends l._{constructor(e,t){super(e),this._hasExternalMaterial=!1,this._hasExternalMaterial=null!=t,this._material=null!=t?t:new d.U({width:1,color:(0,a.al)(1,0,1,1),stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerWidth:1,hasPolygonOffset:!1,renderOccluded:c.yD.OccludeAndTransparent,isDecoration:!!e.isDecoration,writeDepth:!0}),this.applyProperties(e)}setGeometryFromPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;const n=(0,s.Ue)();this.view.renderCoordsHelper.toRenderCoords(e,n)&&this.setGeometryFromRenderSpacePoint(n,t)}setGeometryFromRenderSpacePoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.geometry=[[[e[0]-t,e[1],e[2]],[e[0]+t,e[1],e[2]]],[[e[0],e[1]-t,e[2]],[e[0],e[1]+t,e[2]]],[[e[0],e[1],e[2]-t],[e[0],e[1],e[2]+t]]]}setGeometryFromExtent(e){const t=this.view.spatialReference,n=(0,s.Ue)(),i=(0,s.Ue)(),r=100,a=[];(0,o.i)(n,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(n,t,i),a.push([i[0],i[1],i[2]]),(0,o.i)(n,e[2],e[1],r),this.view.renderCoordsHelper.toRenderCoords(n,t,i),a.push([i[0],i[1],i[2]]),(0,o.i)(n,e[2],e[3],r),this.view.renderCoordsHelper.toRenderCoords(n,t,i),a.push([i[0],i[1],i[2]]),(0,o.i)(n,e[0],e[3],r),this.view.renderCoordsHelper.toRenderCoords(n,t,i),a.push([i[0],i[1],i[2]]),(0,o.i)(n,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(n,t,i),a.push([i[0],i[1],i[2]]),(0,o.i)(n,e[0],e[1],r),this.view.renderCoordsHelper.toRenderCoords(n,t,i),a.push([i[0],i[1],i[2]]),this.geometry=[a]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],n=e.origin,i=e.basis1,r=e.basis2,o=.5,a=(0,s.Ue)(),l=(0,s.Ue)(),u=(0,s.Ue)(),c=(0,s.Ue)();a[0]=n[0]-i[0]*o-r[0]*o,a[1]=n[1]-i[1]*o-r[1]*o,a[2]=n[2]-i[2]*o-r[2]*o,l[0]=n[0]-i[0]*o+r[0]*o,l[1]=n[1]-i[1]*o+r[1]*o,l[2]=n[2]-i[2]*o+r[2]*o,u[0]=n[0]+i[0]*o+r[0]*o,u[1]=n[1]+i[1]*o+r[1]*o,u[2]=n[2]+i[2]*o+r[2]*o,c[0]=n[0]+i[0]*o-r[0]*o,c[1]=n[1]+i[1]*o-r[1]*o,c[2]=n[2]+i[2]*o-r[2]*o,t.push([a[0],a[1],a[2]]),t.push([l[0],l[1],l[2]]),t.push([u[0],u[1],u[2]]),t.push([c[0],c[1],c[2]]),t.push([a[0],a[1],a[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;this.transform=(0,i.vc)(h,t);const{points:n}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[n]}setGeometryFromSegments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.AG;this.transform=(0,i.vc)(h,t),this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}getTransformedGeometry(){return null==this._geometry?null:this._geometry.map((e=>e.map((e=>(0,o.t)((0,s.Ue)(),e,this.transform)))))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(e){this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(e){this._material.setParameters({width:e})}get color(){return this._material.parameters.color}set color(e){const t=1===e[3];this._material.setParameters({color:e,writeDepth:t})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(e){this._material.setParameters({innerWidth:e})}get innerColor(){return this._material.parameters.innerColor}set innerColor(e){this._material.setParameters({innerColor:e})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(e){null!=this._material&&this._material.setParameters({stipplePattern:e})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(e){this._material.setParameters({stippleOffColor:e})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(e){this._material.setParameters({stipplePreferContinuous:e})}get falloff(){return this._material.parameters.falloff}set falloff(e){this._material.setParameters({falloff:e})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(e){this._material.setParameters({hasPolygonOffset:e})}createExternalResources(){}destroyExternalResources(){}createGeometries(e){for(const t of(0,u.c)(this.geometry)){const n=(0,u.Y)(this._material,t);e.addGeometry(n)}}forEachExternalMaterial(e){this._hasExternalMaterial||e(this._material)}}const h=(0,r.Ue)()},79685:(e,t,n)=>{n.d(t,{Y:()=>_,c:()=>f});var i=n(13611),r=n(6644),o=n(86361),s=n(83448),a=n(96334),l=n(86372),u=n(38461),c=n(39406),d=n(50951),p=n(91526),h=n(79100),g=n(2952),v=n(4760);function _(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=[],_=t.mapPositions;!function(e,t){const{attributeData:{position:n},removeDuplicateStartEnd:i}=e,r=function(e){const t=e.length;return e[0]===e[t-3]&&e[1]===e[t-2]&&e[2]===e[t-1]}(n)&&i,o=n.length/3-(r?1:0),s=new Array(2*(o-1)),a=r?n.slice(0,-3):n;let l=0;for(let u=0;u<o-1;u++)s[l++]=u,s[l++]=u+1;t.push([v.T.POSITION,new p.a(a,s,3,r)])}(t,r);const f=r[0][1].data,b=r[0][1].indices.length,C=(0,c.LE)(b);return function(e,t,n){if(null!=e.attributeData.colorFeature)return;const i=e.attributeData.color;t.push([v.T.COLOR,new p.a(i??o.hq,n,4)])}(t,r,C),function(e,t,n){null==e.attributeData.sizeFeature&&t.push([v.T.SIZE,new p.a([e.attributeData.size??1],n,1,!0)])}(t,r,C),function(e,t,n){e.attributeData.normal&&t.push([v.T.NORMAL,new p.a(e.attributeData.normal,n,3)])}(t,r,C),function(e,t,n){null!=e.attributeData.colorFeature&&t.push([v.T.COLORFEATUREATTRIBUTE,new p.a([e.attributeData.colorFeature],n,1,!0)])}(t,r,C),function(e,t,n){null!=e.attributeData.sizeFeature&&t.push([v.T.SIZEFEATUREATTRIBUTE,new p.a([e.attributeData.sizeFeature],n,1,!0)])}(t,r,C),function(e,t,n){null!=e.attributeData.opacityFeature&&t.push([v.T.OPACITYFEATUREATTRIBUTE,new p.a([e.attributeData.opacityFeature],n,1,!0)])}(t,r,C),function(e,t,n){if(null==e.overlayInfo||e.overlayInfo.renderCoordsHelper.viewingMode!==d.JY.Global||!e.overlayInfo.spatialReference.isGeographic)return;const r=(0,l.bg)(n.length),o=(0,s.Iu)(e.overlayInfo.spatialReference);for(let i=0;i<r.length;i+=3)(0,a.gH)(n,i,r,i,o);const c=n.length/3,h=(0,u.xx)(c+1);let g=m,_=y,f=0,b=0;(0,i.t8)(g,r[b++],r[b++]),b++,h[0]=0;for(let s=1;s<c+1;++s)s===c&&(b=0),(0,i.t8)(_,r[b++],r[b++]),b++,f+=(0,i.TK)(g,_),h[s]=f,[g,_]=[_,g];t.push([v.T.DISTANCETOSTART,new p.a(h,t[0][1].indices,1,!0)])}(t,r,f),new g.Z(e,r,_,h.U.Line,n)}const m=(0,r.Ue)(),y=(0,r.Ue)();function f(e,t){if(null==e||0===e.length)return[];const n=[];return e.forEach((e=>{const i=e.length,r=(0,l.bg)(3*i);e.forEach(((e,t)=>{r[3*t]=e[0],r[3*t+1]=e[1],r[3*t+2]=e[2]}));const o={attributeData:{position:r,normal:t},removeDuplicateStartEnd:!1};n.push(o)})),n}},11983:(e,t,n)=>{n.d(t,{c:()=>o});var i=n(56529),r=n(42235);class o extends i.F5{intersect(e,t,n,i,o,s){return(0,r.Bw)(e,n,i,o,void 0,s)}}},70209:(e,t,n)=>{n.d(t,{Er:()=>a,Lp:()=>l,Yq:()=>u});var i=n(14921),r=n(92026),o=n(66978),s=n(94172);function a(e,t){e.interactive=!0;const{tool:n,view:a}=e;a.activeTool=n;let l=(0,o.fu)(t,(()=>{a.activeTool===n&&(a.activeTool=null)}));return(0,i.vr)((async e=>{await(0,s.N1)((()=>null==n||!n.active),e),l=(0,r.hw)(l)}),t)}function l(e,t){return(0,s.YP)((()=>e.interactive),(()=>function(e,t){e.interactive?function(e,t){u(e);const{view:n,analysis:i}=e,r=new t({view:n,analysis:i,analysisViewData:e});e.tool=r,n.tools.add(r)}(e,t):u(e)}(e,t)),s.tX)}function u(e){const{view:t,tool:n}=e;null!=n&&(t.tools.remove(n),e.tool=null)}},86509:(e,t,n)=>{n.d(t,{f:()=>a});var i=n(27366),r=n(94172),o=(n(32718),n(93169),n(84936),n(10064),n(69912)),s=n(45900);let a=class extends s.m{constructor(e){super(e)}initialize(){this.addHandles((0,r.YP)((()=>this.analysisViewData.visible),(e=>this.visible=e),r.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};a=(0,i._)([(0,o.j)("esri.views.interactive.AnalysisToolBase")],a)},94163:(e,t,n)=>{n.d(t,{SP:()=>i,UG:()=>c,dU:()=>u,k0:()=>a,xO:()=>l});n(16889);var i,r=n(13611),o=n(6644);function s(e,t){return e[0]*t[1]-e[1]*t[0]}function a(e,t,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;return(0,r.$X)(p,i,n),(0,r.$X)(g,t,o),function(e,t,n){const i=(0,r.AK)(n,t)/(0,r.we)(n);(0,r.bA)(e,n,i)}(v,g,p),(0,r.IH)(e,o,v)}function l(e,t,n,i){(0,r.$X)(p,t,n);const o=i/(0,r.kE)(p);return(0,r.od)(e,n,p,o)}function u(e,t){const n=e.start,o=e.end,a=t.start,l=t.end,u=(0,r.$X)(p,o,n),c=(0,r.$X)(h,l,a),_=s(u,c);if(Math.abs(_)<=d)return[];const m=(0,r.$X)(g,n,a),y=s(c,m)/_,f=s(u,m)/_;if(y>=0){if(f>=0||t.type===i.LINE)return[(0,r.od)(v,n,u,y)]}else if(e.type===i.LINE&&(f>=0||t.type===i.LINE))return[(0,r.od)(v,n,u,y)];return[]}function c(e,t,n){const o=[],s=(0,r.$X)(p,e.end,e.start),a=(0,r.$X)(h,e.start,t),l=(0,r.we)(s),u=2*(0,r.AK)(s,a),c=u*u-4*l*((0,r.we)(a)-n*n);if(0===c){const t=-u/(2*l);(e.type===i.LINE||t>=0)&&o.push((0,r.od)(v,e.start,s,t))}else if(c>0){const t=Math.sqrt(c),n=(-u+t)/(2*l);(e.type===i.LINE||n>=0)&&o.push((0,r.od)(v,e.start,s,n));const a=(-u-t)/(2*l);(e.type===i.LINE||a>=0)&&o.push((0,r.od)(g,e.start,s,a))}return o}!function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"}(i||(i={}));const d=1e-6,p=(0,o.Ue)(),h=(0,o.Ue)(),g=(0,o.Ue)(),v=(0,o.Ue)()}}]);
//# sourceMappingURL=4731.93ad4063.chunk.js.map