"use strict";(self.webpackChunksc_land=self.webpackChunksc_land||[]).push([[74378],{19182:(e,r,t)=>{t.d(r,{i:()=>b});var s=t(27366),i=t(7138),o=t(79056),a=t(49861),c=(t(93169),t(32718),t(84936),t(69912)),u=t(26279),n=t(78289),d=t(78485);class h{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=u.eZ.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){var r;this._renderGroup=e;const t=null===(r=this._resources)||void 0===r?void 0:r.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){var e;this._destroyResources();const r=this._resourceFactory.createResources(),t=new l({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;this._resources={layerView:new l({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:r,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){var e;if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const r=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;r&&r.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,n.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,n.T.UPDATE),this._resources.geometriesAdded=!0))}}let l=class extends((0,o.IG)(i.Z)){constructor(e){super(e),this.drapeSourceType=u.Lw.Features,this.updatePolicy=d.j.SYNC,this.renderGroup=u.eZ.Outline}};(0,s._)([(0,a.Cb)({constructOnly:!0})],l.prototype,"view",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],l.prototype,"drapeSourceType",void 0),(0,s._)([(0,a.Cb)()],l.prototype,"renderGroup",void 0),l=(0,s._)([(0,c.j)("DrapedVisualElementLayerView")],l);var _=t(86244),p=t(94172),y=t(79100),R=t(66327),m=t(97882);class v{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const r=this._resources.object;this._resources.external.forEach((r=>{r.type!==y.U.Mesh&&r.type!==y.U.Line&&r.type!==y.U.Point||e.remove(r)})),r.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,r,this._resources.layer),this._resources.external.forEach((r=>{r.type!==y.U.Mesh&&r.type!==y.U.Line&&r.type!==y.U.Point||e.add(r)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,r=e.view,t=r._stage;if(!t)return;const s=new m.F(t,{pickable:!1,updatePolicy:d.j.SYNC}),i=new R.T({castShadow:!1}),o=e.createResources(i,s);o.forEach((e=>{t.add(e),e.type===y.U.Texture&&e.load(t.renderView.renderingContext)})),t.add(i),s.add(i);const a=e.cameraChanged,c=a?(0,p.YP)((()=>r.state.camera),(e=>a(e)),p.nn):null;this._resources={layer:s,object:i,external:o,cameraHandle:c},this._syncVisible()}_destroyResources(){var e;if(null==this._resources)return;const r=this._resourceFactory.view._stage;r&&(r.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((e=>{r.remove(e),e.type===y.U.Texture&&e.unload()}))),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class b extends _.l{constructor(e){var r;super(e),this._isDraped=!1,this.object3dResources=new v(this.createObject3DResourceFactory(e.view)),this.drapedResources=new h(this.createDrapedResourceFactory(e.view)),this.isDraped=null!==(r=e.isDraped)&&void 0!==r&&r}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},98917:(e,r,t)=>{t.d(r,{R:()=>D});var s=t(94172),i=t(29134),o=t(7025),a=t(32035),c=t(12400),u=t(19093),n=t(86361),d=t(51378),h=t(55946),l=t(19182),_=t(19265),p=t(91526),y=t(40779),R=t(70619),m=t(56529),v=t(39077),b=t(4760),g=t(66832),G=t(58901);class D extends l.i{constructor(e){super(e),this._maxSize=0,this._position=(0,c.Ue)(),this._up=(0,c.Ue)(),this._right=(0,c.Ue)(),this._renderOccluded=m.yD.OccludeAndTransparent,this._color=(0,n.al)(1,0,0,1),this._outlineColor=(0,n.al)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=m.yD.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,u.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,u.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const r=0===this._outlineSize!=(0===e);this._outlineSize=e,r?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry(e){let{previous:r,center:t,next:s}=e;this._maxSize=Math.min((0,a.q)(t,r),(0,a.q)(t,s))/3,(0,a.n)(this._up,(0,a.f)(this._up,r,t)),(0,a.n)(this._right,(0,a.f)(this._right,s,t)),(0,a.c)(this._position,t),this.recreateGeometry()}_createObject3DResources(e){const r=new g.E(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new G.U(this._outlineMaterialParameters);return this._createObject3DGeometries(e,r,t),{quadMaterial:r,outlineMaterial:t,forEach:e=>{e(r),t&&e(t)}}}_createObject3DGeometries(e,r,t){if((0,a.j)(this._up,c.AG)&&(0,a.j)(this._right,c.AG))return;const s=this._createGeometries(r,t);for(const i of s)e.addGeometry(i);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new g.E(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new G.U(this._outlineMaterialParameters),t=this._createGeometries(e,r).map((e=>new v.z(e)));return this._setTransformDraped(t),{quadMaterial:e,outlineMaterial:r,geometries:t,pixelRatioHandle:(0,s.YP)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[]}_createGeometries(e,r){const{up:t,right:s,corner:i}=this._getVertices(),o=this._quadGeometryData(t,s,i,e);return r?[o,(0,R.rh)(r,[t,i,s])]:[o]}_getVertices(){let e=this._up,r=this._right;const t=(0,a.g)(d.WM.get(),e,r);return this.isDraped&&(e=(0,a.c)(d.WM.get(),e),r=(0,a.c)(d.WM.get(),r),e[2]=0,r[2]=0,t[2]=0),{up:e,right:r,corner:t}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.object3dResources.object;if(!e)return;const r=this.view.state.camera,t=this._size*r.computeScreenPixelSizeAt(this._position),s=Math.min(this._maxSize,t);(0,i.vc)(w,this._position),(0,i.bA)(w,w,[s,s,s]),e.transformation=w}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:r},state:{contentPixelRatio:t}}}=this,{_position:s,_size:o}=this,c=(0,a.c)(d.WM.get(),s);c[2]=_.gi;const u=f;u.spatialReference=r.renderer.spatialReference,u.x=c[0],u.y=c[1];const n=o*(this.view.overlayPixelSizeInMapUnits(u)*t),h=Math.min(this._maxSize,n);(0,i.vc)(w,c),(0,i.bA)(w,w,[h,h,1]);for(const i of e)i.transformation=w}_quadGeometryData(e,r,t,s){return new y.Z(s,[[b.T.POSITION,new p.a([0,0,0,...r,...e,...t],[0,1,2,1,2,3],3,!0)]])}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){var e,r;null!==(e=this.object3dResources.resources)&&void 0!==e&&e.quadMaterial.setParameters(this._quadMaterialParameters),null===(r=this.drapedResources.resources)||void 0===r||r.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){var e,r;null!==(e=this.object3dResources.resources)&&void 0!==e&&null!==(e=e.outlineMaterial)&&void 0!==e&&e.setParameters(this._outlineMaterialParameters),null===(r=this.drapedResources.resources)||void 0===r||null===(r=r.outlineMaterial)||void 0===r||r.setParameters(this._outlineMaterialParameters)}}const w=(0,o.Ue)(),f=(0,h.T)(0,0,void 0,null)},11208:(e,r,t)=>{t.d(r,{CM:()=>n,RS:()=>d,Rs:()=>h});var s=t(17842),i=t(13611),o=t(32035),a=t(12400),c=t(55946),u=t(74509);function n(e,r,t,s){t.projectToRenderScreen(e,p),t.projectToRenderScreen(r,y),(0,i.$X)(s,y,p),(0,i.Fv)(s,s)}function d(e,r,t,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,a.Ue)();const c=(0,o.c)(_,e);return c[2]=(0,u.zx)(s,c,r,t)||0,s.renderCoordsHelper.toRenderCoords(c,r,i),i}function h(e,r,t,i){return"2d"===i.type?(l.x=e[0],l.y=e[1],l.spatialReference=r,i.toScreen(l)):(d(e,r,t,i,_),i.state.camera.projectToScreen(_,R),(0,s.vW)(R[0],R[1]))}const l=(0,c.T)(0,0,0,null),_=(0,a.Ue)(),p=(0,s.gX)(),y=(0,s.gX)(),R=(0,s.s1)()},47072:(e,r,t)=>{t.d(r,{T:()=>o,Y:()=>a});var s=t(15559),i=t(92975);function o(e,r,t,o){for(var a=arguments.length,c=new Array(a>4?a-4:0),u=4;u<a;u++)c[u-4]=arguments[u];return(0,i.sT)(e)&&(0,s.Gb)(e)?r.apply(void 0,c):(0,i.sS)(e)?t.apply(void 0,c):o.apply(void 0,c)}const a=1e5}}]);
//# sourceMappingURL=74378.adb891ac.chunk.js.map